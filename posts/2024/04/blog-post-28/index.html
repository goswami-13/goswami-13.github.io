<!DOCTYPE html> <html> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Beyond Complex Data: Understanding Systems with Dynamic Mode Decomposition | Shubham Goswami, PhD </title> <meta name="author" content="Shubham Goswami, PhD"> <meta name="description" content="Personal and professional website of Shubham Goswami, PhD. "> <link rel="stylesheet" href="/al-folio/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/al-folio/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/al-folio/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/al-folio/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/al-folio/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://shubhamdgoswami.github.io/al-folio/posts/2024/04/blog-post-28/"> <script src="/al-folio/assets/js/theme.js?a81d82887dd692e91686b43de4542f18"></script> <link defer rel="stylesheet" href="/al-folio/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> <link defer rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet@1.9.4/dist/leaflet.min.css" integrity="sha256-q9ba7o845pMPFU+zcAll8rv+gC+fSovKsOoNQ6cynuQ=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.9.0/styles/github.min.css" integrity="sha256-Oppd74ucMR5a5Dq96FxjEzGF7tTw2fZ/6ksAqDCM8GY=" crossorigin="anonymous" media="screen and (prefers-color-scheme: light)"> <link defer rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.9.0/styles/github-dark.min.css" integrity="sha256-nyCNAiECsdDHrr/s2OQsp5l9XeY2ZJ0rMepjCT2AkBk=" crossorigin="anonymous" media="screen and (prefers-color-scheme: dark)"> <link defer rel="stylesheet" href="https://cdn.jsdelivr.net/npm/diff2html@3.4.47/bundles/css/diff2html.min.css" integrity="sha256-IMBK4VNZp0ivwefSn51bswdsrhk0HoMTLc2GqFHFBXg=" crossorigin="anonymous"> <link defer rel="stylesheet" type="text/css" href="https://tikzjax.com/v1/fonts.css"> <script src="/al-folio/assets/js/distillpub/template.v2.js"></script> <script src="/al-folio/assets/js/distillpub/transforms.v2.js"></script> <style type="text/css">.fake-img{background:#bbb;border:1px solid rgba(0,0,0,0.1);box-shadow:0 0 4px rgba(0,0,0,0.1);margin-bottom:12px}.fake-img p{font-family:monospace;color:white;text-align:left;margin:12px 0;text-align:center;font-size:16px}</style> </head> <body> <d-front-matter> <script async type="text/json">
      {
            "title": "Beyond Complex Data: Understanding Systems with Dynamic Mode Decomposition",
            "description": "",
            "published": "August 06, 2024",
            "authors": [
              
            ],
            "katex": {
              "delimiters": [
                {
                  "left": "$",
                  "right": "$",
                  "display": false
                },
                {
                  "left": "$$",
                  "right": "$$",
                  "display": true
                }
              ]
            }
          }
    </script> </d-front-matter> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/al-folio/"> <span class="font-weight-bold">Shubham</span> Goswami, PhD </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/al-folio/">About </a> </li> <li class="nav-item "> <a class="nav-link" href="/al-folio/cv/">CV </a> </li> <li class="nav-item "> <a class="nav-link" href="/al-folio/blog/">Guides </a> </li> <li class="nav-item "> <a class="nav-link" href="/al-folio/publications/">Publications </a> </li> <li class="nav-item "> <a class="nav-link" href="/al-folio/teaching/">Teaching </a> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="post distill"> <d-title> <h1>Beyond Complex Data: Understanding Systems with Dynamic Mode Decomposition</h1> <p></p> </d-title> <d-article> <d-contents> <nav class="l-text figcaption"> <h3>Contents</h3> </nav> </d-contents> <p>Building upon our exploration of Dynamic Mode Decomposition (DMD), this article takes a practical turn! We’ll leverage a toy example to unveil how DMD tackles the challenge of understanding and predicting complex, nonlinear systems.</p> <figure> <img src="https://goswami-13.github.io/images/Post27/BlogLogo2.png" width="80%"> </figure> <p>In our ongoing exploration of understanding data-driven dynamical systems through modal decomposition methods, our focus has centered on Dynamic Mode Decomposition (DMD). Previously, I introduced the fundamental concepts of DMD and elucidated the mathematical underpinnings in detail. For those seeking a broader introduction to DMD, you can find it in my previous article linked <a href="https://medium.com/gitconnected/decoding-dynamics-the-mathematical-heart-of-dynamic-mode-decomposition-dmd-169e9a2eec07" rel="external nofollow noopener" target="_blank">here</a>.</p> <p>Additionally, for a deeper dive into the mathematical preliminaries of DMD, refer to this <a href="https://medium.com/gitconnected/understanding-systems-complex-with-dynamic-mode-decomposition-cb43a63be182" rel="external nofollow noopener" target="_blank">article</a>.</p> <p>In this installment, we’ll delve into the practical application of the DMD algorithm using a toy example. Our objective is to gain insights into diagnosing and predicting nonlinear dynamical systems. Throughout this article, I’ll draw upon insights from the book <a href="http://dmdbook.com/" rel="external nofollow noopener" target="_blank">“Dynamic Mode Decomposition: Data-Driven Modeling of Complex Systems”</a> by J. Nathan Kutz and others.</p> <p>Let’s dive in!</p> <h1 id="recap">Recap</h1> <p>Dynamic Mode Decomposition (DMD) offers a powerful method for unraveling complex spatio-temporal dynamics from data, breaking it down into dynamic modes derived from snapshots or measurements over time. This technique shares mathematical principles with the <a href="https://en.wikipedia.org/wiki/Arnoldi_iteration" rel="external nofollow noopener" target="_blank">Arnoldi algorithm</a>, a cornerstone of fast computational solvers. The data collection process hinges on two key parameters: 𝑛, representing spatial degrees of freedom per snapshot, and 𝑚, denoting the number of snapshots.</p> <p>The definition of DMD, as elucidated by <a href="10.3934/jcd.2014.1.391">Tu et al. (2014)</a>, is as follows:</p> <p>Consider a dynamical system and two sets of data:</p> <figure> <img src="https://goswami-13.github.io/images/Post27/Data1.png" width="80%"> </figure> <p>where the temporal evolution of the system over a time interval Δ𝑡 is expressed by a mapping given as:</p> \[x^\prime_k = F(x_k)\] <p>DMD undertakes the leading eigendecomposition of the best-fit linear mapping operator 𝐴 relating the data matrices:</p> \[X^\prime \approx AX\] <p>such that:</p> \[A = X^\prime X^\dagger\] <p>The resulting DMD modes, also known as dynamic modes, are the eigenvectors of 𝐴, with each mode corresponding to a specific eigenvalue.</p> <h1 id="the-algorithm">The Algorithm</h1> <p>In practical applications, the state dimension (𝑛) tends to be significantly larger than the number of snapshots (𝑚). Consider, for instance, a numerical fluid dynamics simulation, where 𝑛 represents the number of spatial degrees of freedom and 𝑚 denotes the number of snapshots, each taken Δ𝑡 time apart. In such cases, 𝑛≫𝑚, rendering the matrix 𝐴 dauntingly complex to analyze. Building upon our previous discussions, the DMD methodology sidesteps the eigendecomposition of 𝐴 by adopting a low-rank, reduced-order representation of 𝐴 in terms of the Proper Orthogonal Decomposition-projected matrix $\tilde{A}$.</p> <p>Below is a step-by-step outline of the Dynamic Mode Decomposition algorithm.</p> <h2 id="step-1--construct-the-data-matrix">Step 1 : Construct the Data Matrix</h2> <p>Commence by constructing a data matrix as depicted below:</p> <figure> <img src="https://goswami-13.github.io/images/Post27/Datamatrix.png" width="80%"> </figure> <p>Subsequently, divide this data matrix into two matrices, each time-shifted by Δ𝑡, as illustrated below:</p> <figure> <img src="https://goswami-13.github.io/images/Post27/Timeshifted.png" width="80%"> </figure> <p>The dimensions of the data matrix will be 𝑛×𝑚, while the time-shifted matrices will measure 𝑛×(𝑚−1).</p> <h2 id="step-2--svd-of-x">Step 2 : SVD of X</h2> <p>Initiate by performing the Singular Value Decomposition (SVD) of your first data matrix 𝑋, yielding:</p> \[X\approx U\Sigma V^\ast\] <p>where ∗ denotes the conjugate transpose. The dimensions of 𝑈 will be 𝑛×𝑟, Σ will be 𝑟×𝑟, and 𝑉 will be 𝑚×𝑟. Here, 𝑟 represents the rank of the reduced SVD approximation of 𝑋, and the left singular vectors 𝑈 correspond to the Proper Orthogonal Decomposition (POD) modes of 𝑋.</p> <p>This stage of the algorithm leverages the SVD to execute a low-rank truncation of the data. Notably, if the data exhibits low-dimensional structure, the singular values of Σ will sharply diminish, potentially leaving only a limited number of dominant modes.</p> <h2 id="step-3--obtain-matrix-a">Step 3 : Obtain Matrix A</h2> <p>Recalling the relationship:</p> \[X^\prime \approx AX\] <p>Using the SVD approximation from the previous step, we can derive the matrix 𝐴 using the pseudo-inverse of 𝑋 as follows:</p> \[A = X^\prime V\Sigma^{-1}U^\ast\] <p>However, in practice, it’s more efficient to compute the $\tilde{A}$ matrix, which, after the SVD reduction, represents the 𝑟×𝑟 projection of the full matrix 𝐴 onto the Proper Orthogonal Decomposition (POD) modes:</p> \[\tilde{A} = U^\ast AU = U^\ast X^\prime V\Sigma^{-1}\] <p>Here, the matrix $\tilde{A}$ signifies a low-dimensional linear model of the dynamical system on POD coordinates, given as:</p> \[\tilde{x}_{k+1} = \tilde{A} \tilde{x}_k\] <p>It’s also possible to construct the high-dimensional state 𝑥𝑘 as follows:</p> \[x_k = U \tilde{x}_k\] <h2 id="step-4--compute-eigendecomposition">Step 4 : Compute eigendecomposition</h2> <p>Performing the eigendecomposition of the $\tilde{A}$ matrix results in:</p> \[\tilde{A}W = W\Lambda\] <p>where 𝑊 represents the eigenvectors and 𝛬 is a diagonal matrix containing the corresponding eigenvalues 𝜆𝑘.</p> <h2 id="step-5--obtain-dmd-modes">Step 5 : Obtain DMD Modes</h2> <p>Finally, we can reconstruct the eigendecomposition of 𝐴 using 𝑊 and 𝛬. Since the $\tilde{A}$ matrix is a reduced representation of 𝐴, the eigenvalues of 𝐴 are given by 𝛬, and the eigenvectors of 𝐴 are obtained from the columns of Φ:</p> \[b = \Phi^\dagger x_1\] <p>Here, the modes given by Φ are the exact DMD modes. Another set of modes, known as projected DMD modes, are given by:</p> \[\Phi = UW\] <p>To find a dynamic mode of 𝐴 associated with a zero eigenvalue 𝜆𝑘=0, the exact DMD mode formulation may be used if Φ is non-zero. Otherwise, the projected DMD mode should be used. In any case, the exact DMD modes represent the dynamic modes we have been seeking!</p> <h1 id="prediction">Prediction</h1> <p>With the low-rank approximations of both the eigenvalues and eigenvectors from the above steps, it becomes possible to predict the future state of the system. This process begins by obtaining 𝜔𝑘 such that:</p> \[\omega_k = ln(\lambda_k)/\Delta t\] <p>Then, the approximate solution for all future times is given by:</p> \[x(t)\approx \sum_{k=1}^r \phi_k e^{\omega_k t}b_k = \Phi e^{\Omega t} b\] <p>Here, $𝑏_𝑘$ represents the initial amplitude of each mode, Φ is the matrix whose columns are the DMD eigenvectors $\Phi_𝑘$, and 𝛺=diag(𝜔) is a diagonal matrix whose entries are the eigenvalues $\omega_k$. The eigenvectors $\phi_k$ are the same size as the state 𝑥, and 𝑏 is a vector of the coefficients $b_k$.</p> <p>In simpler terms, the above equation can be interpreted as a least-squares fit or regression of a best-fit linear dynamical system based on the sampled data:</p> \[x_{k+1} = A x_k\] <p>The matrix 𝐴 is reconstructed by minimizing the least-squares 𝐿2 norm:</p> \[||x_{k+1} - A x_k||_2\] <p>Finally, the initial coefficient matrix is computed considering the initial snapshot 𝑥1 at time $t_1=0$, equating $x_1 = \phi b$. Since the matrix of eigenvectors Φ is generally not a square matrix, the initial conditions can be formulated by taking the pseudo-inverse of Φ:</p> \[b = \Phi^\dagger x_1\] <h1 id="python-implementation">Python implementation</h1> <p>Below is a Python implementation of the DMD algorithm. This function utilizes the low dimensionality inherent in the data to create a low-rank approximation of the linear mapping, which effectively approximates the nonlinear dynamics observed in the system.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">DMD</span><span class="p">(</span><span class="n">X1</span><span class="p">,</span> <span class="n">X2</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">dt</span><span class="p">):</span>
    <span class="n">U</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">Vh</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linalg</span><span class="p">.</span><span class="nf">svd</span><span class="p">(</span><span class="n">X1</span><span class="p">,</span> <span class="n">full_matrices</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="c1">### Truncate the SVD matrices
</span>    <span class="n">Ur</span> <span class="o">=</span> <span class="n">U</span><span class="p">[:,</span> <span class="p">:</span><span class="n">r</span><span class="p">]</span>
    <span class="n">Sr</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">diag</span><span class="p">(</span><span class="n">s</span><span class="p">[:</span><span class="n">r</span><span class="p">])</span>
    <span class="n">Vr</span> <span class="o">=</span> <span class="n">Vh</span><span class="p">.</span><span class="nf">conj</span><span class="p">().</span><span class="n">T</span><span class="p">[:,</span> <span class="p">:</span><span class="n">r</span><span class="p">]</span>
    
    <span class="c1">### Build the Atilde and find the eigenvalues and eigenvectors
</span>    <span class="n">Atilde</span> <span class="o">=</span> <span class="n">Ur</span><span class="p">.</span><span class="nf">conj</span><span class="p">().</span><span class="n">T</span> <span class="o">@</span> <span class="n">X2</span> <span class="o">@</span> <span class="n">Vr</span> <span class="o">@</span> <span class="n">np</span><span class="p">.</span><span class="n">linalg</span><span class="p">.</span><span class="nf">inv</span><span class="p">(</span><span class="n">Sr</span><span class="p">)</span>
    <span class="n">Lambda</span><span class="p">,</span> <span class="n">W</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linalg</span><span class="p">.</span><span class="nf">eig</span><span class="p">(</span><span class="n">Atilde</span><span class="p">)</span>
    
    <span class="c1">### Compute the DMD modes
</span>    <span class="n">Phi</span> <span class="o">=</span> <span class="n">X2</span> <span class="o">@</span> <span class="n">Vr</span> <span class="o">@</span> <span class="n">np</span><span class="p">.</span><span class="n">linalg</span><span class="p">.</span><span class="nf">inv</span><span class="p">(</span><span class="n">Sr</span><span class="p">)</span> <span class="o">@</span> <span class="n">W</span>
    
    <span class="n">omega</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="n">Lambda</span><span class="p">)</span><span class="o">/</span><span class="n">dt</span> <span class="c1">### continuous time eigenvalues
</span>    
    <span class="c1">### Compute the amplitudes
</span>    
    <span class="n">alpha1</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linalg</span><span class="p">.</span><span class="nf">lstsq</span><span class="p">(</span><span class="n">Phi</span><span class="p">,</span> <span class="n">X1</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">rcond</span><span class="o">=</span><span class="bp">None</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="c1">### DMD mode amplitudes
</span>    
    <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linalg</span><span class="p">.</span><span class="nf">lstsq</span><span class="p">(</span><span class="n">Phi</span><span class="p">,</span> <span class="n">X2</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">rcond</span><span class="o">=</span><span class="bp">None</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="c1">### DMD mode amplitudes
</span>    
    <span class="c1">### DMD reconstruction
</span>    <span class="n">time_dynamics</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">X1</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
        <span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">(</span><span class="n">alpha1</span><span class="p">)[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="p">.</span><span class="nf">exp</span><span class="p">(</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">(</span><span class="n">omega</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">dt</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">time_dynamics</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">time_dynamics</span> <span class="o">=</span> <span class="n">v</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">time_dynamics</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">vstack</span><span class="p">((</span><span class="n">time_dynamics</span><span class="p">,</span> <span class="n">v</span><span class="p">))</span>
    <span class="n">X_dmd</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">dot</span><span class="p">(</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">(</span><span class="n">Phi</span><span class="p">),</span> <span class="n">time_dynamics</span><span class="p">.</span><span class="n">T</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">Phi</span><span class="p">,</span> <span class="n">omega</span><span class="p">,</span> <span class="n">Lambda</span><span class="p">,</span> <span class="n">alpha1</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">X_dmd</span>
</code></pre></div></div> <h1 id="toy-example">Toy Example</h1> <p>Let’s look into a toy example to illustrate the inner workings of the DMD algorithm outlined above. We’ll examine a simple scenario involving two mixed spatio-temporal signals, akin to the animation at the beginning of this article. The goal here is to showcase how DMD efficiently decomposes the signal into its constituent parts. To provide context, we’ll also compare DMD’s results with those obtained from principal component analysis (PCA) and independent component analysis (ICA).</p> <p>The two signals we’ll be working with are:</p> \[f(x,t) = f_1(x,t) + f_2(x,t)\] <p>where,</p> \[f_1(x,t) = sech(x+3)e^{2.3i~t}\] <p>and</p> \[f_2(x,t) = 2sech(x)tanh(x)e^{2.8i~t}\] <p>These signals have frequencies of $\omega_1 = 2.3$ and $\omega_2 = 2.8$, each possessing distinct spatial structures as depicted below:</p> <p><img src="https://goswami-13.github.io/images/Post27/f1.png" width="49%"><img src="https://goswami-13.github.io/images/Post27/f2.png" width="49%"></p> <p><img src="https://goswami-13.github.io/images/Post27/f.png" width="49%"></p> <p>Let’s kick things off by firing up a Jupyter notebook and importing the necessary modules.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">matplotlib.colors</span>
<span class="kn">import</span> <span class="n">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="n">scipy</span> <span class="k">as</span> <span class="n">sp</span>
<span class="kn">import</span> <span class="n">os</span>
<span class="kn">import</span> <span class="n">io</span>
<span class="kn">import</span> <span class="n">imageio</span>

<span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>

<span class="n">plt</span><span class="p">.</span><span class="n">rcParams</span><span class="p">.</span><span class="nf">update</span><span class="p">({</span><span class="sh">'</span><span class="s">font.size</span><span class="sh">'</span> <span class="p">:</span> <span class="mi">20</span><span class="p">,</span> <span class="sh">'</span><span class="s">font.family</span><span class="sh">'</span> <span class="p">:</span> <span class="sh">'</span><span class="s">Times New Roman</span><span class="sh">'</span><span class="p">,</span> <span class="sh">"</span><span class="s">text.usetex</span><span class="sh">"</span><span class="p">:</span> <span class="bp">True</span><span class="p">})</span>
</code></pre></div></div> <p>After that, let’s proceed to generate the toy signals:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">### Define the time and space discretization
</span><span class="n">xi</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">400</span><span class="p">)</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="p">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<span class="n">dt</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="p">[</span><span class="n">Xgrid</span><span class="p">,</span> <span class="n">Tgrid</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">meshgrid</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>

<span class="c1">### Create two spatio-temporal signals
</span><span class="k">def</span> <span class="nf">sech</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="mi">1</span><span class="o">/</span><span class="n">np</span><span class="p">.</span><span class="nf">cosh</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">f1</span> <span class="o">=</span> <span class="nf">sech</span><span class="p">(</span><span class="n">Xgrid</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span><span class="o">*</span><span class="n">np</span><span class="p">.</span><span class="nf">exp</span><span class="p">(</span><span class="mf">1j</span><span class="o">*</span><span class="mf">2.3</span><span class="o">*</span><span class="n">Tgrid</span><span class="p">))</span>
<span class="n">f2</span> <span class="o">=</span> <span class="p">(</span><span class="nf">sech</span><span class="p">(</span><span class="n">Xgrid</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="p">.</span><span class="nf">tanh</span><span class="p">(</span><span class="n">Xgrid</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="p">.</span><span class="nf">exp</span><span class="p">(</span><span class="mf">1j</span><span class="o">*</span><span class="mf">2.8</span><span class="o">*</span><span class="n">Tgrid</span><span class="p">))</span>

<span class="c1">### Combine the signals
</span><span class="n">f</span> <span class="o">=</span> <span class="n">f1</span> <span class="o">+</span> <span class="n">f2</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">f</span><span class="p">.</span><span class="n">T</span>
</code></pre></div></div> <p>Then, you can effortlessly plot the surfaces using matplotlib plotting routines like so:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">()</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="p">.</span><span class="nf">add_subplot</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="sh">'</span><span class="s">3d</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax1</span><span class="p">.</span><span class="nf">plot_surface</span><span class="p">(</span><span class="n">Xgrid</span><span class="p">,</span> <span class="n">Tgrid</span><span class="p">,</span> <span class="n">np</span><span class="p">.</span><span class="nf">real</span><span class="p">(</span><span class="n">f</span><span class="p">),</span> 
                 <span class="n">rstride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cstride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">antialiased</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> 
                 <span class="n">facecolors</span><span class="o">=</span><span class="n">plt</span><span class="p">.</span><span class="n">cm</span><span class="p">.</span><span class="nc">Spectral_r</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">real</span><span class="p">(</span><span class="n">f</span><span class="p">)))</span>
<span class="n">ax1</span><span class="p">.</span><span class="nf">view_init</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span><span class="mi">240</span><span class="p">)</span>
<span class="n">ax1</span><span class="p">.</span><span class="nf">set_box_aspect</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax1</span><span class="p">.</span><span class="nf">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="sh">'</span><span class="s">$x$</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax1</span><span class="p">.</span><span class="nf">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="sh">'</span><span class="s">$t$</span><span class="sh">'</span><span class="p">)</span>

<span class="c1"># make the panes transparent
</span><span class="n">ax1</span><span class="p">.</span><span class="n">xaxis</span><span class="p">.</span><span class="nf">set_pane_color</span><span class="p">((</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">))</span>
<span class="n">ax1</span><span class="p">.</span><span class="n">yaxis</span><span class="p">.</span><span class="nf">set_pane_color</span><span class="p">((</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">))</span>
<span class="n">ax1</span><span class="p">.</span><span class="n">zaxis</span><span class="p">.</span><span class="nf">set_pane_color</span><span class="p">((</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">))</span>
<span class="c1"># make the grid lines transparent
</span><span class="n">ax1</span><span class="p">.</span><span class="n">xaxis</span><span class="p">.</span><span class="n">_axinfo</span><span class="p">[</span><span class="sh">"</span><span class="s">grid</span><span class="sh">"</span><span class="p">][</span><span class="sh">'</span><span class="s">color</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span>  <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="n">ax1</span><span class="p">.</span><span class="n">yaxis</span><span class="p">.</span><span class="n">_axinfo</span><span class="p">[</span><span class="sh">"</span><span class="s">grid</span><span class="sh">"</span><span class="p">][</span><span class="sh">'</span><span class="s">color</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span>  <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="n">ax1</span><span class="p">.</span><span class="n">zaxis</span><span class="p">.</span><span class="n">_axinfo</span><span class="p">[</span><span class="sh">"</span><span class="s">grid</span><span class="sh">"</span><span class="p">][</span><span class="sh">'</span><span class="s">color</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span>  <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</code></pre></div></div> <p>At this stage, since our objective is to apply DMD to our toy dataset, let’s begin by generating the two data matrices as outlined in the DMD algorithm.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># get two views of the data matrix offset by one time step
</span><span class="n">X1</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">matrix</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="n">X2</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">matrix</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:])</span>
</code></pre></div></div> <p>Next, utilize the previously defined DMD function to compute the essential diagnostic features of the data. These include the singular values of the data matrix X, the DMD modes Φ, and the continuous-time DMD eigenvalues ω. It’s crucial that these eigenvalues precisely match the underlying frequencies, where their imaginary components correspond to the frequencies of oscillation:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Phi</span><span class="p">,</span> <span class="n">omega</span><span class="p">,</span> <span class="n">Lambda</span><span class="p">,</span> <span class="n">alpha1</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">X_dmd</span> <span class="o">=</span> <span class="nc">DMD</span><span class="p">(</span><span class="n">X1</span><span class="p">,</span> <span class="n">X2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">omega</span><span class="p">)</span>
</code></pre></div></div> <p>Output:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="o">-</span><span class="mf">2.71962273e-15</span><span class="o">+</span><span class="mf">2.8j</span> <span class="o">-</span><span class="mf">7.82921696e-15</span><span class="o">+</span><span class="mf">2.3j</span><span class="p">]</span>
</code></pre></div></div> <p>Finally, let’s validate the spatial and temporal signals acquired from the rank-2 DMD reconstruction by comparing them with the original signal:</p> <p><img src="https://goswami-13.github.io/images/Post27/DMDRecon.png" width="49%"><img src="https://goswami-13.github.io/images/Post27/f.png" width="49%"></p> <p>Finally, lets verify the spatial and temporal signals obtained from the rank-2 DMD reconstruction with the original signal.</p> <figure> <img src="https://goswami-13.github.io/images/Post27/VerifyDMD.jpeg" width="80%"> </figure> <figure> <img src="https://goswami-13.github.io/images/Post27/TimeSignal.jpeg" width="80%"> </figure> <p>This validation confirms that a rank-2 truncation is suitable. DMD yields results that align precisely (within numerical precision) with the true solution.</p> </d-article> <d-appendix> <d-footnote-list></d-footnote-list> <d-citation-list></d-citation-list> </d-appendix> <d-bibliography src="/al-folio/assets/bibliography/"></d-bibliography> <d-article> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/al-folio/posts/2025/06/blog-post-54/">Tabulating 6-DOF Motion Kinematics in OpenFOAM using Python</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/al-folio/posts/2025/06/blog-post-53/">Setting Up Overset Mesh Cases in OpenFOAM Made Easy</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/al-folio/posts/2025/06/blog-post-52/">An Introduction to Overset Mesh in OpenFOAM</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/al-folio/posts/2025/05/blog-post-51/">Python Tools for Analyzing and Visualizing Mesh Motion Simulations</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/al-folio/posts/2025/03/blog-post-50/">Simulating Pure Pitching and Heaving Motions in OpenFOAM</a> </li> <br> <br> </d-article> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 Shubham Goswami, PhD. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/al-folio/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script src="/al-folio/assets/js/distillpub/overrides.js"></script> <script defer src="https://cdn.jsdelivr.net/npm/mermaid@10.7.0/dist/mermaid.min.js" integrity="sha256-TtLOdUA8mstPoO6sGvHIGx2ceXrrX4KgIItO06XOn8A=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/d3@7.8.5/dist/d3.min.js" integrity="sha256-1rA678n2xEx7x4cTZ5x4wpUCj6kUMZEZ5cxLSVSFWxw=" crossorigin="anonymous"></script> <script defer src="/al-folio/assets/js/mermaid-setup.js?38ca0a0126f7328d2d9a46bad640931f" type="text/javascript"></script> <script src="https://cdn.jsdelivr.net/npm/diff2html@3.4.47/bundles/js/diff2html-ui.min.js" integrity="sha256-eU2TVHX633T1o/bTQp6iIJByYJEtZThhF9bKz/DcbbY=" crossorigin="anonymous"></script> <script defer src="/al-folio/assets/js/diff2html-setup.js?80a6e52ce727518bbd3aed2bb6ba5601" type="text/javascript"></script> <script src="https://cdn.jsdelivr.net/npm/leaflet@1.9.4/dist/leaflet.min.js" integrity="sha256-MgH13bFTTNqsnuEoqNPBLDaqxjGH+lCpqrukmXc8Ppg=" crossorigin="anonymous"></script> <script defer src="/al-folio/assets/js/leaflet-setup.js?b6313931e203b924523e2d8b75fe8874" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js" integrity="sha256-0q+JdOlScWOHcunpUk21uab1jW7C1deBQARHtKMcaB4=" crossorigin="anonymous"></script> <script defer src="/al-folio/assets/js/chartjs-setup.js?183c5859923724fb1cb3c67593848e71" type="text/javascript"></script> <script src="https://cdn.jsdelivr.net/npm/echarts@5.5.0/dist/echarts.min.js" integrity="sha256-QvgynZibb2U53SsVu98NggJXYqwRL7tg3FeyfXvPOUY=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/echarts@5.5.0/theme/dark-fresh-cut.js" integrity="sha256-sm6Ui9w41++ZCWmIWDLC18a6ki72FQpWDiYTDxEPXwU=" crossorigin="anonymous"></script> <script defer src="/al-folio/assets/js/echarts-setup.js?738178999630746a8d0cfc261fc47c2c" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/vega@5.27.0/build/vega.min.js" integrity="sha256-Yot/cfgMMMpFwkp/5azR20Tfkt24PFqQ6IQS+80HIZs=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/vega-lite@5.16.3/build/vega-lite.min.js" integrity="sha256-TvBvIS5jUN4BSy009usRjNzjI1qRrHPYv7xVLJyjUyw=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/vega-embed@6.24.0/build/vega-embed.min.js" integrity="sha256-FPCJ9JYCC9AZSpvC/t/wHBX7ybueZhIqOMjpWqfl3DU=" crossorigin="anonymous"></script> <script defer src="/al-folio/assets/js/vega-setup.js?7c7bee055efe9312afc861b128fe5f36" type="text/javascript"></script> <script defer src="https://tikzjax.com/v1/tikzjax.js" integrity="sha256-+1qyucCXRZJrCg3lm3KxRt/7WXaYhBid4/1XJRHGB1E=" crossorigin="anonymous"></script> <script src="/al-folio/assets/js/typograms.js?062e75bede72543443762dc3fe36c7a5"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/al-folio/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/al-folio/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/al-folio/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/al-folio/assets/js/copy_code.js?c8a01c11a92744d44b093fc3bda915df" type="text/javascript"></script> <script defer src="/al-folio/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/al-folio/assets/js/mathjax-setup.js?a5bb4e6a542c546dd929b24b8b236dfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/al-folio/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/al-folio/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> <script type="module" src="/al-folio/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/al-folio/assets/js/search-setup.js?6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/al-folio/assets/js/search-data.js"></script> <script src="/al-folio/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>