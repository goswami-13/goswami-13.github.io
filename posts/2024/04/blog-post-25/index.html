<!DOCTYPE html> <html> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Extracting the Essence of Flow: POD with Python for 2D OpenFOAM Slices | Shubham Goswami, PhD </title> <meta name="author" content="Shubham Goswami, PhD"> <meta name="description" content="Personal and professional website of Shubham Goswami, PhD. "> <link rel="stylesheet" href="/goswami-13/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/goswami-13/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/goswami-13/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/goswami-13/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/goswami-13/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://goswami-13.github.io/goswami-13/posts/2024/04/blog-post-25/"> <script src="/goswami-13/assets/js/theme.js?a81d82887dd692e91686b43de4542f18"></script> <link defer rel="stylesheet" href="/goswami-13/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> <link defer rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet@1.9.4/dist/leaflet.min.css" integrity="sha256-q9ba7o845pMPFU+zcAll8rv+gC+fSovKsOoNQ6cynuQ=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.9.0/styles/github.min.css" integrity="sha256-Oppd74ucMR5a5Dq96FxjEzGF7tTw2fZ/6ksAqDCM8GY=" crossorigin="anonymous" media="screen and (prefers-color-scheme: light)"> <link defer rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.9.0/styles/github-dark.min.css" integrity="sha256-nyCNAiECsdDHrr/s2OQsp5l9XeY2ZJ0rMepjCT2AkBk=" crossorigin="anonymous" media="screen and (prefers-color-scheme: dark)"> <link defer rel="stylesheet" href="https://cdn.jsdelivr.net/npm/diff2html@3.4.47/bundles/css/diff2html.min.css" integrity="sha256-IMBK4VNZp0ivwefSn51bswdsrhk0HoMTLc2GqFHFBXg=" crossorigin="anonymous"> <link defer rel="stylesheet" type="text/css" href="https://tikzjax.com/v1/fonts.css"> <script src="/goswami-13/assets/js/distillpub/template.v2.js"></script> <script src="/goswami-13/assets/js/distillpub/transforms.v2.js"></script> <style type="text/css">.fake-img{background:#bbb;border:1px solid rgba(0,0,0,0.1);box-shadow:0 0 4px rgba(0,0,0,0.1);margin-bottom:12px}.fake-img p{font-family:monospace;color:white;text-align:left;margin:12px 0;text-align:center;font-size:16px}</style> </head> <body> <d-front-matter> <script async type="text/json">
      {
            "title": "Extracting the Essence of Flow: POD with Python for 2D OpenFOAM Slices",
            "description": "",
            "published": "July 02, 2024",
            "authors": [
              
            ],
            "katex": {
              "delimiters": [
                {
                  "left": "$",
                  "right": "$",
                  "display": false
                },
                {
                  "left": "$$",
                  "right": "$$",
                  "display": true
                }
              ]
            }
          }
    </script> </d-front-matter> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/goswami-13/"> <span class="font-weight-bold">Shubham</span> Goswami, PhD </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/goswami-13/">About </a> </li> <li class="nav-item "> <a class="nav-link" href="/goswami-13/cv/">CV </a> </li> <li class="nav-item "> <a class="nav-link" href="/goswami-13/blog/">Guides </a> </li> <li class="nav-item "> <a class="nav-link" href="/goswami-13/publications/">Publications </a> </li> <li class="nav-item "> <a class="nav-link" href="/goswami-13/teaching/">Teaching </a> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="post distill"> <d-title> <h1>Extracting the Essence of Flow: POD with Python for 2D OpenFOAM Slices</h1> <p></p> </d-title> <d-article> <d-contents> <nav class="l-text figcaption"> <h3>Contents</h3> </nav> </d-contents> <p>This article empowers you to harness the capabilities of Python scripting for performing POD analysis on 2D slice data extracted from your OpenFOAM simulations. We’ll guide you through the process of leveraging Python’s libraries to unlock hidden patterns within your data, transforming your 2D slices from raw information to a deeper understanding of the key flow dynamics at play.</p> <figure> <img src="https://goswami-13.github.io/images/Post24/BlogLogo.png" width="80%"> </figure> <p>Imagine peering into a swirling vortex within your OpenFOAM simulation. The complex dance of velocity vectors and pressure fields might seem like a chaotic blur. But beneath the surface lies a hidden order, a symphony of flow features playing a crucial role in the overall performance. Proper Orthogonal Decomposition (POD) acts like a maestro, wielding the power of mathematics to isolate and analyze these dominant modes within your data.</p> <p>This article delves into the world of POD analysis, specifically focusing on its application to 2D slice data extracted from your OpenFOAM simulations. In this you will discover how to leverage Python’s powerful libraries to directly analyze your 2D slice data, performing POD calculations and visualizing the extracted modes. By the end of this journey, you’ll be equipped to transform your understanding of OpenFOAM data. We’ll go beyond the raw numbers, empowering you to extract hidden patterns, identify key flow features, and gain a richer perspective on the dynamics at play within your simulations. This newfound knowledge can be instrumental in optimizing your models, validating results, and ultimately, unlocking deeper insights into your fluid dynamics research.</p> <p>Lets begin!!!</p> <h1 id="setting-up-the-case">Setting Up the Case</h1> <p>In this article, we delve into the intricacies of setting up Proper Orthogonal Decomposition (POD) using OpenFOAM slices and Python. Our focus lies on analyzing the two-dimensional flow around a square cylinder at a Reynolds number of 100. This configuration closely adheres to the guidelines laid out by Bai and Alam (2018) for reference, ensuring a robust methodology. Detailed instructions for this setup are available in their work, providing invaluable guidance for alignment. A comprehensive guide to prepping your OpenFOAM case for Modal Decompositions is available below, offering detailed insights into the necessary steps.</p> <p>Link to <a href="https://medium.com/gitconnected/a-guide-to-prepping-your-openfoam-case-for-modal-decompositions-87ce3a9eb6bf" rel="external nofollow noopener" target="_blank">A Guide to Prepping Your OpenFOAM Case for Modal Decompositions.</a></p> <p>Our journey begins with a fully-developed, statistically steady flow around a square cylinder at a Reynolds number of 100, as discussed in our previous article. Here, we extend our analysis by running this case for an additional 100 vortex shedding cycles. Within each shedding cycle, we extract two-dimensional slices or surfaces from the data 16 times. The extraction of 2D slices is facilitated by utilizing the <code class="language-plaintext highlighter-rouge">surfaces</code> function object in OpenFOAM, as illustrated below:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>surfaces
<span class="o">{</span>
    <span class="nb">type            </span>surfaces<span class="p">;</span>
    libs            <span class="o">(</span><span class="s2">"libsampling.so"</span><span class="o">)</span><span class="p">;</span>
    writeControl   	timeStep<span class="p">;</span>
    writeInterval   142<span class="p">;</span>

    surfaceFormat   vtk<span class="p">;</span>
    fields          <span class="o">(</span>p U<span class="o">)</span><span class="p">;</span>

    interpolationScheme cellPoint<span class="p">;</span>

    surfaces
    <span class="o">{</span>
        zNormal
        <span class="o">{</span>
            <span class="nb">type        </span>cuttingPlane<span class="p">;</span>
            point       <span class="o">(</span>0 0 0.05<span class="o">)</span><span class="p">;</span>
            normal      <span class="o">(</span>0 0 1<span class="o">)</span><span class="p">;</span>
            interpolate <span class="nb">true</span><span class="p">;</span>
        <span class="o">}</span>
    <span class="o">}</span><span class="p">;</span>
<span class="o">}</span><span class="p">;</span>
// <span class="k">*************************************************************************</span> //
</code></pre></div></div> <p>Once the simulation run is complete, you should find a directory named <code class="language-plaintext highlighter-rouge">surfaces</code> within the <code class="language-plaintext highlighter-rouge">postProcessing</code> directory of your case, containing all the extracted surfaces.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>surfaces/
├── 4771.2000000577236
│   └── zNormal.vtp
├── 4772.6200000577546
│   └── zNormal.vtp
├── 4774.0400000577856
│   └── zNormal.vtp
├── 4775.4600000578166
│   └── zNormal.vtp
<span class="nb">.</span>
<span class="nb">.</span>
<span class="nb">.</span>
</code></pre></div></div> <p>Ensure that both the case and the surfaces are extracted before proceeding further.</p> <h1 id="extracting-data-from-surfaces">Extracting data from surfaces</h1> <p>To extract data from the VTK files obtained from the OpenFOAM case, we will utilize <a href="https://pyvista.org/" rel="external nofollow noopener" target="_blank">PyVista</a>. PyVista serves as a helper module for the Visualization Toolkit (VTK), wrapping the VTK library through NumPy and allowing direct array access via various methods and classes. This package offers a Pythonic, well-documented interface that exposes VTK’s robust visualization backend, facilitating rapid prototyping, analysis, and visual integration of spatially referenced datasets.</p> <p>PyVista proves invaluable for scientific plotting in presentations and research papers, serving also as a supporting module for other Python modules dependent on mesh 3D rendering. Refer to Connections for a list of projects leveraging PyVista.</p> <p>Let’s initiate a Jupyter notebook and import the necessary modules, including PyVista:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">matplotlib.colors</span>
<span class="kn">import</span> <span class="n">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="n">fluidfoam</span> <span class="k">as</span> <span class="n">fl</span>
<span class="kn">import</span> <span class="n">scipy</span> <span class="k">as</span> <span class="n">sp</span>
<span class="kn">import</span> <span class="n">os</span>
<span class="kn">import</span> <span class="n">pyvista</span> <span class="k">as</span> <span class="n">pv</span>
<span class="kn">import</span> <span class="n">imageio</span>
<span class="kn">import</span> <span class="n">io</span>

<span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
<span class="n">plt</span><span class="p">.</span><span class="n">rcParams</span><span class="p">.</span><span class="nf">update</span><span class="p">({</span><span class="sh">'</span><span class="s">font.size</span><span class="sh">'</span> <span class="p">:</span> <span class="mi">18</span><span class="p">,</span> <span class="sh">'</span><span class="s">font.family</span><span class="sh">'</span> <span class="p">:</span> <span class="sh">'</span><span class="s">Times New Roman</span><span class="sh">'</span><span class="p">,</span> <span class="sh">"</span><span class="s">text.usetex</span><span class="sh">"</span><span class="p">:</span> <span class="bp">True</span><span class="p">})</span>
</code></pre></div></div> <p>Setting Path Variables and Constants:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">### Constants
</span><span class="n">d</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">Ub</span> <span class="o">=</span> <span class="mf">0.015</span>

<span class="c1">### Paths
</span><span class="n">Path</span> <span class="o">=</span> <span class="sh">'</span><span class="s">E:/Blog_Posts/Simulations/Sq_Cyl_Surfaces/surfaces/</span><span class="sh">'</span>
<span class="n">save_path</span> <span class="o">=</span> <span class="sh">'</span><span class="s">E:/Blog_Posts/SquareCylinderData/</span><span class="sh">'</span>

<span class="n">Files</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="nf">listdir</span><span class="p">(</span><span class="n">Path</span><span class="p">)</span>
</code></pre></div></div> <p>Now, let’s attempt to read the first snapshot surface using PyVista:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Data</span> <span class="o">=</span> <span class="n">pv</span><span class="p">.</span><span class="nf">read</span><span class="p">(</span><span class="n">Path</span> <span class="o">+</span> <span class="n">Files</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="sh">'</span><span class="s">/zNormal.vtp</span><span class="sh">'</span><span class="p">)</span>
<span class="n">grid</span> <span class="o">=</span> <span class="n">Data</span><span class="p">.</span><span class="n">points</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">grid</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">grid</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">grid</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span>
<span class="n">rows</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">shape</span><span class="p">(</span><span class="n">grid</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">rows = </span><span class="sh">'</span><span class="p">,</span> <span class="n">rows</span><span class="p">,</span> <span class="sh">'</span><span class="s">columns = </span><span class="sh">'</span><span class="p">,</span> <span class="n">columns</span><span class="p">)</span>

<span class="nf">print</span><span class="p">(</span><span class="n">Data</span><span class="p">.</span><span class="n">array_names</span><span class="p">)</span>
</code></pre></div></div> <p>Output:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="sh">'</span><span class="s">TimeValue</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">p</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">U</span><span class="sh">'</span><span class="p">]</span>
</code></pre></div></div> <p>Here, we observe that our 2D slices encompass velocity and pressure fields. Leveraging PyVista, we can extract the vorticity field for each snapshot and organize the resulting data into a large, tall, and slender matrix to facilitate POD computation.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Data</span> <span class="o">=</span> <span class="n">pv</span><span class="p">.</span><span class="nf">read</span><span class="p">(</span><span class="n">Path</span> <span class="o">+</span> <span class="n">Files</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="sh">'</span><span class="s">/zNormal.vtp</span><span class="sh">'</span><span class="p">)</span>
<span class="n">grid</span> <span class="o">=</span> <span class="n">Data</span><span class="p">.</span><span class="n">points</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">grid</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">grid</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">grid</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span>
<span class="n">rows</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">shape</span><span class="p">(</span><span class="n">grid</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">rows = </span><span class="sh">'</span><span class="p">,</span> <span class="n">rows</span><span class="p">,</span> <span class="sh">'</span><span class="s">columns = </span><span class="sh">'</span><span class="p">,</span> <span class="n">columns</span><span class="p">)</span>

<span class="c1">### For U
</span><span class="n">Snaps</span> <span class="o">=</span> <span class="nf">len</span><span class="p">(</span><span class="n">Files</span><span class="p">)</span> <span class="c1"># Number of snapshots
</span><span class="n">data_Vort</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">((</span><span class="n">rows</span><span class="p">,</span><span class="n">Snaps</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="p">.</span><span class="nf">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">Snaps</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">pv</span><span class="p">.</span><span class="nf">read</span><span class="p">(</span><span class="n">Path</span> <span class="o">+</span> <span class="n">Files</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="sh">'</span><span class="s">/zNormal.vtp</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">gradData</span> <span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="nf">compute_derivative</span><span class="p">(</span><span class="sh">'</span><span class="s">U</span><span class="sh">'</span><span class="p">,</span> <span class="n">vorticity</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">grad_pyvis</span> <span class="o">=</span> <span class="n">gradData</span><span class="p">.</span><span class="n">point_data</span><span class="p">[</span><span class="sh">'</span><span class="s">vorticity</span><span class="sh">'</span><span class="p">]</span>
    <span class="n">data_Vort</span><span class="p">[:,</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">reshape</span><span class="p">(</span><span class="n">grad_pyvis</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span> <span class="p">(</span><span class="n">rows</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">order</span><span class="o">=</span><span class="sh">'</span><span class="s">F</span><span class="sh">'</span><span class="p">)</span>

<span class="n">np</span><span class="p">.</span><span class="nf">save</span><span class="p">(</span><span class="n">save_path</span> <span class="o">+</span> <span class="sh">'</span><span class="s">VortZ.npy</span><span class="sh">'</span><span class="p">,</span> <span class="n">data_Vort</span><span class="p">)</span>
</code></pre></div></div> <p>Let’s examine the size of the matrix we’re dealing with by querying the shape of the <code class="language-plaintext highlighter-rouge">data_Vort</code> array:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">data_Vort</span><span class="p">.</span><span class="n">shape</span>
<span class="c1">### OUTPUT
### (96624, 1600)
</span></code></pre></div></div> <p>Additionally, we can visualize a snapshot of the vorticity field:</p> <figure> <img src="https://goswami-13.github.io/images/Post24/Vorticity.jpeg" width="80%"> </figure> <p>Moreover, for a more dynamic representation (showing off, in other words), we can animate the vorticity field:</p> <figure> <img src="https://goswami-13.github.io/images/Post24/VorticityGIFNew.gif" width="80%"> </figure> <h1 id="proper-orthogonal-decomposition-using-2d-slice-data">Proper Orthogonal Decomposition using 2D slice Data</h1> <p>At this stage, it becomes evident that we will embark on the Proper Orthogonal Decomposition (POD) of the extracted vorticity field data. Below are the steps for implementing the POD algorithm:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">### Obtain the Mean-Removed Vorticity
</span><span class="n">Vort_mean</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">mean</span><span class="p">(</span><span class="n">data_Vort</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">VortPrime</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">((</span><span class="n">data_Vort</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">data_Vort</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="p">.</span><span class="nf">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">data_Vort</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
    <span class="n">VortPrime</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_Vort</span><span class="p">[:,</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">Vort_mean</span>

<span class="c1">### Obtain the Covariance Matrix
</span><span class="n">uC</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">matmul</span><span class="p">(</span><span class="n">VortPrime</span><span class="p">.</span><span class="n">T</span><span class="p">,</span> <span class="n">VortPrime</span><span class="p">)</span><span class="o">/</span><span class="n">data_Vort</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="c1">### Obtain the Eigenvalues and Eigenvectors
</span><span class="n">uEVal</span><span class="p">,</span> <span class="n">uEVec</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linalg</span><span class="p">.</span><span class="nf">eig</span><span class="p">(</span><span class="n">uC</span><span class="p">)</span>
<span class="n">uModes</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">matmul</span><span class="p">(</span><span class="n">VortPrime</span><span class="p">,</span><span class="n">uEVec</span><span class="p">)</span>
</code></pre></div></div> <h1 id="results">Results</h1> <h2 id="pod-modes">POD Modes</h2> <figure> <img src="https://goswami-13.github.io/images/Post24/First6Modes.jpeg" width="80%"> </figure> <h2 id="pod-modal-energy">POD Modal Energy</h2> <figure> <img src="https://goswami-13.github.io/images/Post24/Energy.jpeg" width="80%"> </figure> <h2 id="pod-mode-amplitudes">POD Mode Amplitudes</h2> <figure> <img src="https://goswami-13.github.io/images/Post24/First6Amplitudes.jpeg" width="80%"> </figure> <h2 id="mode-amplitude-fft">Mode Amplitude FFT</h2> <figure> <img src="https://goswami-13.github.io/images/Post24/ModeAmplitudeFFT.jpeg" width="80%"> </figure> <p>With this, I conclude my series on Proper Orthogonal Decomposition (POD). We explored the mathematical underpinnings, implementation techniques, and diverse applications of POD in fluid mechanics. This series showcased POD’s versatility as a data-driven analysis tool, highlighting its potential to revolutionize flow control, turbulence modeling, and other areas. As research in POD and similar techniques continues alongside advancements in computational tools, we can unlock new avenues for understanding and manipulating complex flow phenomena, ultimately leading to breakthroughs in various scientific and engineering fields.</p> <p>Moving forward, POD holds immense promise for unlocking new avenues in understanding and manipulating complex flow phenomena. Continued advancements in computational fluid dynamics and data analysis methodologies will see Modal Decomposition method such as POD play a crucial role in areas like optimizing wind turbine performance or even developing novel microfluidic devices. The potential for innovation and discovery in the realm of fluid dynamics remains vast and exciting.</p> </d-article> <d-appendix> <d-footnote-list></d-footnote-list> <d-citation-list></d-citation-list> </d-appendix> <d-bibliography src="/goswami-13/assets/bibliography/"></d-bibliography> <d-article> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/goswami-13/posts/2025/06/blog-post-54/">Tabulating 6-DOF Motion Kinematics in OpenFOAM using Python</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/goswami-13/posts/2025/06/blog-post-53/">Setting Up Overset Mesh Cases in OpenFOAM Made Easy</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/goswami-13/posts/2025/06/blog-post-52/">An Introduction to Overset Mesh in OpenFOAM</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/goswami-13/posts/2025/05/blog-post-51/">Python Tools for Analyzing and Visualizing Mesh Motion Simulations</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/goswami-13/posts/2025/03/blog-post-50/">Simulating Pure Pitching and Heaving Motions in OpenFOAM</a> </li> <br> <br> </d-article> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 Shubham Goswami, PhD. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/goswami-13/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script src="/goswami-13/assets/js/distillpub/overrides.js"></script> <script defer src="https://cdn.jsdelivr.net/npm/mermaid@10.7.0/dist/mermaid.min.js" integrity="sha256-TtLOdUA8mstPoO6sGvHIGx2ceXrrX4KgIItO06XOn8A=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/d3@7.8.5/dist/d3.min.js" integrity="sha256-1rA678n2xEx7x4cTZ5x4wpUCj6kUMZEZ5cxLSVSFWxw=" crossorigin="anonymous"></script> <script defer src="/goswami-13/assets/js/mermaid-setup.js?38ca0a0126f7328d2d9a46bad640931f" type="text/javascript"></script> <script src="https://cdn.jsdelivr.net/npm/diff2html@3.4.47/bundles/js/diff2html-ui.min.js" integrity="sha256-eU2TVHX633T1o/bTQp6iIJByYJEtZThhF9bKz/DcbbY=" crossorigin="anonymous"></script> <script defer src="/goswami-13/assets/js/diff2html-setup.js?80a6e52ce727518bbd3aed2bb6ba5601" type="text/javascript"></script> <script src="https://cdn.jsdelivr.net/npm/leaflet@1.9.4/dist/leaflet.min.js" integrity="sha256-MgH13bFTTNqsnuEoqNPBLDaqxjGH+lCpqrukmXc8Ppg=" crossorigin="anonymous"></script> <script defer src="/goswami-13/assets/js/leaflet-setup.js?b6313931e203b924523e2d8b75fe8874" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js" integrity="sha256-0q+JdOlScWOHcunpUk21uab1jW7C1deBQARHtKMcaB4=" crossorigin="anonymous"></script> <script defer src="/goswami-13/assets/js/chartjs-setup.js?183c5859923724fb1cb3c67593848e71" type="text/javascript"></script> <script src="https://cdn.jsdelivr.net/npm/echarts@5.5.0/dist/echarts.min.js" integrity="sha256-QvgynZibb2U53SsVu98NggJXYqwRL7tg3FeyfXvPOUY=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/echarts@5.5.0/theme/dark-fresh-cut.js" integrity="sha256-sm6Ui9w41++ZCWmIWDLC18a6ki72FQpWDiYTDxEPXwU=" crossorigin="anonymous"></script> <script defer src="/goswami-13/assets/js/echarts-setup.js?738178999630746a8d0cfc261fc47c2c" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/vega@5.27.0/build/vega.min.js" integrity="sha256-Yot/cfgMMMpFwkp/5azR20Tfkt24PFqQ6IQS+80HIZs=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/vega-lite@5.16.3/build/vega-lite.min.js" integrity="sha256-TvBvIS5jUN4BSy009usRjNzjI1qRrHPYv7xVLJyjUyw=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/vega-embed@6.24.0/build/vega-embed.min.js" integrity="sha256-FPCJ9JYCC9AZSpvC/t/wHBX7ybueZhIqOMjpWqfl3DU=" crossorigin="anonymous"></script> <script defer src="/goswami-13/assets/js/vega-setup.js?7c7bee055efe9312afc861b128fe5f36" type="text/javascript"></script> <script defer src="https://tikzjax.com/v1/tikzjax.js" integrity="sha256-+1qyucCXRZJrCg3lm3KxRt/7WXaYhBid4/1XJRHGB1E=" crossorigin="anonymous"></script> <script src="/goswami-13/assets/js/typograms.js?062e75bede72543443762dc3fe36c7a5"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/goswami-13/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/goswami-13/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/goswami-13/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/goswami-13/assets/js/copy_code.js?c8a01c11a92744d44b093fc3bda915df" type="text/javascript"></script> <script defer src="/goswami-13/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/goswami-13/assets/js/mathjax-setup.js?a5bb4e6a542c546dd929b24b8b236dfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/goswami-13/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/goswami-13/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> <script type="module" src="/goswami-13/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/goswami-13/assets/js/search-setup.js?6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/goswami-13/assets/js/search-data.js"></script> <script src="/goswami-13/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>