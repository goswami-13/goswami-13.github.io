<!DOCTYPE html> <html> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Explore Dynamic Mode Decomposition (DMD) with OpenFOAM Simulation Data | Shubham Goswami, PhD </title> <meta name="author" content="Shubham Goswami, PhD"> <meta name="description" content="Personal and professional website of Shubham Goswami, PhD. "> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://goswami-13.github.io/posts/2024/04/blog-post-30/"> <script src="/assets/js/theme.js?a81d82887dd692e91686b43de4542f18"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> <link defer rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet@1.9.4/dist/leaflet.min.css" integrity="sha256-q9ba7o845pMPFU+zcAll8rv+gC+fSovKsOoNQ6cynuQ=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.9.0/styles/github.min.css" integrity="sha256-Oppd74ucMR5a5Dq96FxjEzGF7tTw2fZ/6ksAqDCM8GY=" crossorigin="anonymous" media="screen and (prefers-color-scheme: light)"> <link defer rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.9.0/styles/github-dark.min.css" integrity="sha256-nyCNAiECsdDHrr/s2OQsp5l9XeY2ZJ0rMepjCT2AkBk=" crossorigin="anonymous" media="screen and (prefers-color-scheme: dark)"> <link defer rel="stylesheet" href="https://cdn.jsdelivr.net/npm/diff2html@3.4.47/bundles/css/diff2html.min.css" integrity="sha256-IMBK4VNZp0ivwefSn51bswdsrhk0HoMTLc2GqFHFBXg=" crossorigin="anonymous"> <link defer rel="stylesheet" type="text/css" href="https://tikzjax.com/v1/fonts.css"> <script src="/assets/js/distillpub/template.v2.js"></script> <script src="/assets/js/distillpub/transforms.v2.js"></script> <style type="text/css">.fake-img{background:#bbb;border:1px solid rgba(0,0,0,0.1);box-shadow:0 0 4px rgba(0,0,0,0.1);margin-bottom:12px}.fake-img p{font-family:monospace;color:white;text-align:left;margin:12px 0;text-align:center;font-size:16px}</style> </head> <body> <d-front-matter> <script async type="text/json">
      {
            "title": "Explore Dynamic Mode Decomposition (DMD) with OpenFOAM Simulation Data",
            "description": "",
            "published": "August 14, 2024",
            "authors": [
              
            ],
            "katex": {
              "delimiters": [
                {
                  "left": "$",
                  "right": "$",
                  "display": false
                },
                {
                  "left": "$$",
                  "right": "$$",
                  "display": true
                }
              ]
            }
          }
    </script> </d-front-matter> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Shubham</span> Goswami, PhD </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">CV </a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">Guides </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">Publications </a> </li> <li class="nav-item "> <a class="nav-link" href="/teaching/">Teaching </a> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="post distill"> <d-title> <h1>Explore Dynamic Mode Decomposition (DMD) with OpenFOAM Simulation Data</h1> <p></p> </d-title> <d-article> <d-contents> <nav class="l-text figcaption"> <h3>Contents</h3> </nav> </d-contents> <p>Unveiling the secrets of complex systems often requires powerful tools. Enter OpenFOAM, a popular CFD (Computational Fluid Dynamics) software, and Dynamic Mode Decomposition (DMD), a potent data analysis method. This blog post explores the exciting intersection of these two! We’ll explore how DMD can be applied to OpenFOAM simulation data, extracting hidden patterns and dynamics within fluid flows.</p> <figure> <img src="https://goswami-13.github.io/images/Post29/BlogLogo.png" width="80%"> </figure> <p>In my previous article, I explored how Dynamic Mode Decomposition (DMD) has been applied and pioneered in the field of applied fluid dynamics, playing a crucial role in the identification and analysis of spatio-temporal coherent structures. We covered the fundamentals of DMD, its relationship with Singular Value Decomposition (SVD) and Proper Orthogonal Decomposition (POD)—other modal decomposition methods I’ve discussed earlier—and applied the DMD algorithm to the publicly available dataset of flow around a circular cylinder.</p> <p>In this article, we will focus on the open-source Computational Fluid Dynamics powerhouse, OpenFOAM. We’ll take a practical approach, using the Python programming language to directly analyze field data extracted from OpenFOAM time directories and compute Dynamic Mode Decomposition on the data.</p> <p>Let’s begin!</p> <h1 id="prerequisites">Prerequisites</h1> <h2 id="setting-up-the-case">Setting Up the Case</h2> <p>In order to explore Dynamics Mode Decomposition (DMD) using a combination of OpenFOAM and Python, our focus will center on examining the dynamics of a two-dimensional flow around a square cylinder at a Reynolds number of 100. This exploration will entail simulating the flow through Direct Numerical Simulations (DNS) using OpenFOAM. The configuration of this case closely follows the guidelines outlined by <a href="https://doi.org/10.1063/1.4996945" rel="external nofollow noopener" target="_blank">Bai and Alam (2018)</a> for reference. You can find detailed instructions in their work.</p> <p>Refer to the <a href="https://medium.com/gitconnected/a-guide-to-prepping-your-openfoam-case-for-modal-decompositions-87ce3a9eb6bf" rel="external nofollow noopener" target="_blank">my previous article</a> to setup a case following the criterions defined by Bai and Alam (2018).</p> <p>Verify that your case adheres to the specifications outlined in the reference and includes multiple time directories (snapshots) resembling the format below:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>7470.000000116633  7560.000000118597  7650.000000120562  7740.250000122532  7831.250000124518  7922.250000126504
7470.750000116649  7561.750000118635  7651.000000120584  7742.00000012257   7833.000000124556  7924.000000126543
...
7547.75000011833   7638.750000120316  7728.000000122264  7819.000000124251  7910.000000126237  constant
7549.500000118368  7640.500000120354  7729.750000122302  7820.750000124289  7911.750000126275  postProcessing
7551.250000118406  7642.250000120393  7731.500000122341  7822.500000124327  7913.500000126313  system
</code></pre></div></div> <p><strong>PRO TIP:</strong> Ensure a minimum of 256 snapshots are captured for your data.</p> <h2 id="visualization-case-setup">Visualization Case Setup</h2> <p>For data visualization purposes, we will establish a separate directory for a second case setup. Begin by duplicating the <code class="language-plaintext highlighter-rouge">0</code>, <code class="language-plaintext highlighter-rouge">constant</code>, and <code class="language-plaintext highlighter-rouge">system</code> files from your original case into a new directory named <code class="language-plaintext highlighter-rouge">visualizationCase</code>. Additionally, within this new directory, create a time directory named <code class="language-plaintext highlighter-rouge">1</code> to facilitate the organization of your data.</p> <h2 id="utilizing-fluidfoam">Utilizing FluidFoam</h2> <p>Our exploration heavily relies on a Python package called <a href="https://fluidfoam.readthedocs.io/en/latest/" rel="external nofollow noopener" target="_blank">fluidfoam</a>. This specialized package is crafted specifically for OpenFOAM post-processing tasks. Fluidfoam streamlines intricate operations such as extracting velocity and pressure data from simulations, seamlessly managing OpenFOAM-specific data structures, and facilitating insightful visualizations with minimal complexity.</p> <p>For instance, extracting the velocity field from within OpenFOAM is simplified using fluidfoam. Here’s an example code snippet:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># import readvector function from fluidfoam package
</span><span class="kn">from</span> <span class="n">fluidfoam</span> <span class="kn">import</span> <span class="n">readvector</span>
<span class="n">vel</span> <span class="o">=</span> <span class="nf">readvector</span><span class="p">(</span><span class="sh">'</span><span class="s">Path/To/Your/Case</span><span class="sh">'</span><span class="p">,</span> <span class="n">time_name</span><span class="o">=</span><span class="sh">'</span><span class="s">latestTime</span><span class="sh">'</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="sh">'</span><span class="s">U</span><span class="sh">'</span><span class="p">,</span> <span class="n">structured</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</code></pre></div></div> <p>In this snippet, <code class="language-plaintext highlighter-rouge">vel</code> represents the velocity vector imported into Python from your OpenFOAM case. It reads the latest available time <code class="language-plaintext highlighter-rouge">(time_name='latestTime')</code> and any specified fields <code class="language-plaintext highlighter-rouge">(name='U')</code>. Other available fields include <code class="language-plaintext highlighter-rouge">UMean</code>, <code class="language-plaintext highlighter-rouge">UPrime2Mean</code>, <code class="language-plaintext highlighter-rouge">p</code>, <code class="language-plaintext highlighter-rouge">pMean</code>, etc. The variable <code class="language-plaintext highlighter-rouge">vel</code> produces a numpy ndarray of size <code class="language-plaintext highlighter-rouge">(3 x NumberOfCells)</code>. Transposing the data is necessary to obtain a <code class="language-plaintext highlighter-rouge">(NumberOfCells x 3)</code> array:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">new_vel</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">reshape</span><span class="p">(</span><span class="n">vel</span><span class="p">.</span><span class="n">T</span><span class="p">,(</span><span class="mi">216000</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">order</span><span class="o">=</span><span class="sh">'</span><span class="s">F</span><span class="sh">'</span><span class="p">)</span>
</code></pre></div></div> <p>Here, <code class="language-plaintext highlighter-rouge">vel.T</code> denotes the transpose of the velocity vector array, and <code class="language-plaintext highlighter-rouge">order='F'</code> ensures the maintenance of element order. <code class="language-plaintext highlighter-rouge">'F'</code> specifies Fortran-like index order, where the first index changes fastest and the last index changes slowest.</p> <p>After matrix manipulation, the reshaped velocity array can be transformed back to its original format (transpose form) using:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">new_vel</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">reshape</span><span class="p">(</span><span class="n">new_vel</span><span class="p">,</span> <span class="p">(</span><span class="mi">72000</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">order</span><span class="o">=</span><span class="sh">'</span><span class="s">F</span><span class="sh">'</span><span class="p">)</span>
</code></pre></div></div> <p>This reshaped matrix retains the same mesh order as the original field and can be effortlessly integrated into OpenFOAM cases for post-processing via tools like Tecplot or ParaView.</p> <h1 id="dynamic-mode-decomposition-dmd">Dynamic Mode Decomposition (DMD)</h1> <p>Let’s kick off by launching a Jupyter notebook and importing the essential modules:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">matplotlib.colors</span>
<span class="kn">import</span> <span class="n">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="n">fluidfoam</span> <span class="k">as</span> <span class="n">fl</span> <span class="c1">### Most Important
</span><span class="kn">import</span> <span class="n">scipy</span> <span class="k">as</span> <span class="n">sp</span>
<span class="kn">from</span> <span class="n">matplotlib.colors</span> <span class="kn">import</span> <span class="n">ListedColormap</span>
<span class="kn">import</span> <span class="n">os</span>
<span class="kn">import</span> <span class="n">io</span>

<span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>

<span class="n">plt</span><span class="p">.</span><span class="n">rcParams</span><span class="p">.</span><span class="nf">update</span><span class="p">({</span><span class="sh">'</span><span class="s">font.size</span><span class="sh">'</span> <span class="p">:</span> <span class="mi">18</span><span class="p">,</span> <span class="sh">'</span><span class="s">font.family</span><span class="sh">'</span> <span class="p">:</span> <span class="sh">'</span><span class="s">Times New Roman</span><span class="sh">'</span><span class="p">,</span> <span class="sh">"</span><span class="s">text.usetex</span><span class="sh">"</span><span class="p">:</span> <span class="bp">True</span><span class="p">})</span>
</code></pre></div></div> <h2 id="step-1-setting-up-paths">Step 1: Setting Up Paths</h2> <p>Begin by assigning paths to your case directory and the folder where you intend to store your data:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Path</span> <span class="o">=</span> <span class="sh">'</span><span class="s">E:/Blog_Posts/OpenFOAM_POD/Square_Cylinder_Laminar/</span><span class="sh">'</span>
<span class="n">save_path</span> <span class="o">=</span> <span class="sh">'</span><span class="s">E:/Blog_Posts/OpenFOAM/ROM_Series/Post29/</span><span class="sh">'</span>
</code></pre></div></div> <h2 id="step-2-extracting-time-directories-as-a-list">Step 2: Extracting Time Directories as a List</h2> <p>Navigate to your OpenFOAM case within a Linux terminal on WSL or Ubuntu. First, within OpenFOAM, execute the command:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>foamListTimes | <span class="nb">tee </span>times.txt
</code></pre></div></div> <p>This command generates a text file named <code class="language-plaintext highlighter-rouge">times.txt</code>, listing all the time directory names.</p> <p>In Python, convert the text file into a list using the following code:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Times</span> <span class="o">=</span> <span class="nf">open</span><span class="p">(</span><span class="n">Path</span> <span class="o">+</span> <span class="sh">'</span><span class="s">times.txt</span><span class="sh">'</span><span class="p">).</span><span class="nf">read</span><span class="p">().</span><span class="nf">splitlines</span><span class="p">()</span>
<span class="n">Snapshots</span> <span class="o">=</span> <span class="nf">len</span><span class="p">(</span><span class="n">Times</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">Snapshots</span><span class="p">)</span>
<span class="c1">### Output
### 256
</span></code></pre></div></div> <p>This method results in <code class="language-plaintext highlighter-rouge">Times</code> being a list of strings. For instance, <code class="language-plaintext highlighter-rouge">Times[0] = 'xxxx'</code> (a string that can be directly read into the subsequent line of code). The output, indicating the number of snapshots, should match the number of time directories saved in your case.</p> <h2 id="step-3-reading-a-velocity-vector-field">Step 3: Reading a Velocity Vector Field</h2> <p>Let’s attempt to read a velocity field from OpenFOAM into Python using fluidfoam.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">vel</span> <span class="o">=</span> <span class="n">fl</span><span class="p">.</span><span class="nf">readvector</span><span class="p">(</span><span class="n">Path</span><span class="p">,</span> <span class="n">time_name</span><span class="o">=</span><span class="sh">'</span><span class="s">latestTime</span><span class="sh">'</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="sh">'</span><span class="s">U</span><span class="sh">'</span><span class="p">,</span> <span class="n">structured</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="n">columns</span><span class="p">,</span> <span class="n">rows</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">shape</span><span class="p">(</span><span class="n">vel</span><span class="p">.</span><span class="n">T</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">columns</span><span class="p">,</span> <span class="n">rows</span><span class="p">)</span>
<span class="c1">### Output
### 95868 3
</span></code></pre></div></div> <p>Successfully, we’ve imported a vector field from the OpenFOAM case into Python. Verify and assign the shape of the vector field to determine the number of rows and columns in your dataset, which will prove useful later.</p> <p><em>Note:</em> Here, columns correspond to the total number of data points in the internal mesh, while rows represent the velocity components (u, v, and w).</p> <h2 id="step-4-assembling-the-data-matrices">Step 4: Assembling the Data Matrices</h2> <p>At this stage, we need to assemble two crucial data matrices. First, the mean-centered dataset required to compute POD prior to DMD, and second, the data matrix containing instantaneous velocity field information for all snapshots. These correspond to the B and X matrices in our algorithm.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">((</span><span class="n">columns</span><span class="o">*</span><span class="n">rows</span><span class="p">,</span><span class="n">Snapshots</span><span class="p">))</span> <span class="c1"># Matrix to store the fluctuating velocity field
</span><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">((</span><span class="n">columns</span><span class="o">*</span><span class="n">rows</span><span class="p">,</span><span class="n">Snapshots</span><span class="p">))</span> <span class="c1"># Matrix to store the velocity field
</span>
<span class="c1"># Reading the mean velocity field
</span><span class="n">Mean_vel1</span> <span class="o">=</span> <span class="n">fl</span><span class="p">.</span><span class="nf">readvector</span><span class="p">(</span><span class="n">Path</span><span class="p">,</span> <span class="n">time_name</span><span class="o">=</span><span class="nf">str</span><span class="p">(</span><span class="n">Times</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">name</span><span class="o">=</span><span class="sh">'</span><span class="s">UMean</span><span class="sh">'</span><span class="p">,</span> <span class="n">structured</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="n">new_Mean_Vel1</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">reshape</span><span class="p">(</span><span class="n">Mean_vel1</span><span class="p">.</span><span class="n">T</span><span class="p">,(</span><span class="n">columns</span><span class="o">*</span><span class="n">rows</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">order</span><span class="o">=</span><span class="sh">'</span><span class="s">F</span><span class="sh">'</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="p">.</span><span class="nf">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">Snapshots</span><span class="p">):</span>
    <span class="n">vel1</span> <span class="o">=</span> <span class="n">fl</span><span class="p">.</span><span class="nf">readvector</span><span class="p">(</span><span class="n">Path</span><span class="p">,</span> <span class="n">time_name</span><span class="o">=</span><span class="nf">str</span><span class="p">(</span><span class="n">Times</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="n">name</span><span class="o">=</span><span class="sh">'</span><span class="s">U</span><span class="sh">'</span><span class="p">,</span> <span class="n">structured</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">new_vel1</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">reshape</span><span class="p">(</span><span class="n">vel1</span><span class="p">.</span><span class="n">T</span><span class="p">,(</span><span class="n">columns</span><span class="o">*</span><span class="n">rows</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">order</span><span class="o">=</span><span class="sh">'</span><span class="s">F</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">MC</span> <span class="o">=</span> <span class="n">new_vel1</span> <span class="o">-</span> <span class="n">new_Mean_Vel1</span>
    <span class="n">B</span><span class="p">[:,</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">MC</span>
    <span class="n">X</span><span class="p">[:,</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_vel1</span>

<span class="n">np</span><span class="p">.</span><span class="nf">save</span><span class="p">(</span><span class="n">save_path</span> <span class="o">+</span> <span class="sh">'</span><span class="s">B.npy</span><span class="sh">'</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
<span class="n">np</span><span class="p">.</span><span class="nf">save</span><span class="p">(</span><span class="n">save_path</span> <span class="o">+</span> <span class="sh">'</span><span class="s">X.npy</span><span class="sh">'</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span>
</code></pre></div></div> <p>Since we’ve run the case until it reached statistical stability, we can obtain the mean velocity (<code class="language-plaintext highlighter-rouge">UMean</code>) using OpenFOAM function objects and then utilize it here to derive the mean-centered matrix, B.</p> <h2 id="step-5-apriori-pod-analysis">Step 5: Apriori POD Analysis</h2> <p>Lets first compute Proper Orthogonal Decomposition (POD) of the flow field. This will aid in determining the appropriate r-rank approximation needed for DMD. Remember, DMD relies on Singular Value Decomposition (SVD) reduction to execute a low-rank truncation of the data.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">### POD Analysis
</span>
<span class="c1">### Data Matrix = B (Mean-removed Matrix)
### Mean-removed Matrix
</span><span class="n">B_mean</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">mean</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">B</span> <span class="o">-</span> <span class="n">B_mean</span><span class="p">[:,</span><span class="n">np</span><span class="p">.</span><span class="n">newaxis</span><span class="p">]</span>

<span class="c1">### Covariance Matrix
</span><span class="n">C</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">dot</span><span class="p">(</span><span class="n">Y</span><span class="p">.</span><span class="n">T</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">Y</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="c1">### SVD of Covariance Matrix
</span><span class="n">U</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">V</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linalg</span><span class="p">.</span><span class="nf">svd</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>

<span class="c1">### POD modes
</span><span class="n">Phi</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">dot</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">U</span><span class="p">)</span>

<span class="c1">### Temporal coefficients
</span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">dot</span><span class="p">(</span><span class="n">Phi</span><span class="p">.</span><span class="n">T</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>
</code></pre></div></div> <p>Following this, let’s directly examine the energy content of the initial POD modes to determine the r-rank approximation needed for DMD.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Energy</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">((</span><span class="nf">len</span><span class="p">(</span><span class="n">S</span><span class="p">),</span><span class="mi">1</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="p">.</span><span class="nf">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nf">len</span><span class="p">(</span><span class="n">S</span><span class="p">)):</span>
    <span class="n">Energy</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">S</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="n">np</span><span class="p">.</span><span class="nf">sum</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>

<span class="n">X_Axis</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">arange</span><span class="p">(</span><span class="n">Energy</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">heights</span> <span class="o">=</span> <span class="n">Energy</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">Energy</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="sh">'</span><span class="s">o</span><span class="sh">'</span><span class="p">,</span> <span class="n">markerfacecolor</span> <span class="o">=</span> <span class="sh">'</span><span class="s">none</span><span class="sh">'</span><span class="p">,</span> <span class="n">markeredgecolor</span> <span class="o">=</span> <span class="sh">'</span><span class="s">k</span><span class="sh">'</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="sh">'</span><span class="s">-</span><span class="sh">'</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="sh">'</span><span class="s">k</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">set_xlabel</span><span class="p">(</span><span class="sh">'</span><span class="s">Modes</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">set_ylabel</span><span class="p">(</span><span class="sh">'</span><span class="s">Energy Content</span><span class="sh">'</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">cumulative</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">cumsum</span><span class="p">(</span><span class="n">S</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="p">.</span><span class="nf">sum</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">cumulative</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="sh">'</span><span class="s">o</span><span class="sh">'</span><span class="p">,</span> <span class="n">markerfacecolor</span> <span class="o">=</span> <span class="sh">'</span><span class="s">none</span><span class="sh">'</span><span class="p">,</span> <span class="n">markeredgecolor</span> <span class="o">=</span> <span class="sh">'</span><span class="s">k</span><span class="sh">'</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="sh">'</span><span class="s">-</span><span class="sh">'</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="sh">'</span><span class="s">k</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">set_xlabel</span><span class="p">(</span><span class="sh">'</span><span class="s">Modes</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">set_ylabel</span><span class="p">(</span><span class="sh">'</span><span class="s">Cumulative Energy</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>

<span class="c1"># plt.savefig(save_path + 'Energy.jpeg', dpi = 300, bbox_inches = 'tight')
</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</code></pre></div></div> <figure> <img src="https://goswami-13.github.io/images/Post29/Energy.jpeg" width="80%"> </figure> <p>This analysis reveals that the first 21 POD modes capture approximately 99.9% of the total energy. Therefore, a rank-21 approximation for DMD will suffice!</p> <p>Finally, you can extract the POD modes and visualize them using Python:</p> <figure> <img src="https://goswami-13.github.io/images/Post29/First6Modes.jpeg" width="80%"> </figure> <h2 id="step-6-dmd-algorithm">Step 6: DMD Algorithm</h2> <p>We will be using a DMD function to extract all the necessary information from the two data matrices we input to it. For reference, here is the DMD function:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">DMD</span><span class="p">(</span><span class="n">X1</span><span class="p">,</span> <span class="n">X2</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">dt</span><span class="p">):</span>
    <span class="n">U</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">Vh</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linalg</span><span class="p">.</span><span class="nf">svd</span><span class="p">(</span><span class="n">X1</span><span class="p">,</span> <span class="n">full_matrices</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="c1">### Truncate the SVD matrices
</span>    <span class="n">Ur</span> <span class="o">=</span> <span class="n">U</span><span class="p">[:,</span> <span class="p">:</span><span class="n">r</span><span class="p">]</span>
    <span class="n">Sr</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">diag</span><span class="p">(</span><span class="n">s</span><span class="p">[:</span><span class="n">r</span><span class="p">])</span>
    <span class="n">Vr</span> <span class="o">=</span> <span class="n">Vh</span><span class="p">.</span><span class="nf">conj</span><span class="p">().</span><span class="n">T</span><span class="p">[:,</span> <span class="p">:</span><span class="n">r</span><span class="p">]</span>
    
    <span class="c1">### Build the Atilde and find the eigenvalues and eigenvectors
</span>    <span class="n">Atilde</span> <span class="o">=</span> <span class="n">Ur</span><span class="p">.</span><span class="nf">conj</span><span class="p">().</span><span class="n">T</span> <span class="o">@</span> <span class="n">X2</span> <span class="o">@</span> <span class="n">Vr</span> <span class="o">@</span> <span class="n">np</span><span class="p">.</span><span class="n">linalg</span><span class="p">.</span><span class="nf">inv</span><span class="p">(</span><span class="n">Sr</span><span class="p">)</span>
    <span class="n">Lambda</span><span class="p">,</span> <span class="n">W</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linalg</span><span class="p">.</span><span class="nf">eig</span><span class="p">(</span><span class="n">Atilde</span><span class="p">)</span>
    
    <span class="c1">### Compute the DMD modes
</span>    <span class="n">Phi</span> <span class="o">=</span> <span class="n">X2</span> <span class="o">@</span> <span class="n">Vr</span> <span class="o">@</span> <span class="n">np</span><span class="p">.</span><span class="n">linalg</span><span class="p">.</span><span class="nf">inv</span><span class="p">(</span><span class="n">Sr</span><span class="p">)</span> <span class="o">@</span> <span class="n">W</span>
    
    <span class="n">omega</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="n">Lambda</span><span class="p">)</span><span class="o">/</span><span class="n">dt</span> <span class="c1">### continuous time eigenvalues
</span>    
    <span class="c1">### Compute the amplitudes
</span>    
    <span class="n">alpha1</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linalg</span><span class="p">.</span><span class="nf">lstsq</span><span class="p">(</span><span class="n">Phi</span><span class="p">,</span> <span class="n">X1</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">rcond</span><span class="o">=</span><span class="bp">None</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="c1">### DMD mode amplitudes
</span>    
    <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linalg</span><span class="p">.</span><span class="nf">lstsq</span><span class="p">(</span><span class="n">Phi</span><span class="p">,</span> <span class="n">X2</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">rcond</span><span class="o">=</span><span class="bp">None</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="c1">### DMD mode amplitudes
</span>    
    <span class="c1">### DMD reconstruction
</span>    <span class="n">time_dynamics</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">X1</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
        <span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">(</span><span class="n">alpha1</span><span class="p">)[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="p">.</span><span class="nf">exp</span><span class="p">(</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">(</span><span class="n">omega</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">dt</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">time_dynamics</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">time_dynamics</span> <span class="o">=</span> <span class="n">v</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">time_dynamics</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">vstack</span><span class="p">((</span><span class="n">time_dynamics</span><span class="p">,</span> <span class="n">v</span><span class="p">))</span>
    <span class="n">X_dmd</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">dot</span><span class="p">(</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">(</span><span class="n">Phi</span><span class="p">),</span> <span class="n">time_dynamics</span><span class="p">.</span><span class="n">T</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">Phi</span><span class="p">,</span> <span class="n">omega</span><span class="p">,</span> <span class="n">Lambda</span><span class="p">,</span> <span class="n">alpha1</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">X_dmd</span>
</code></pre></div></div> <p>To use this, lets first obtain our time-shifted data matrices:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># get two views of the data matrix offset by one time step
</span><span class="n">X1</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">matrix</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="n">X2</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">matrix</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:])</span>
</code></pre></div></div> <p>And define the rank of approximation and the time-step:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">r</span> <span class="o">=</span> <span class="mi">21</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mf">0.01</span><span class="o">*</span><span class="mi">175</span>
</code></pre></div></div> <p>Then simply use the function above to compute DMD:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Phi</span><span class="p">,</span> <span class="n">omega</span><span class="p">,</span> <span class="n">Lambda</span><span class="p">,</span> <span class="n">alpha1</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">X_dmd</span> <span class="o">=</span> <span class="nc">DMD</span><span class="p">(</span><span class="n">X1</span><span class="p">,</span> <span class="n">X2</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>
</code></pre></div></div> <p>Now, before diving into visualization, let’s examine the distribution of eigenvalues extracted from the DMD algorithm. Specifically, we need to understand the dynamic behavior of the DMD modes we’ve identified. To do this, plot a simple unit circle and overlay the scatter plot of the real versus imaginary eigenvalues onto it by:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">linspace</span><span class="p">(</span> <span class="mi">0</span> <span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="n">pi</span> <span class="p">,</span> <span class="mi">150</span> <span class="p">)</span>
<span class="n">radius</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">radius</span> <span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="nf">cos</span><span class="p">(</span> <span class="n">theta</span> <span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">radius</span> <span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="nf">sin</span><span class="p">(</span> <span class="n">theta</span> <span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">subplots</span><span class="p">()</span>

<span class="n">ax</span><span class="p">.</span><span class="nf">scatter</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">real</span><span class="p">(</span><span class="n">Lambda</span><span class="p">),</span> <span class="n">np</span><span class="p">.</span><span class="nf">imag</span><span class="p">(</span><span class="n">Lambda</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="sh">'</span><span class="s">r</span><span class="sh">'</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="sh">'</span><span class="s">o</span><span class="sh">'</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="sh">'</span><span class="s">k</span><span class="sh">'</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="sh">'</span><span class="s">--</span><span class="sh">'</span><span class="p">)</span>

<span class="n">ax</span><span class="p">.</span><span class="nf">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="sh">'</span><span class="s">$\Lambda_r$</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="sh">'</span><span class="s">$\Lambda_i$</span><span class="sh">'</span><span class="p">)</span>

<span class="n">ax</span><span class="p">.</span><span class="nf">set_aspect</span><span class="p">(</span><span class="sh">'</span><span class="s">equal</span><span class="sh">'</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</code></pre></div></div> <figure> <img src="https://goswami-13.github.io/images/Post29/DMD_Circle.jpeg" width="80%"> </figure> <p>In this plot, all points lie on the unit circle, indicating that the modes neither grow nor decay, signifying stable DMD modes. Additionally, we observe two outliers where the eigenvalues reside inside the unit circle, indicating that these dynamic modes are decaying.</p> <h1 id="data-visualization">Data visualization</h1> <p>To prepare the DMD modes for visualization, we need to save them to an OpenFOAM native format file, which can then be read into Tecplot or ParaView. First, let’s create two text files named <code class="language-plaintext highlighter-rouge">header.txt</code> and <code class="language-plaintext highlighter-rouge">footer.txt</code>. Open any vector field file from your time directories and copy the header and footer sections into these text files. Save them in the <code class="language-plaintext highlighter-rouge">Path</code> file location.</p> <p>The contents of the <code class="language-plaintext highlighter-rouge">header.txt</code> file should be as follows:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/<span class="k">*</span><span class="nt">--------------------------------</span><span class="k">*</span>- C++ -<span class="k">*</span><span class="nt">----------------------------------</span><span class="k">*</span><span class="se">\</span>
| <span class="o">=========</span>                 |                                                 |
| <span class="se">\\</span>      /  F ield         | OpenFOAM: The Open Source CFD Toolbox           |
|  <span class="se">\\</span>    /   O peration     | Version:  2312                                  |
|   <span class="se">\\</span>  /    A nd           | Website:  www.openfoam.com                      |
|    <span class="se">\\</span>/     M anipulation  |                                                 |
<span class="se">\*</span><span class="nt">---------------------------------------------------------------------------</span><span class="k">*</span>/
FoamFile
<span class="o">{</span>
    version     2.0<span class="p">;</span>
    format      ascii<span class="p">;</span>
    <span class="nb">arch</span>        <span class="s2">"LSB;label=32;scalar=64"</span><span class="p">;</span>
    class       volVectorField<span class="p">;</span>
    location    <span class="s2">"7470.750000116649"</span><span class="p">;</span>
    object      U<span class="p">;</span>
<span class="o">}</span>
// <span class="k">*</span> <span class="k">*</span> <span class="k">*</span> <span class="k">*</span> <span class="k">*</span> <span class="k">*</span> <span class="k">*</span> <span class="k">*</span> <span class="k">*</span> <span class="k">*</span> <span class="k">*</span> <span class="k">*</span> <span class="k">*</span> <span class="k">*</span> <span class="k">*</span> <span class="k">*</span> <span class="k">*</span> <span class="k">*</span> <span class="k">*</span> <span class="k">*</span> <span class="k">*</span> <span class="k">*</span> <span class="k">*</span> <span class="k">*</span> <span class="k">*</span> <span class="k">*</span> <span class="k">*</span> <span class="k">*</span> <span class="k">*</span> <span class="k">*</span> <span class="k">*</span> <span class="k">*</span> <span class="k">*</span> <span class="k">*</span> <span class="k">*</span> <span class="k">*</span> <span class="k">*</span> //

dimensions      <span class="o">[</span>0 1 <span class="nt">-1</span> 0 0 0 0]<span class="p">;</span>

internalField   nonuniform List&lt;vector&gt; 
95868
<span class="o">(</span>
</code></pre></div></div> <p>And the contents of the <code class="language-plaintext highlighter-rouge">footer.txt</code> file should be as follows:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">)</span>
<span class="p">;</span>

boundaryField
<span class="o">{</span>
    INLET
    <span class="o">{</span>
        <span class="nb">type            </span>fixedValue<span class="p">;</span>
        value           uniform <span class="o">(</span>0.015 0 0<span class="o">)</span><span class="p">;</span>
    <span class="o">}</span>
    OUTLET
    <span class="o">{</span>
        <span class="nb">type            </span>zeroGradient<span class="p">;</span>
    <span class="o">}</span>
    TOP
    <span class="o">{</span>
        <span class="nb">type            </span>slip<span class="p">;</span>
    <span class="o">}</span>
    BOTTOM
    <span class="o">{</span>
        <span class="nb">type            </span>slip<span class="p">;</span>
    <span class="o">}</span>
    SIDE1
    <span class="o">{</span>
        <span class="nb">type            </span>slip<span class="p">;</span>
    <span class="o">}</span>
    SIDE2
    <span class="o">{</span>
        <span class="nb">type            </span>slip<span class="p">;</span>
    <span class="o">}</span>
    PRISM
    <span class="o">{</span>
        <span class="nb">type            </span>noSlip<span class="p">;</span>
    <span class="o">}</span>
<span class="o">}</span>


// <span class="k">*************************************************************************</span> //
</code></pre></div></div> <p>Now, let’s read the header and footer files into Python:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># For Header
</span><span class="k">with</span> <span class="nf">open</span><span class="p">(</span><span class="n">Path</span> <span class="o">+</span> <span class="sh">'</span><span class="s">header.txt</span><span class="sh">'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">header</span><span class="o">=</span><span class="sh">""</span><span class="p">.</span><span class="nf">join</span><span class="p">([</span><span class="n">f</span><span class="p">.</span><span class="nf">readline</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">23</span><span class="p">)])</span>  <span class="c1">### 22 is number of rows
</span>
<span class="c1"># For Footer
</span><span class="k">with</span> <span class="nf">open</span><span class="p">(</span><span class="n">Path</span> <span class="o">+</span> <span class="sh">'</span><span class="s">footer.txt</span><span class="sh">'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">footer</span><span class="o">=</span><span class="sh">""</span><span class="p">.</span><span class="nf">join</span><span class="p">([</span><span class="n">f</span><span class="p">.</span><span class="nf">readline</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">39</span><span class="p">)])</span>
</code></pre></div></div> <p>We can now save the POD modes into OpenFOAM-readable files by combining the header and footer files with the calculated POD modes:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">saveTime</span> <span class="o">=</span> <span class="sh">'</span><span class="s">E:/Blog_Posts/OpenFOAM_POD/TestCase_DMD/</span><span class="sh">'</span>

<span class="c1">### Save the DMD Modes
</span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="p">.</span><span class="nf">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nf">len</span><span class="p">(</span><span class="n">Lambda</span><span class="p">)):</span>
    <span class="n">Mode</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">reshape</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">real</span><span class="p">(</span><span class="n">Phi</span><span class="p">[:,</span><span class="n">i</span><span class="p">]),</span> <span class="p">(</span><span class="n">columns</span><span class="p">,</span><span class="n">rows</span><span class="p">),</span> <span class="n">order</span><span class="o">=</span><span class="sh">'</span><span class="s">F</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">np</span><span class="p">.</span><span class="nf">savetxt</span><span class="p">(</span><span class="n">saveTime</span> <span class="o">+</span> <span class="sh">'</span><span class="s">Mode</span><span class="sh">'</span> <span class="o">+</span> <span class="nf">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">Mode</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="sh">'</span><span class="s">(%s %s %s)</span><span class="sh">'</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="n">header</span><span class="p">,</span> <span class="n">footer</span><span class="o">=</span><span class="n">footer</span><span class="p">,</span> <span class="n">comments</span><span class="o">=</span><span class="sh">''</span><span class="p">)</span>

<span class="c1">### Save the Reconstructed flow field
</span><span class="n">First</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">reshape</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">real</span><span class="p">(</span><span class="n">X_dmd</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]),</span> <span class="p">(</span><span class="n">columns</span><span class="p">,</span><span class="n">rows</span><span class="p">),</span> <span class="n">order</span><span class="o">=</span><span class="sh">'</span><span class="s">F</span><span class="sh">'</span><span class="p">)</span>
<span class="n">np</span><span class="p">.</span><span class="nf">savetxt</span><span class="p">(</span><span class="n">saveTime</span> <span class="o">+</span> <span class="sh">'</span><span class="s">XDMD</span><span class="sh">'</span><span class="p">,</span> <span class="n">First</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="sh">'</span><span class="s">(%s %s %s)</span><span class="sh">'</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="n">header</span><span class="p">,</span> <span class="n">footer</span><span class="o">=</span><span class="n">footer</span><span class="p">,</span> <span class="n">comments</span><span class="o">=</span><span class="sh">''</span><span class="p">)</span>
</code></pre></div></div> <p><strong>Don’t forget</strong> to rename the object within each of these files to the respective names for simplicity, as follows:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    object      Mode1<span class="p">;</span>
</code></pre></div></div> <p>Finally, after changing the object name, copy these files into the time directory of <code class="language-plaintext highlighter-rouge">visualizationCase</code> we created earlier.</p> <h1 id="results">Results</h1> <p>To visualize the results, we can employ either ParaView or Tecplot for post-processing. However, another method involves utilizing the OpenFOAM vtk file extractions. While the first method is straightforward, let’s explore the second one instead.</p> <p>Begin by utilizing the <code class="language-plaintext highlighter-rouge">surfaces</code> function object executed through the command-line. Set up a <code class="language-plaintext highlighter-rouge">surfaces</code> file within the <code class="language-plaintext highlighter-rouge">system</code> directory as shown below:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>surfaces
<span class="o">{</span>
    <span class="nb">type            </span>surfaces<span class="p">;</span>
    libs            <span class="o">(</span><span class="s2">"libsampling.so"</span><span class="o">)</span><span class="p">;</span>
    writeControl   	timeStep<span class="p">;</span>
    writeInterval   10<span class="p">;</span>

    surfaceFormat   vtk<span class="p">;</span>
	
    fields          <span class="o">(</span>p U XDMD Mode1 Mode2 Mode3 Mode4 Mode5 Mode6 Mode7 Mode8 Mode9 Mode10 Mode11 Mode12 Mode13 Mode14 Mode15 Mode16 Mode17 Mode18 Mode19 Mode20<span class="o">)</span><span class="p">;</span>

    interpolationScheme cellPoint<span class="p">;</span>

    surfaces
    <span class="o">{</span>
        zNormal
        <span class="o">{</span>
            <span class="nb">type        </span>cuttingPlane<span class="p">;</span>
            point       <span class="o">(</span>0 0 0.05<span class="o">)</span><span class="p">;</span>
            normal      <span class="o">(</span>0 0 1<span class="o">)</span><span class="p">;</span>
            interpolate <span class="nb">true</span><span class="p">;</span>
        <span class="o">}</span>
    <span class="o">}</span><span class="p">;</span>
<span class="o">}</span><span class="p">;</span>
</code></pre></div></div> <p>Now, let’s proceed to extract the data using the postProcess utility with the command:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>postProcess <span class="nt">-func</span> surfaces
</code></pre></div></div> <p>Executing this command will generate a file named <code class="language-plaintext highlighter-rouge">surfaces</code> within the <code class="language-plaintext highlighter-rouge">postProcessing</code> directory, containing the surface field in a vtk file, as shown below:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>surfaces/
└── 1
    └── zNormal.vtp
</code></pre></div></div> <p>This vtk file can be readily opened in ParaView or VisIt for visualization. However, today we will visualize these fields in Python using the PyVista module. PyVista is a powerful tool for 3D data visualization, serving as an interface for the Visualization Toolkit (VTK). With PyVista, one can easily read and extract data from a vtk file. In your Jupyter file, start by importing the module:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">pyvista</span> <span class="k">as</span> <span class="n">pv</span>
</code></pre></div></div> <p>Then set the path variables:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">PathToSurfaces</span> <span class="o">=</span> <span class="sh">'</span><span class="s">E:/Blog_Posts/OpenFOAM_POD/TestCase_DMD/postProcessing/surfaces/1/</span><span class="sh">'</span>
<span class="n">Files</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="nf">listdir</span><span class="p">(</span><span class="n">PathToSurfaces</span><span class="p">)</span>
</code></pre></div></div> <p>Now, extract the VTK file using the PyVista module:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Data</span> <span class="o">=</span> <span class="n">pv</span><span class="p">.</span><span class="nf">read</span><span class="p">(</span><span class="n">PathToSurfaces</span> <span class="o">+</span> <span class="n">Files</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">grid</span> <span class="o">=</span> <span class="n">Data</span><span class="p">.</span><span class="n">points</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">grid</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">grid</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">grid</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span>
<span class="n">rows</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">shape</span><span class="p">(</span><span class="n">grid</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">rows = </span><span class="sh">'</span><span class="p">,</span> <span class="n">rows</span><span class="p">,</span> <span class="sh">'</span><span class="s">columns = </span><span class="sh">'</span><span class="p">,</span> <span class="n">columns</span><span class="p">)</span>
</code></pre></div></div> <p>Check which arrays are available within this extracted vtk file:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">print</span><span class="p">(</span><span class="n">Data</span><span class="p">.</span><span class="n">array_names</span><span class="p">)</span>
</code></pre></div></div> <p>Output:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="sh">'</span><span class="s">TimeValue</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">p</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Mode1</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Mode10</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Mode11</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Mode12</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Mode13</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Mode14</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Mode15</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Mode16</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Mode17</span><span class="sh">'</span><span class="p">,</span> 
<span class="sh">'</span><span class="s">Mode18</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Mode19</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Mode2</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Mode20</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Mode3</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Mode4</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Mode5</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Mode6</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Mode7</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Mode8</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Mode9</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">U</span><span class="sh">'</span><span class="p">,</span> 
<span class="sh">'</span><span class="s">XDMD</span><span class="sh">'</span><span class="p">]</span>
</code></pre></div></div> <p>Extract the DMD modes from the Data:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Velocity</span> <span class="o">=</span> <span class="n">Data</span><span class="p">[</span><span class="sh">'</span><span class="s">U</span><span class="sh">'</span><span class="p">]</span>
<span class="n">Pressure</span> <span class="o">=</span> <span class="n">Data</span><span class="p">[</span><span class="sh">'</span><span class="s">p</span><span class="sh">'</span><span class="p">]</span>
<span class="n">Mode1</span> <span class="o">=</span> <span class="n">Data</span><span class="p">[</span><span class="sh">'</span><span class="s">Mode1</span><span class="sh">'</span><span class="p">]</span>
<span class="n">Mode2</span> <span class="o">=</span> <span class="n">Data</span><span class="p">[</span><span class="sh">'</span><span class="s">Mode2</span><span class="sh">'</span><span class="p">]</span>
<span class="n">Mode3</span> <span class="o">=</span> <span class="n">Data</span><span class="p">[</span><span class="sh">'</span><span class="s">Mode3</span><span class="sh">'</span><span class="p">]</span>
<span class="n">Mode4</span> <span class="o">=</span> <span class="n">Data</span><span class="p">[</span><span class="sh">'</span><span class="s">Mode4</span><span class="sh">'</span><span class="p">]</span>
<span class="n">Mode5</span> <span class="o">=</span> <span class="n">Data</span><span class="p">[</span><span class="sh">'</span><span class="s">Mode5</span><span class="sh">'</span><span class="p">]</span>
<span class="n">Mode6</span> <span class="o">=</span> <span class="n">Data</span><span class="p">[</span><span class="sh">'</span><span class="s">Mode6</span><span class="sh">'</span><span class="p">]</span>
<span class="n">Mode7</span> <span class="o">=</span> <span class="n">Data</span><span class="p">[</span><span class="sh">'</span><span class="s">Mode7</span><span class="sh">'</span><span class="p">]</span>
<span class="n">Mode8</span> <span class="o">=</span> <span class="n">Data</span><span class="p">[</span><span class="sh">'</span><span class="s">Mode8</span><span class="sh">'</span><span class="p">]</span>
<span class="n">Mode9</span> <span class="o">=</span> <span class="n">Data</span><span class="p">[</span><span class="sh">'</span><span class="s">Mode9</span><span class="sh">'</span><span class="p">]</span>
<span class="n">Mode10</span> <span class="o">=</span> <span class="n">Data</span><span class="p">[</span><span class="sh">'</span><span class="s">Mode10</span><span class="sh">'</span><span class="p">]</span>
<span class="n">Mode11</span> <span class="o">=</span> <span class="n">Data</span><span class="p">[</span><span class="sh">'</span><span class="s">Mode11</span><span class="sh">'</span><span class="p">]</span>
<span class="n">Mode12</span> <span class="o">=</span> <span class="n">Data</span><span class="p">[</span><span class="sh">'</span><span class="s">Mode12</span><span class="sh">'</span><span class="p">]</span>
<span class="n">Mode13</span> <span class="o">=</span> <span class="n">Data</span><span class="p">[</span><span class="sh">'</span><span class="s">Mode13</span><span class="sh">'</span><span class="p">]</span>
<span class="n">Mode14</span> <span class="o">=</span> <span class="n">Data</span><span class="p">[</span><span class="sh">'</span><span class="s">Mode14</span><span class="sh">'</span><span class="p">]</span>
<span class="n">Mode15</span> <span class="o">=</span> <span class="n">Data</span><span class="p">[</span><span class="sh">'</span><span class="s">Mode15</span><span class="sh">'</span><span class="p">]</span>
<span class="n">Mode16</span> <span class="o">=</span> <span class="n">Data</span><span class="p">[</span><span class="sh">'</span><span class="s">Mode16</span><span class="sh">'</span><span class="p">]</span>
<span class="n">Mode17</span> <span class="o">=</span> <span class="n">Data</span><span class="p">[</span><span class="sh">'</span><span class="s">Mode17</span><span class="sh">'</span><span class="p">]</span>
<span class="n">Mode18</span> <span class="o">=</span> <span class="n">Data</span><span class="p">[</span><span class="sh">'</span><span class="s">Mode18</span><span class="sh">'</span><span class="p">]</span>
<span class="n">Mode19</span> <span class="o">=</span> <span class="n">Data</span><span class="p">[</span><span class="sh">'</span><span class="s">Mode19</span><span class="sh">'</span><span class="p">]</span>
<span class="n">Mode20</span> <span class="o">=</span> <span class="n">Data</span><span class="p">[</span><span class="sh">'</span><span class="s">Mode20</span><span class="sh">'</span><span class="p">]</span>
<span class="n">XDMD</span> <span class="o">=</span> <span class="n">Data</span><span class="p">[</span><span class="sh">'</span><span class="s">XDMD</span><span class="sh">'</span><span class="p">]</span>
</code></pre></div></div> <p>Then simply plot the DMD modes using simple matplotlib routines:</p> <figure> <img src="https://goswami-13.github.io/images/Post29/First6_DMDModes.jpeg" width="80%"> </figure> <p>In conclusion, in this article, we explored how to apply the Dynamic Mode Decomposition algorithm directly to snapshot data retrieved from OpenFOAM. In the next article, we’ll examine another method of computing DMD using OpenFOAM data, this time utilizing an extracted slice dataset from the simulation. This approach will allow us to work with larger datasets, more snapshots, and lesser spatial degrees of freedom.</p> </d-article> <d-appendix> <d-footnote-list></d-footnote-list> <d-citation-list></d-citation-list> </d-appendix> <d-bibliography src="/assets/bibliography/"></d-bibliography> <d-article> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/posts/2025/06/blog-post-54/">Tabulating 6-DOF Motion Kinematics in OpenFOAM using Python</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/posts/2025/06/blog-post-53/">Setting Up Overset Mesh Cases in OpenFOAM Made Easy</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/posts/2025/06/blog-post-52/">An Introduction to Overset Mesh in OpenFOAM</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/posts/2025/05/blog-post-51/">Python Tools for Analyzing and Visualizing Mesh Motion Simulations</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/posts/2025/03/blog-post-50/">Simulating Pure Pitching and Heaving Motions in OpenFOAM</a> </li> <br> <br> </d-article> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 Shubham Goswami, PhD. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script src="/assets/js/distillpub/overrides.js"></script> <script defer src="https://cdn.jsdelivr.net/npm/mermaid@10.7.0/dist/mermaid.min.js" integrity="sha256-TtLOdUA8mstPoO6sGvHIGx2ceXrrX4KgIItO06XOn8A=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/d3@7.8.5/dist/d3.min.js" integrity="sha256-1rA678n2xEx7x4cTZ5x4wpUCj6kUMZEZ5cxLSVSFWxw=" crossorigin="anonymous"></script> <script defer src="/assets/js/mermaid-setup.js?38ca0a0126f7328d2d9a46bad640931f" type="text/javascript"></script> <script src="https://cdn.jsdelivr.net/npm/diff2html@3.4.47/bundles/js/diff2html-ui.min.js" integrity="sha256-eU2TVHX633T1o/bTQp6iIJByYJEtZThhF9bKz/DcbbY=" crossorigin="anonymous"></script> <script defer src="/assets/js/diff2html-setup.js?80a6e52ce727518bbd3aed2bb6ba5601" type="text/javascript"></script> <script src="https://cdn.jsdelivr.net/npm/leaflet@1.9.4/dist/leaflet.min.js" integrity="sha256-MgH13bFTTNqsnuEoqNPBLDaqxjGH+lCpqrukmXc8Ppg=" crossorigin="anonymous"></script> <script defer src="/assets/js/leaflet-setup.js?b6313931e203b924523e2d8b75fe8874" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js" integrity="sha256-0q+JdOlScWOHcunpUk21uab1jW7C1deBQARHtKMcaB4=" crossorigin="anonymous"></script> <script defer src="/assets/js/chartjs-setup.js?183c5859923724fb1cb3c67593848e71" type="text/javascript"></script> <script src="https://cdn.jsdelivr.net/npm/echarts@5.5.0/dist/echarts.min.js" integrity="sha256-QvgynZibb2U53SsVu98NggJXYqwRL7tg3FeyfXvPOUY=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/echarts@5.5.0/theme/dark-fresh-cut.js" integrity="sha256-sm6Ui9w41++ZCWmIWDLC18a6ki72FQpWDiYTDxEPXwU=" crossorigin="anonymous"></script> <script defer src="/assets/js/echarts-setup.js?738178999630746a8d0cfc261fc47c2c" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/vega@5.27.0/build/vega.min.js" integrity="sha256-Yot/cfgMMMpFwkp/5azR20Tfkt24PFqQ6IQS+80HIZs=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/vega-lite@5.16.3/build/vega-lite.min.js" integrity="sha256-TvBvIS5jUN4BSy009usRjNzjI1qRrHPYv7xVLJyjUyw=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/vega-embed@6.24.0/build/vega-embed.min.js" integrity="sha256-FPCJ9JYCC9AZSpvC/t/wHBX7ybueZhIqOMjpWqfl3DU=" crossorigin="anonymous"></script> <script defer src="/assets/js/vega-setup.js?7c7bee055efe9312afc861b128fe5f36" type="text/javascript"></script> <script defer src="https://tikzjax.com/v1/tikzjax.js" integrity="sha256-+1qyucCXRZJrCg3lm3KxRt/7WXaYhBid4/1XJRHGB1E=" crossorigin="anonymous"></script> <script src="/assets/js/typograms.js?062e75bede72543443762dc3fe36c7a5"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?c8a01c11a92744d44b093fc3bda915df" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?a5bb4e6a542c546dd929b24b8b236dfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> <script type="module" src="/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/assets/js/search-setup.js?6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/assets/js/search-data.js"></script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>