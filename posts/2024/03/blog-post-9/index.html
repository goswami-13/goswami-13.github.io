<!DOCTYPE html> <html> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Dive Deeper with fluidfoam: Advanced Techniques for Extracting &amp; Analyzing OpenFOAM Data | Shubham Goswami, PhD </title> <meta name="author" content="Shubham Goswami, PhD"> <meta name="description" content="Personal and professional website of Shubham Goswami, PhD. "> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://goswami-13.github.io/posts/2024/03/blog-post-9/"> <script src="/assets/js/theme.js?a81d82887dd692e91686b43de4542f18"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> <link defer rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet@1.9.4/dist/leaflet.min.css" integrity="sha256-q9ba7o845pMPFU+zcAll8rv+gC+fSovKsOoNQ6cynuQ=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.9.0/styles/github.min.css" integrity="sha256-Oppd74ucMR5a5Dq96FxjEzGF7tTw2fZ/6ksAqDCM8GY=" crossorigin="anonymous" media="screen and (prefers-color-scheme: light)"> <link defer rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.9.0/styles/github-dark.min.css" integrity="sha256-nyCNAiECsdDHrr/s2OQsp5l9XeY2ZJ0rMepjCT2AkBk=" crossorigin="anonymous" media="screen and (prefers-color-scheme: dark)"> <link defer rel="stylesheet" href="https://cdn.jsdelivr.net/npm/diff2html@3.4.47/bundles/css/diff2html.min.css" integrity="sha256-IMBK4VNZp0ivwefSn51bswdsrhk0HoMTLc2GqFHFBXg=" crossorigin="anonymous"> <link defer rel="stylesheet" type="text/css" href="https://tikzjax.com/v1/fonts.css"> <script src="/assets/js/distillpub/template.v2.js"></script> <script src="/assets/js/distillpub/transforms.v2.js"></script> <style type="text/css">.fake-img{background:#bbb;border:1px solid rgba(0,0,0,0.1);box-shadow:0 0 4px rgba(0,0,0,0.1);margin-bottom:12px}.fake-img p{font-family:monospace;color:white;text-align:left;margin:12px 0;text-align:center;font-size:16px}</style> </head> <body> <d-front-matter> <script async type="text/json">
      {
            "title": "Dive Deeper with fluidfoam: Advanced Techniques for Extracting & Analyzing OpenFOAM Data",
            "description": "",
            "published": "February 26, 2024",
            "authors": [
              
            ],
            "katex": {
              "delimiters": [
                {
                  "left": "$",
                  "right": "$",
                  "display": false
                },
                {
                  "left": "$$",
                  "right": "$$",
                  "display": true
                }
              ]
            }
          }
    </script> </d-front-matter> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Shubham</span> Goswami, PhD </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">CV </a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">Guides </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">Publications </a> </li> <li class="nav-item "> <a class="nav-link" href="/teaching/">Teaching </a> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="post distill"> <d-title> <h1>Dive Deeper with fluidfoam: Advanced Techniques for Extracting &amp; Analyzing OpenFOAM Data</h1> <p></p> </d-title> <d-article> <d-contents> <nav class="l-text figcaption"> <h3>Contents</h3> </nav> </d-contents> <p>Craving deeper insights from your OpenFOAM simulations? Explore the wonders of Python post-processing with fluidfoam. Learn how to effortlessly extract and visualize key data points like force coefficients and velocity probes, turning complex data into clear and interpretable results. This guide equips you with the tools to unlock the true potential of your simulations and gain valuable knowledge from every run.</p> <figure> <img src="https://goswami-13.github.io/images/Post9/openfoam_logo.jpg" width="70%"> <img src="https://goswami-13.github.io/images/Post9/pythonWide.png" width="50%"> </figure> <p>In my previous article, we explored how Python is indespensible for data-analysis in OpenFOAM simulations, and briefly looked into <a href="https://fluidfoam.readthedocs.io/en/latest/" rel="external nofollow noopener" target="_blank">fluidfoam</a>, a specialized Python package tailored for OpenFOAM post-processing. Fluidfoam simplifies complex tasks like plotting velocity and pressure distributions, handling OpenFOAM-specific data structures seamlessly, and enabling insightful visualizations with minimal effort. It represents a significant advancement in post-processing workflows, empowering users to extract deeper insights from their simulation data. Here is my previous article for reference <a href="https://medium.com/stackademic/conquer-openfoam-post-processing-with-the-power-of-function-objects-and-python-3fdcba68f759" rel="external nofollow noopener" target="_blank">here</a>.</p> <p>In my previous article, I introduced the basics of fluidfoam, a specialized Python package designed for post-processing in OpenFOAM simulations. In this installment, I’m excited to delve deeper into advanced post-processing techniques using fluidfoam. Specifically, we’ll explore three key aspects:</p> <ol> <li>Extracting and plotting velocity at probe points.</li> <li>Extracting and plotting force coefficients.</li> <li>Plotting the power spectral density of velocity at probe points and force coefficients.</li> </ol> <p>These advanced techniques will enable us to gain deeper insights into our OpenFOAM simulations and enhance our understanding of fluid dynamics phenomena. So without further ado, let’s dive in!</p> <h2 id="ready-the-case">Ready the case</h2> <p>I’ll be demonstrating these post-processing techniques using a simulated flow around a circular cylinder as an example. You can access the example cases for download from <a href="https://github.com/goswami-13/OpenFOAM-cases/tree/main/4_Tutorials" rel="external nofollow noopener" target="_blank">here</a>, identified as <code class="language-plaintext highlighter-rouge">CircularCylinder_Laminar</code>. While I’ll be using this specific case for illustration, the techniques showcased are applicable to any simulation provided there is sufficient data available. For this demonstration, the <code class="language-plaintext highlighter-rouge">CircularCylinder_Laminar</code> case is initially run until 4000 seconds (<code class="language-plaintext highlighter-rouge">endTime</code>) to ensure fully-developed flow. Subsequently, the simulation is extended for another 1000 seconds with the inclusion of additional function objects in the <code class="language-plaintext highlighter-rouge">controlDict</code> under the <code class="language-plaintext highlighter-rouge">functions</code> sub-dictionary. Specifically, I incorporate function objects probes and forces into the simulation setup, as depicted below:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>functions
<span class="o">{</span>
    <span class="c">#includeFunc probes  </span>

    forces
    <span class="o">{</span>
        <span class="nb">type            </span>forceCoeffs<span class="p">;</span>
        libs <span class="o">(</span> <span class="s2">"libforces.so"</span> <span class="o">)</span><span class="p">;</span>
    
        writeControl   timeStep<span class="p">;</span>
        writeInterval  1<span class="p">;</span>
        
        patches         <span class="o">(</span> <span class="s2">"PRISM"</span> <span class="o">)</span><span class="p">;</span>
        
        rho             rhoInf<span class="p">;</span>
        log             <span class="nb">true</span><span class="p">;</span>
        rhoInf          1.225<span class="p">;</span>
        liftDir         <span class="o">(</span>0 1 0<span class="o">)</span><span class="p">;</span>
        dragDir         <span class="o">(</span>1 0 0<span class="o">)</span><span class="p">;</span>
        //sideDir         <span class="o">(</span>0 0 1<span class="o">)</span><span class="p">;</span>
        CofR            <span class="o">(</span>0 0 0<span class="o">)</span><span class="p">;</span>
        pitchAxis       <span class="o">(</span>0 0 1<span class="o">)</span><span class="p">;</span>
        magUInf         0.015<span class="p">;</span>
        lRef            0.1<span class="p">;</span>
        Aref            0.0628<span class="p">;</span>
    <span class="o">}</span>
    
<span class="o">}</span>
</code></pre></div></div> <p>Here, I’m including the <code class="language-plaintext highlighter-rouge">probes</code> file below for reference. In situations where you need to monitor multiple probe locations, such as hundreds of points, it’s advisable to maintain a separate file named <code class="language-plaintext highlighter-rouge">probes</code> within your <code class="language-plaintext highlighter-rouge">system</code> folder and then include this file in the <code class="language-plaintext highlighter-rouge">functions</code> section of your <code class="language-plaintext highlighter-rouge">controlDict</code> file. This approach helps maintain clarity and organization in your simulation setup. Here is an example of <code class="language-plaintext highlighter-rouge">probes</code> file,</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/<span class="k">*</span><span class="nt">--------------------------------</span><span class="k">*</span>- C++ -<span class="k">*</span><span class="nt">----------------------------------</span><span class="k">*</span><span class="se">\</span>
  <span class="o">=========</span>                 |
  <span class="se">\\</span>      /  F ield         | OpenFOAM: The Open Source CFD Toolbox
   <span class="se">\\</span>    /   O peration     |
    <span class="se">\\</span>  /    A nd           | Web:      www.OpenFOAM.com
     <span class="se">\\</span>/     M anipulation  |
<span class="nt">-------------------------------------------------------------------------------</span>
Description
    Writes out values of fields from cells nearest to specified locations.

<span class="se">\*</span><span class="nt">---------------------------------------------------------------------------</span><span class="k">*</span>/
probes
<span class="o">{</span>
    <span class="nb">type            </span>probes<span class="p">;</span>
    libs            <span class="o">(</span><span class="s2">"libsampling.so"</span><span class="o">)</span><span class="p">;</span>

    // Name of the directory <span class="k">for </span>probe data
    name            probes<span class="p">;</span>

    // Write at same frequency as fields
    writeControl    timeStep<span class="p">;</span>
    writeInterval   1<span class="p">;</span>

fields <span class="o">(</span>
        p 
        U 
       <span class="o">)</span><span class="p">;</span>

probeLocations
<span class="o">(</span>

	<span class="o">(</span>0.01 0 0<span class="o">)</span>
	<span class="o">(</span>0.02 0 0<span class="o">)</span>
	<span class="o">(</span>0.03 0 0<span class="o">)</span>
	<span class="o">(</span>0.04 0 0<span class="o">)</span>
	<span class="o">(</span>0.05 0 0<span class="o">)</span>
	
<span class="o">)</span><span class="p">;</span>
    // Optional: filter out points that haven<span class="s1">'t been found. Default
    //           is to include them (with value -VGREAT)
    includeOutOfBounds  true;
}
// ************************************************************************* //
</span></code></pre></div></div> <p>Running the simulations for the last 1000 seconds with function objects will generate a directory named <code class="language-plaintext highlighter-rouge">postProcessing</code> within your case directory. This <code class="language-plaintext highlighter-rouge">postProcessing</code> directory will contain the data derived from the function objects, structured as illustrated below:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>postProcessing
├── forces
│   └── 3996.9
│       └── coefficient.dat
└── probes
    └── 3996.9
        ├── U
        └── p
</code></pre></div></div> <h2 id="understanding-probe-data-extraction">Understanding Probe Data Extraction</h2> <p>To extract and plot the probes, we’ll utilize the fluidfoam and matplotlib packages in Python. Let’s start by importing the necessary modules. While I typically prefer using Jupyter Notebook (.ipynb), these steps are also applicable for a Python script (.py).</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">matplotlib.colors</span>
<span class="kn">import</span> <span class="n">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="n">fluidfoam</span> <span class="k">as</span> <span class="n">fl</span>
<span class="kn">import</span> <span class="n">scipy</span> <span class="k">as</span> <span class="n">sp</span>

<span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>

<span class="n">plt</span><span class="p">.</span><span class="n">rcParams</span><span class="p">.</span><span class="nf">update</span><span class="p">({</span><span class="sh">'</span><span class="s">font.size</span><span class="sh">'</span> <span class="p">:</span> <span class="mi">14</span><span class="p">,</span> <span class="sh">'</span><span class="s">font.family</span><span class="sh">'</span> <span class="p">:</span> <span class="sh">'</span><span class="s">Times New Roman</span><span class="sh">'</span><span class="p">,</span> <span class="sh">"</span><span class="s">text.usetex</span><span class="sh">"</span><span class="p">:</span> <span class="bp">True</span><span class="p">})</span>
</code></pre></div></div> <p>Set a path to your case,</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">### Path to CircularCylinder_Laminar/postProcessing directory
</span><span class="n">Path</span> <span class="o">=</span> <span class="sh">'</span><span class="s">E:/4_Tutorials/CircularCylinder_Laminar/postProcessing</span><span class="sh">'</span>
<span class="c1">### Path where to save the figures
</span><span class="n">save_path</span> <span class="o">=</span> <span class="sh">'</span><span class="s">E:/4_Tutorials/CircularCylinder_Laminar/</span><span class="sh">'</span>
</code></pre></div></div> <p>Let’s extract the velocity probes. We’ll accomplish this using the <code class="language-plaintext highlighter-rouge">readprobes</code> function from within fluidfoam. With this function, we have the flexibility to extract probe data from all folders within <code class="language-plaintext highlighter-rouge">postProcessing</code> using the <code class="language-plaintext highlighter-rouge">mergeTime</code> option, or we can solely extract data from the last-run time directory using the <code class="language-plaintext highlighter-rouge">latestTime</code> option. In the following example, I’ll extract the probes using the <code class="language-plaintext highlighter-rouge">latestTime</code> option:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">### Read Probes of u
</span><span class="n">probes_locU</span><span class="p">,</span> <span class="n">timeU</span><span class="p">,</span> <span class="n">u</span> <span class="o">=</span> <span class="n">fl</span><span class="p">.</span><span class="n">readpostpro</span><span class="p">.</span><span class="nf">readprobes</span><span class="p">(</span><span class="n">Path</span> <span class="p">,</span><span class="n">probes_name</span><span class="o">=</span><span class="sh">'</span><span class="s">probes</span><span class="sh">'</span><span class="p">,</span><span class="n">time_name</span><span class="o">=</span><span class="sh">'</span><span class="s">latestTime</span><span class="sh">'</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="sh">'</span><span class="s">u</span><span class="sh">'</span><span class="p">)</span>
</code></pre></div></div> <p>This function extracts three main components: probe locations, the corresponding time stamps for each probe, and the velocity components at these probe locations. Probe locations are presented as a numpy array and can be non-dimensionalized as follows:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">### Probe Locations 
</span><span class="n">Locations</span> <span class="o">=</span> <span class="n">probes_locU</span><span class="o">/</span><span class="mf">0.1</span>
<span class="nf">print</span><span class="p">(</span><span class="n">Locations</span><span class="p">)</span>
</code></pre></div></div> <p>I typically recommend visualizing these probe locations in a tabular format for better comprehension. Since we’re dealing with only 5 probes in this example, I’ll print out these locations here. They appear in the format (x, y, z):</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[[</span><span class="mf">0.1</span> <span class="mf">0.</span>  <span class="mf">0.</span> <span class="p">]</span>
 <span class="p">[</span><span class="mf">0.2</span> <span class="mf">0.</span>  <span class="mf">0.</span> <span class="p">]</span>
 <span class="p">[</span><span class="mf">0.3</span> <span class="mf">0.</span>  <span class="mf">0.</span> <span class="p">]</span>
 <span class="p">[</span><span class="mf">0.4</span> <span class="mf">0.</span>  <span class="mf">0.</span> <span class="p">]]</span>
</code></pre></div></div> <p>The velocity at these probe locations is extracted in the format: <code class="language-plaintext highlighter-rouge">u[probes list (all or index), Probe location (from Probes_locU), velocity components (ux, uy, uz) = (0,1,2)]</code>. This means the first index of u represents the list of all velocities, the second index signifies the index-location of the probe, and the third index represents the velocity components as <code class="language-plaintext highlighter-rouge">(ux, uy, uz) = (0, 1, 2)</code>.</p> <p>You can plot the velocity at any probe location using the following method:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">timeU</span><span class="p">,</span> <span class="n">u</span><span class="p">[:,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="sh">'</span><span class="s">$u$</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">axhline</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">mean</span><span class="p">(</span><span class="n">u</span><span class="p">[:,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="sh">'</span><span class="s">k</span><span class="sh">'</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="sh">'</span><span class="s">--</span><span class="sh">'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="sh">'</span><span class="s">$\overline{u}$</span><span class="sh">'</span><span class="p">)</span>

<span class="n">ax</span><span class="p">.</span><span class="nf">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="sh">'</span><span class="s">$u$ (m/s)</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="sh">'</span><span class="s">$t$ (s)</span><span class="sh">'</span><span class="p">)</span>

<span class="n">ax</span><span class="p">.</span><span class="n">xaxis</span><span class="p">.</span><span class="nf">set_tick_params</span><span class="p">(</span><span class="n">direction</span><span class="o">=</span><span class="sh">'</span><span class="s">in</span><span class="sh">'</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="sh">'</span><span class="s">both</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="n">yaxis</span><span class="p">.</span><span class="nf">set_tick_params</span><span class="p">(</span><span class="n">direction</span><span class="o">=</span><span class="sh">'</span><span class="s">in</span><span class="sh">'</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="sh">'</span><span class="s">both</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="n">xaxis</span><span class="p">.</span><span class="nf">set_ticks_position</span><span class="p">(</span><span class="sh">'</span><span class="s">both</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="n">yaxis</span><span class="p">.</span><span class="nf">set_ticks_position</span><span class="p">(</span><span class="sh">'</span><span class="s">both</span><span class="sh">'</span><span class="p">)</span>

<span class="n">ax</span><span class="p">.</span><span class="nf">legend</span><span class="p">(</span><span class="n">loc</span> <span class="o">=</span> <span class="sh">'</span><span class="s">center left</span><span class="sh">'</span><span class="p">,</span> <span class="n">frameon</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">bbox_to_anchor</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))</span>


<span class="n">plt</span><span class="p">.</span><span class="nf">savefig</span><span class="p">(</span><span class="n">save_path</span> <span class="o">+</span> <span class="sh">'</span><span class="s">probeVelocity.jpeg</span><span class="sh">'</span><span class="p">,</span> <span class="n">dpi</span> <span class="o">=</span> <span class="mi">300</span><span class="p">,</span> <span class="n">bbox_inches</span> <span class="o">=</span> <span class="sh">'</span><span class="s">tight</span><span class="sh">'</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</code></pre></div></div> <figure> <img src="https://goswami-13.github.io/images/Post9/probeVelocity.jpeg" width="50%"> </figure> <h2 id="understanding-force-coefficient-extraction">Understanding Force Coefficient Extraction</h2> <p>In the same way, we can plot the force coefficients by,</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">### extract the force coefficients
</span><span class="n">forces_Coefficients</span> <span class="o">=</span> <span class="n">fl</span><span class="p">.</span><span class="n">readpostpro</span><span class="p">.</span><span class="nf">readforce</span><span class="p">(</span><span class="n">Path</span><span class="p">,</span><span class="n">namepatch</span><span class="o">=</span><span class="sh">'</span><span class="s">forces</span><span class="sh">'</span><span class="p">,</span><span class="n">time_name</span><span class="o">=</span><span class="sh">'</span><span class="s">mergeTime</span><span class="sh">'</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="sh">'</span><span class="s">coefficient</span><span class="sh">'</span><span class="p">)</span>
<span class="c1">### Create a pandas dataframe for better column organization
### In the pressent case, the column titles are copied from the coefficient file.
</span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">(</span><span class="n">forces_Coefficients</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sh">'</span><span class="s">Time</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">Cd</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">Cs</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">Cl</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">CmRoll</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">CmPitch</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">CmYaw</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">Cdf</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">Cdr</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">Csf</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">Csr</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">Clf</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">Clr</span><span class="sh">'</span><span class="p">])</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">ax</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">df</span><span class="p">.</span><span class="n">Time</span><span class="p">,</span> <span class="n">df</span><span class="p">.</span><span class="n">Cd</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="sh">'</span><span class="s">$C_d$</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">axhline</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">mean</span><span class="p">(</span><span class="n">df</span><span class="p">.</span><span class="n">Cd</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="sh">'</span><span class="s">k</span><span class="sh">'</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="sh">'</span><span class="s">--</span><span class="sh">'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="sh">'</span><span class="s">$\overline{C_d}$</span><span class="sh">'</span><span class="p">)</span>

<span class="n">ax</span><span class="p">.</span><span class="nf">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="sh">'</span><span class="s">$C_d$</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="sh">'</span><span class="s">$t$ (s)</span><span class="sh">'</span><span class="p">)</span>

<span class="n">ax</span><span class="p">.</span><span class="n">xaxis</span><span class="p">.</span><span class="nf">set_tick_params</span><span class="p">(</span><span class="n">direction</span><span class="o">=</span><span class="sh">'</span><span class="s">in</span><span class="sh">'</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="sh">'</span><span class="s">both</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="n">yaxis</span><span class="p">.</span><span class="nf">set_tick_params</span><span class="p">(</span><span class="n">direction</span><span class="o">=</span><span class="sh">'</span><span class="s">in</span><span class="sh">'</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="sh">'</span><span class="s">both</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="n">xaxis</span><span class="p">.</span><span class="nf">set_ticks_position</span><span class="p">(</span><span class="sh">'</span><span class="s">both</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="n">yaxis</span><span class="p">.</span><span class="nf">set_ticks_position</span><span class="p">(</span><span class="sh">'</span><span class="s">both</span><span class="sh">'</span><span class="p">)</span>

<span class="n">ax</span><span class="p">.</span><span class="nf">legend</span><span class="p">(</span><span class="n">loc</span> <span class="o">=</span> <span class="sh">'</span><span class="s">upper right</span><span class="sh">'</span><span class="p">,</span> <span class="n">frameon</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span> <span class="c1"># or 'best', 'upper right', etc
</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">set_xlim</span><span class="p">(</span><span class="mi">3900</span><span class="p">,</span> <span class="mi">5400</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="n">ax</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">df</span><span class="p">.</span><span class="n">Time</span><span class="p">,</span> <span class="n">df</span><span class="p">.</span><span class="n">Cl</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="sh">'</span><span class="s">$C_l$</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">axhline</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">mean</span><span class="p">(</span><span class="n">df</span><span class="p">.</span><span class="n">Cl</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="sh">'</span><span class="s">k</span><span class="sh">'</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="sh">'</span><span class="s">--</span><span class="sh">'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="sh">'</span><span class="s">$\overline{C_l}$</span><span class="sh">'</span><span class="p">)</span>

<span class="n">ax</span><span class="p">.</span><span class="nf">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="sh">'</span><span class="s">$C_l$</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="sh">'</span><span class="s">$t$ (s)</span><span class="sh">'</span><span class="p">)</span>

<span class="n">ax</span><span class="p">.</span><span class="n">xaxis</span><span class="p">.</span><span class="nf">set_tick_params</span><span class="p">(</span><span class="n">direction</span><span class="o">=</span><span class="sh">'</span><span class="s">in</span><span class="sh">'</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="sh">'</span><span class="s">both</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="n">yaxis</span><span class="p">.</span><span class="nf">set_tick_params</span><span class="p">(</span><span class="n">direction</span><span class="o">=</span><span class="sh">'</span><span class="s">in</span><span class="sh">'</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="sh">'</span><span class="s">both</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="n">xaxis</span><span class="p">.</span><span class="nf">set_ticks_position</span><span class="p">(</span><span class="sh">'</span><span class="s">both</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="n">yaxis</span><span class="p">.</span><span class="nf">set_ticks_position</span><span class="p">(</span><span class="sh">'</span><span class="s">both</span><span class="sh">'</span><span class="p">)</span>

<span class="n">ax</span><span class="p">.</span><span class="nf">legend</span><span class="p">(</span><span class="n">loc</span> <span class="o">=</span> <span class="sh">'</span><span class="s">upper right</span><span class="sh">'</span><span class="p">,</span> <span class="n">frameon</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span> <span class="c1"># or 'best', 'upper right', etc
</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">set_xlim</span><span class="p">(</span><span class="mi">3900</span><span class="p">,</span> <span class="mi">5400</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">savefig</span><span class="p">(</span><span class="n">save_path</span> <span class="o">+</span> <span class="sh">'</span><span class="s">Forces.jpeg</span><span class="sh">'</span><span class="p">,</span> <span class="n">dpi</span> <span class="o">=</span> <span class="mi">300</span><span class="p">,</span> <span class="n">bbox_inches</span> <span class="o">=</span> <span class="sh">'</span><span class="s">tight</span><span class="sh">'</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>

</code></pre></div></div> <figure> <img src="https://goswami-13.github.io/images/Post9/Forces.jpeg" width="90%"> </figure> <h2 id="power-spectral-density-of-velocity-and-force-coefficient">Power spectral density of velocity and force coefficient</h2> <p>The power spectral density characterizes the power contained within a signal across different frequencies. In wake studies conducted using Computational Fluid Dynamics (CFD), power spectral density is employed to identify dominant frequencies within the flow, often used to estimate the Strouhal number - a non-dimensional frequency parameter. The Strouhal number (St) is computed as St = f*L/U, where f represents the vortex shedding frequency, L denotes the characteristic length scale, and U signifies the free-stream velocity. Generating the power spectrum of velocity at specific probe locations involves:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">### FFT 
</span>
<span class="c1">### Constants
</span><span class="n">d</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">Ub</span> <span class="o">=</span> <span class="mf">0.015</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mf">0.2</span>
<span class="n">fs</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">dt</span>

<span class="n">Signal1</span> <span class="o">=</span> <span class="n">u</span><span class="p">[:,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>

<span class="c1">### PSD using welch
</span><span class="n">f1</span><span class="p">,</span> <span class="n">Eu1</span> <span class="o">=</span> <span class="n">sp</span><span class="p">.</span><span class="n">signal</span><span class="p">.</span><span class="nf">welch</span><span class="p">(</span><span class="n">Signal1</span><span class="p">,</span> <span class="n">fs</span><span class="p">,</span> <span class="n">nfft</span> <span class="o">=</span> <span class="nf">len</span><span class="p">(</span><span class="n">Signal1</span><span class="p">),</span> <span class="n">nperseg</span><span class="o">=</span><span class="nf">len</span><span class="p">(</span><span class="n">Signal1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="sh">'</span><span class="s">hamming</span><span class="sh">'</span><span class="p">)</span>
<span class="n">St1</span> <span class="o">=</span> <span class="n">f1</span><span class="o">*</span><span class="n">d</span><span class="o">/</span><span class="n">Ub</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">subplots</span><span class="p">()</span>

<span class="n">ax</span><span class="p">.</span><span class="nf">loglog</span><span class="p">(</span><span class="n">St1</span><span class="p">,</span> <span class="n">Eu1</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="p">(</span><span class="sa">r</span><span class="sh">'</span><span class="s">$\bf E_x$</span><span class="sh">'</span><span class="p">))</span>

<span class="c1">### Mark and print the dominant frequency
</span><span class="n">xmax</span> <span class="o">=</span> <span class="n">St1</span><span class="p">[</span><span class="n">np</span><span class="p">.</span><span class="nf">argmax</span><span class="p">(</span><span class="n">Eu1</span><span class="o">*</span><span class="n">f1</span><span class="o">/</span><span class="p">(</span><span class="n">Ub</span><span class="o">**</span><span class="mi">2</span><span class="p">))]</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Strouhal Number = </span><span class="sh">"</span><span class="p">,</span> <span class="n">xmax</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">axvline</span><span class="p">(</span><span class="n">xmax</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="sh">'</span><span class="s">r</span><span class="sh">'</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="sh">'</span><span class="s">--</span><span class="sh">'</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>

<span class="n">ax</span><span class="p">.</span><span class="nf">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="sh">'</span><span class="s">best</span><span class="sh">'</span><span class="p">,</span> <span class="n">frameon</span> <span class="o">=</span> <span class="bp">False</span><span class="p">);</span> <span class="c1"># or 'best', 'upper right', etc
</span><span class="n">ax</span><span class="p">.</span><span class="nf">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="sh">'</span><span class="s">$St$</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="sh">'</span><span class="s">$E_{u_i}$</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="n">xaxis</span><span class="p">.</span><span class="nf">set_tick_params</span><span class="p">(</span><span class="n">direction</span><span class="o">=</span><span class="sh">'</span><span class="s">in</span><span class="sh">'</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="sh">'</span><span class="s">both</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="n">yaxis</span><span class="p">.</span><span class="nf">set_tick_params</span><span class="p">(</span><span class="n">direction</span><span class="o">=</span><span class="sh">'</span><span class="s">in</span><span class="sh">'</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="sh">'</span><span class="s">both</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="n">xaxis</span><span class="p">.</span><span class="nf">set_ticks_position</span><span class="p">(</span><span class="sh">'</span><span class="s">both</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="n">yaxis</span><span class="p">.</span><span class="nf">set_ticks_position</span><span class="p">(</span><span class="sh">'</span><span class="s">both</span><span class="sh">'</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">savefig</span><span class="p">(</span><span class="n">save_path</span> <span class="o">+</span> <span class="sh">'</span><span class="s">Power.jpeg</span><span class="sh">'</span><span class="p">,</span> <span class="n">dpi</span> <span class="o">=</span> <span class="mi">300</span><span class="p">,</span> <span class="n">bbox_inches</span> <span class="o">=</span> <span class="sh">'</span><span class="s">tight</span><span class="sh">'</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</code></pre></div></div> <figure> <img src="https://goswami-13.github.io/images/Post9/Power.jpeg" width="50%"> </figure> <p>To compute the power spectrum of the coefficient of drag, simply substitute the signal with <code class="language-plaintext highlighter-rouge">df.Cd</code>, as demonstrated below:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">### FFT 
</span>
<span class="c1">### Constants
</span><span class="n">d</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">Ub</span> <span class="o">=</span> <span class="mf">0.015</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mf">0.2</span>
<span class="n">fs</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">dt</span>

<span class="n">Signal1</span> <span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="n">Cd</span>

<span class="c1">### PSD using welch
</span><span class="n">f1</span><span class="p">,</span> <span class="n">Eu1</span> <span class="o">=</span> <span class="n">sp</span><span class="p">.</span><span class="n">signal</span><span class="p">.</span><span class="nf">welch</span><span class="p">(</span><span class="n">Signal1</span><span class="p">,</span> <span class="n">fs</span><span class="p">,</span> <span class="n">nfft</span> <span class="o">=</span> <span class="nf">len</span><span class="p">(</span><span class="n">Signal1</span><span class="p">),</span> <span class="n">nperseg</span><span class="o">=</span><span class="nf">len</span><span class="p">(</span><span class="n">Signal1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="sh">'</span><span class="s">hamming</span><span class="sh">'</span><span class="p">)</span>
<span class="n">St1</span> <span class="o">=</span> <span class="n">f1</span><span class="o">*</span><span class="n">d</span><span class="o">/</span><span class="n">Ub</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">subplots</span><span class="p">()</span>

<span class="n">ax</span><span class="p">.</span><span class="nf">loglog</span><span class="p">(</span><span class="n">St1</span><span class="p">,</span> <span class="n">Eu1</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="p">(</span><span class="sa">r</span><span class="sh">'</span><span class="s">$\bf E_{drag}$</span><span class="sh">'</span><span class="p">))</span>

<span class="c1">### Mark and print the dominant frequency
</span><span class="n">xmax</span> <span class="o">=</span> <span class="n">St1</span><span class="p">[</span><span class="n">np</span><span class="p">.</span><span class="nf">argmax</span><span class="p">(</span><span class="n">Eu1</span><span class="o">*</span><span class="n">f1</span><span class="o">/</span><span class="p">(</span><span class="n">Ub</span><span class="o">**</span><span class="mi">2</span><span class="p">))]</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Strouhal Number = </span><span class="sh">"</span><span class="p">,</span> <span class="n">xmax</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">axvline</span><span class="p">(</span><span class="n">xmax</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="sh">'</span><span class="s">r</span><span class="sh">'</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="sh">'</span><span class="s">--</span><span class="sh">'</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>

<span class="n">ax</span><span class="p">.</span><span class="nf">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="sh">'</span><span class="s">best</span><span class="sh">'</span><span class="p">,</span> <span class="n">frameon</span> <span class="o">=</span> <span class="bp">False</span><span class="p">);</span> <span class="c1"># or 'best', 'upper right', etc
</span><span class="n">ax</span><span class="p">.</span><span class="nf">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="sh">'</span><span class="s">$St$</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="sh">'</span><span class="s">$E_{u_i}$</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="n">xaxis</span><span class="p">.</span><span class="nf">set_tick_params</span><span class="p">(</span><span class="n">direction</span><span class="o">=</span><span class="sh">'</span><span class="s">in</span><span class="sh">'</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="sh">'</span><span class="s">both</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="n">yaxis</span><span class="p">.</span><span class="nf">set_tick_params</span><span class="p">(</span><span class="n">direction</span><span class="o">=</span><span class="sh">'</span><span class="s">in</span><span class="sh">'</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="sh">'</span><span class="s">both</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="n">xaxis</span><span class="p">.</span><span class="nf">set_ticks_position</span><span class="p">(</span><span class="sh">'</span><span class="s">both</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="n">yaxis</span><span class="p">.</span><span class="nf">set_ticks_position</span><span class="p">(</span><span class="sh">'</span><span class="s">both</span><span class="sh">'</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">savefig</span><span class="p">(</span><span class="n">save_path</span> <span class="o">+</span> <span class="sh">'</span><span class="s">PowerDrag.jpeg</span><span class="sh">'</span><span class="p">,</span> <span class="n">dpi</span> <span class="o">=</span> <span class="mi">300</span><span class="p">,</span> <span class="n">bbox_inches</span> <span class="o">=</span> <span class="sh">'</span><span class="s">tight</span><span class="sh">'</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</code></pre></div></div> <figure> <img src="https://goswami-13.github.io/images/Post9/PowerDrag.jpeg" width="50%"> </figure> <p>In conclusion, mastering advanced post-processing techniques such as extracting and analyzing velocity probes, plotting force coefficients, and examining power spectral density is essential for gaining deeper insights into fluid dynamics simulations. Through the utilization of tools like fluidfoam and Python libraries such as matplotlib, we can efficiently extract and visualize crucial data points, enabling us to better understand the behavior of fluid flows in complex systems. By harnessing these techniques, researchers and engineers can enhance their ability to interpret simulation results, leading to more accurate predictions and informed decision-making in various fields, from aerospace engineering to renewable energy applications. As computational fluid dynamics continues to advance, proficiency in post-processing methodologies will remain paramount for unlocking new discoveries and pushing the boundaries of fluid dynamics research and development. Happy computing!</p> </d-article> <d-appendix> <d-footnote-list></d-footnote-list> <d-citation-list></d-citation-list> </d-appendix> <d-bibliography src="/assets/bibliography/"></d-bibliography> <d-article> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/posts/2025/06/blog-post-54/">Tabulating 6-DOF Motion Kinematics in OpenFOAM using Python</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/posts/2025/06/blog-post-53/">Setting Up Overset Mesh Cases in OpenFOAM Made Easy</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/posts/2025/06/blog-post-52/">An Introduction to Overset Mesh in OpenFOAM</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/posts/2025/05/blog-post-51/">Python Tools for Analyzing and Visualizing Mesh Motion Simulations</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/posts/2025/03/blog-post-50/">Simulating Pure Pitching and Heaving Motions in OpenFOAM</a> </li> <br> <br> </d-article> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 Shubham Goswami, PhD. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script src="/assets/js/distillpub/overrides.js"></script> <script defer src="https://cdn.jsdelivr.net/npm/mermaid@10.7.0/dist/mermaid.min.js" integrity="sha256-TtLOdUA8mstPoO6sGvHIGx2ceXrrX4KgIItO06XOn8A=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/d3@7.8.5/dist/d3.min.js" integrity="sha256-1rA678n2xEx7x4cTZ5x4wpUCj6kUMZEZ5cxLSVSFWxw=" crossorigin="anonymous"></script> <script defer src="/assets/js/mermaid-setup.js?38ca0a0126f7328d2d9a46bad640931f" type="text/javascript"></script> <script src="https://cdn.jsdelivr.net/npm/diff2html@3.4.47/bundles/js/diff2html-ui.min.js" integrity="sha256-eU2TVHX633T1o/bTQp6iIJByYJEtZThhF9bKz/DcbbY=" crossorigin="anonymous"></script> <script defer src="/assets/js/diff2html-setup.js?80a6e52ce727518bbd3aed2bb6ba5601" type="text/javascript"></script> <script src="https://cdn.jsdelivr.net/npm/leaflet@1.9.4/dist/leaflet.min.js" integrity="sha256-MgH13bFTTNqsnuEoqNPBLDaqxjGH+lCpqrukmXc8Ppg=" crossorigin="anonymous"></script> <script defer src="/assets/js/leaflet-setup.js?b6313931e203b924523e2d8b75fe8874" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js" integrity="sha256-0q+JdOlScWOHcunpUk21uab1jW7C1deBQARHtKMcaB4=" crossorigin="anonymous"></script> <script defer src="/assets/js/chartjs-setup.js?183c5859923724fb1cb3c67593848e71" type="text/javascript"></script> <script src="https://cdn.jsdelivr.net/npm/echarts@5.5.0/dist/echarts.min.js" integrity="sha256-QvgynZibb2U53SsVu98NggJXYqwRL7tg3FeyfXvPOUY=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/echarts@5.5.0/theme/dark-fresh-cut.js" integrity="sha256-sm6Ui9w41++ZCWmIWDLC18a6ki72FQpWDiYTDxEPXwU=" crossorigin="anonymous"></script> <script defer src="/assets/js/echarts-setup.js?738178999630746a8d0cfc261fc47c2c" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/vega@5.27.0/build/vega.min.js" integrity="sha256-Yot/cfgMMMpFwkp/5azR20Tfkt24PFqQ6IQS+80HIZs=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/vega-lite@5.16.3/build/vega-lite.min.js" integrity="sha256-TvBvIS5jUN4BSy009usRjNzjI1qRrHPYv7xVLJyjUyw=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/vega-embed@6.24.0/build/vega-embed.min.js" integrity="sha256-FPCJ9JYCC9AZSpvC/t/wHBX7ybueZhIqOMjpWqfl3DU=" crossorigin="anonymous"></script> <script defer src="/assets/js/vega-setup.js?7c7bee055efe9312afc861b128fe5f36" type="text/javascript"></script> <script defer src="https://tikzjax.com/v1/tikzjax.js" integrity="sha256-+1qyucCXRZJrCg3lm3KxRt/7WXaYhBid4/1XJRHGB1E=" crossorigin="anonymous"></script> <script src="/assets/js/typograms.js?062e75bede72543443762dc3fe36c7a5"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?c8a01c11a92744d44b093fc3bda915df" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?a5bb4e6a542c546dd929b24b8b236dfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> <script type="module" src="/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/assets/js/search-setup.js?6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/assets/js/search-data.js"></script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>