<!DOCTYPE html> <html> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Compressed Sensing: Reconstructing the Whole from the Sparse | Shubham Goswami, PhD </title> <meta name="author" content="Shubham Goswami, PhD"> <meta name="description" content="Personal and professional website of Shubham Goswami, PhD. "> <link rel="stylesheet" href="/al-folio/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/al-folio/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/al-folio/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/al-folio/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/al-folio/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://shubhamdgoswami.github.io/al-folio/posts/2024/11/blog-post-39/"> <script src="/al-folio/assets/js/theme.js?a81d82887dd692e91686b43de4542f18"></script> <link defer rel="stylesheet" href="/al-folio/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> <link defer rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet@1.9.4/dist/leaflet.min.css" integrity="sha256-q9ba7o845pMPFU+zcAll8rv+gC+fSovKsOoNQ6cynuQ=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.9.0/styles/github.min.css" integrity="sha256-Oppd74ucMR5a5Dq96FxjEzGF7tTw2fZ/6ksAqDCM8GY=" crossorigin="anonymous" media="screen and (prefers-color-scheme: light)"> <link defer rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.9.0/styles/github-dark.min.css" integrity="sha256-nyCNAiECsdDHrr/s2OQsp5l9XeY2ZJ0rMepjCT2AkBk=" crossorigin="anonymous" media="screen and (prefers-color-scheme: dark)"> <link defer rel="stylesheet" href="https://cdn.jsdelivr.net/npm/diff2html@3.4.47/bundles/css/diff2html.min.css" integrity="sha256-IMBK4VNZp0ivwefSn51bswdsrhk0HoMTLc2GqFHFBXg=" crossorigin="anonymous"> <link defer rel="stylesheet" type="text/css" href="https://tikzjax.com/v1/fonts.css"> <script src="/al-folio/assets/js/distillpub/template.v2.js"></script> <script src="/al-folio/assets/js/distillpub/transforms.v2.js"></script> <style type="text/css">.fake-img{background:#bbb;border:1px solid rgba(0,0,0,0.1);box-shadow:0 0 4px rgba(0,0,0,0.1);margin-bottom:12px}.fake-img p{font-family:monospace;color:white;text-align:left;margin:12px 0;text-align:center;font-size:16px}</style> </head> <body> <d-front-matter> <script async type="text/json">
      {
            "title": "Compressed Sensing: Reconstructing the Whole from the Sparse",
            "description": "",
            "published": "November 11, 2024",
            "authors": [
              
            ],
            "katex": {
              "delimiters": [
                {
                  "left": "$",
                  "right": "$",
                  "display": false
                },
                {
                  "left": "$$",
                  "right": "$$",
                  "display": true
                }
              ]
            }
          }
    </script> </d-front-matter> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/al-folio/"> <span class="font-weight-bold">Shubham</span> Goswami, PhD </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/al-folio/">About </a> </li> <li class="nav-item "> <a class="nav-link" href="/al-folio/cv/">CV </a> </li> <li class="nav-item "> <a class="nav-link" href="/al-folio/blog/">Guides </a> </li> <li class="nav-item "> <a class="nav-link" href="/al-folio/publications/">Publications </a> </li> <li class="nav-item "> <a class="nav-link" href="/al-folio/teaching/">Teaching </a> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="post distill"> <d-title> <h1>Compressed Sensing: Reconstructing the Whole from the Sparse</h1> <p></p> </d-title> <d-article> <d-contents> <nav class="l-text figcaption"> <h3>Contents</h3> </nav> </d-contents> <p>In the world of data acquisition, the need for high-resolution measurements often comes with a cost‚Äîboth in terms of time and resources. Compressed sensing offers a paradigm shift by allowing us to reconstruct high-fidelity signals from a small number of measurements, challenging traditional sampling techniques. This article explores the core principles of compressed sensing and demonstrates how sparse representations can be leveraged to recover information efficiently, making it a powerful tool in fields ranging from medical imaging to signal processing.</p> <figure> <img src="https://goswami-13.github.io/images/Post38/BlogLogo.jpeg" width="80%"> </figure> <p>Compressed sensing (CS) is a signal processing technique that enables the reconstruction of sparse or compressible signals using fewer measurements than traditional methods typically require. It leverages the idea that many natural signals or datasets possess inherent sparsity ‚Äî meaning they can be represented by a relatively small number of significant components in a suitable basis, such as Fourier or wavelet transforms.</p> <p>The fundamental assumption in compressed sensing is that a signal is sparse in a particular domain. While the signal may appear complex or dense in its original form, it can often be expressed using only a few significant components (or coefficients) when transformed into a different basis. For instance, a signal that seems intricate in the time domain may have only a handful of dominant frequency components in the Fourier domain. This is akin to how power spectral density is interpreted in fluid dynamics. Another example is image compression, where natural images can be approximated with only a few wavelet coefficients.</p> <p>Traditional signal processing follows the Nyquist-Shannon sampling theorem, which requires sampling a signal at twice its highest frequency to fully reconstruct it. In contrast, compressed sensing enables undersampling‚Äîcollecting fewer measurements than the Nyquist rate suggests‚Äîwhile still achieving accurate signal reconstruction. This is made possible through the concept of incoherence, where the signal‚Äôs sparsity in one domain (e.g., frequency) is incoherent with the way measurements are taken in another domain (e.g., time). This allows for the recovery of the original signal, even with a reduced number of measurements.</p> <p>Compressed sensing involves two critical steps. First, during data measurement, the signal is sampled indirectly through a set of random or linear measurements, rather than through direct sampling. The second step is reconstruction, where an optimization process is applied to recover the original signal. The most common approach is solving a convex optimization problem, such as L1-norm minimization or basis pursuit, which seeks the sparsest signal that fits the available measurements.</p> <h1 id="mathematics-behind-compressed-sensing">Mathematics Behind Compressed Sensing</h1> <p>Given a signal $x~\epsilon~\mathbb{R^n}$, we can assume that it has a sparse representation (is K-Sparse) in a basis $\Psi~\epsilon~\mathbb{R^{n\times n}}$ such that :</p> \[x = \Psi \alpha\] <p>where ùõº is a K-sparse vector, meaning it contains exactly K non-zero elements.</p> <p>If the signal x is K-sparse in $\Psi$, we can collect a sub-sample of measurements $y~\epsilon~\mathbb{R^m}$, where $m\ll n$, instead of measuring x directly and then compressing it. These measurements are gathered using a sensing matrix $\Phi~\epsilon~\mathbb{R^{m\times n}}$, such that:</p> \[y = \Phi x\] <p>These sub-sampled measurements can be random projections of the original signal x, where the entries of Œ¶ are Gaussian-distributed random variables. Alternatively, individual entries of x, such as single pixels in the case of an image, may be measured directly, where the rows of Œ¶ contain zeros except for a single unit entry per row.</p> <p>The challenge in compressed sensing is recovering x from y, even when ùëö is much smaller than ùëõ. If we know the sparse vector ùõº, we can reconstruct the full signal x using:</p> \[y = \Phi \Psi \alpha\] <p>Since this system is underdetermined (more unknowns than equations), there could be infinitely many solutions for ùõº. The goal is to find the sparsest solution ùõº that satisfies the following optimization problem:</p> <p>$\alpha = \min(\vert\vert\alpha\vert\vert _0)$ such that $y = \Phi \Psi \alpha$</p> <p>Here, ‚à£‚à£Œ±‚à£‚à£0 represents the number of non-zero elements in ùõº. Unfortunately, this is a non-convex optimization problem, which can only be solved by an exhaustive brute-force search. The computational complexity of such a search grows combinatorially with n and K, making it an NP-hard problem. This makes solving even moderately large problems infeasible with current computational power.</p> <p>However, we can relax the problem to a convex optimization by minimizing the L1 norm:</p> <p>$\alpha = \min(\vert\vert\alpha\vert\vert _1)$ such that $y = \Phi \Psi \alpha$</p> <p>L1 norm minimization encourages sparsity in the solution. Under this formulation, the optimization almost always leads to a sparse solution, provided the measurements in Œ¶ are incoherent with respect to the basis Œ®, meaning the two are uncorrelated.</p> <h1 id="compressed-sensing-in-fluid-dynamics">Compressed Sensing In Fluid Dynamics</h1> <p>Compressed sensing has wide-ranging applications. For instance, consider medical imaging. In MRI (magnetic resonance imaging), compressed sensing is used to reduce the time needed to collect data, while still producing high-quality images from fewer measurements. In astronomy, compressed sensing is applied to recover high-resolution images of astronomical objects from limited data. In communications and data storage, it helps to reduce the amount of data required to be transmitted or stored while retaining essential information. And finally in Fluid Dynamics, compressed sensing is used for sparse data reconstruction, sensor placement, and modal decomposition.</p> <p>Lets focus on a few key advantages of Compressed sensing from the description of application above. Compressed sensing firstly allows data collection from fewer measurements, leading to faster and more cost-effective data acquisition. Second, it reduces storage requirements by storing only the most important components. And most importantly, Compressed sensing methods are often robust to noise, allowing accurate recovery even with imperfect measurements. All these advantages are seen in action in Fluid dynamics. It leverages the fact that many fluid dynamics phenomena exhibit sparse representations in certain bases, such as wavelets, Fourier, or proper orthogonal decomposition (POD) modes. Thus, in fluid dynamics, compressed sensing is applied in context of sparse data reconstruction and modal decomposition techniques.</p> <p>Lets look at a few examples in detail :</p> <ol> <li> <strong>Sparse Data Reconstruction</strong> : In experimental fluid dynamics, obtaining high-resolution data can be expensive or difficult (e.g., in particle image velocimetry or pressure measurements). Compressed sensing allows for the reconstruction of flow fields from a limited number of measurements by exploiting sparsity in some transform domain. For instance, fewer sensor points can be used to reconstruct full velocity fields, reducing data collection time and cost. In another example, limited pressure measurements can be reconstructed to obtain full-field pressure data in turbulent flows using compressed sensing techniques.</li> <li> <strong>Modal Decomposition</strong> : Compressed sensing has been used in conjunction with modal decomposition methods like Dynamic Mode Decomposition (DMD) and Proper Orthogonal Decomposition (POD). These methods represent complex flow fields with a few dominant modes, making the data inherently sparse in the modal domain. For example, compressed sensing principles are used with Dynamic Mode Decomposition (DMD) in a variant names Sparsity-Promoting DMD (SPDMD).</li> <li> <strong>Reduced Order Models (ROMs)</strong> : Compressed sensing helps in building efficient ROMs by identifying key modes from sparse or under-sampled data, making the computational cost lower while retaining accuracy.</li> <li> <strong>Flow Reconstruction in Time-Resolved Data</strong> : When dealing with time-resolved fluid dynamics data (e.g., turbulent wake behind a bluff body), the spatial and temporal data can be sparse, and compressed sensing helps recover complete data from few-time snapshots or low-resolution measurements.</li> </ol> <h1 id="compressed-sensing-in-action">Compressed Sensing in Action</h1> <p>Let‚Äôs consider a simple example to demonstrate compressed sensing in action. In this case, we will generate an artificial signal‚Äîthink of it as a sound wave or a sensor signal from PIV measurements‚Äîand attempt to reconstruct the original signal using only about 3% of the data. This example will showcase one-dimensional, temporal compressed sensing.</p> <p>First, let‚Äôs load the necessary modules in a Jupyter notebook:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="n">fluidfoam</span> <span class="k">as</span> <span class="n">fl</span>
<span class="kn">import</span> <span class="n">scipy</span> <span class="k">as</span> <span class="n">sp</span>
<span class="kn">import</span> <span class="n">scipy.optimize</span> <span class="k">as</span> <span class="n">spopt</span>
<span class="kn">import</span> <span class="n">scipy.fftpack</span> <span class="k">as</span> <span class="n">spfft</span>
<span class="kn">import</span> <span class="n">scipy.ndimage</span> <span class="k">as</span> <span class="n">spimg</span>
<span class="kn">import</span> <span class="n">cvxpy</span> <span class="k">as</span> <span class="n">cvx</span>
<span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
<span class="n">plt</span><span class="p">.</span><span class="n">rcParams</span><span class="p">.</span><span class="nf">update</span><span class="p">({</span><span class="sh">'</span><span class="s">font.size</span><span class="sh">'</span> <span class="p">:</span> <span class="mi">14</span><span class="p">,</span> <span class="sh">'</span><span class="s">font.family</span><span class="sh">'</span> <span class="p">:</span> <span class="sh">'</span><span class="s">Times New Roman</span><span class="sh">'</span><span class="p">,</span> <span class="sh">"</span><span class="s">text.usetex</span><span class="sh">"</span><span class="p">:</span> <span class="bp">True</span><span class="p">})</span>

<span class="c1"># Path to save files
</span><span class="n">savePath</span> <span class="o">=</span> <span class="sh">'</span><span class="s">E:/Blog_Posts/OpenFOAM/ROM_Series/Post38/</span><span class="sh">'</span>
</code></pre></div></div> <p>The signal we will consider, taken from the book <a href="http://dmdbook.com/" rel="external nofollow noopener" target="_blank">‚ÄúDynamic Mode Decomposition: Data-Driven Modeling of Complex Systems‚Äù</a> by J. Nathan Kutz and others, is a two-tone signal in time:</p> \[f(t) = sin(73\times 2\pi t) + sin(531\times 2\pi t)\] <p>To accurately resolve the high-frequency component of 531 Hz, the Nyquist sampling theorem dictates that the signal must be sampled at least twice its highest frequency, which would require 1062 samples per second. For simplicity, we‚Äôll oversample by a factor of four, collecting 4096 samples over a one-second interval.</p> <p>Let‚Äôs generate the signal:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">n</span> <span class="o">=</span> <span class="mi">4096</span> <span class="c1"># number of samples
</span><span class="n">p</span> <span class="o">=</span> <span class="mi">128</span> <span class="c1"># number of sub-samples 
</span><span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> 
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">sin</span><span class="p">(</span><span class="mi">73</span> <span class="o">*</span> <span class="mi">2</span><span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="p">.</span><span class="nf">sin</span><span class="p">(</span><span class="mi">531</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>     
<span class="n">yt</span> <span class="o">=</span> <span class="n">spfft</span><span class="p">.</span><span class="nf">dct</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="sh">'</span><span class="s">ortho</span><span class="sh">'</span><span class="p">)</span>
<span class="n">psd</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">abs</span><span class="p">(</span><span class="n">yt</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
<span class="n">frequency</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span>
</code></pre></div></div> <p>Next, we can visualize these signals using standard matplotlib routines. Below, I will display the signal in three forms: the original time-domain signal, a zoomed-in section of the time-domain signal, and the signal in the frequency domain.</p> <figure> <img src="https://goswami-13.github.io/images/Post38/OrigSignal.jpeg" width="80%"> </figure> <figure> <img src="https://goswami-13.github.io/images/Post38/ZoomedSignal.jpeg" width="80%"> </figure> <figure> <img src="https://goswami-13.github.io/images/Post38/FrequencySig.jpeg" width="80%"> </figure> <p>As we can see, the signal exhibits a clear and non-trivial pattern. Additionally, this signal is extremely sparse in the Fourier (frequency) domain, with only two non-zero frequency components‚Äî73 Hz and 531 Hz. Now, let‚Äôs sample approximately 3% of the temporal signal. For simplicity, we will sample at a rate of 128 samples per second, which is 1/8 of the Nyquist rate. This gives us the compressed measurement:</p> \[y = \Psi x = \Phi \Psi x\] <p>where Œ¶ is derived using the inverse discrete cosine transform (iDCT).</p> <p>Let‚Äôs visualize the sampled signal:</p> <figure> <img src="https://goswami-13.github.io/images/Post38/SampledSignal.jpeg" width="80%"> </figure> <figure> <img src="https://goswami-13.github.io/images/Post38/ZoomedSampledSignal.jpeg" width="80%"> </figure> <figure> <img src="https://goswami-13.github.io/images/Post38/SampledOnly.jpeg" width="80%"> </figure> <p>At first glance, this sampled signal might seem like noise. However, the underlying signal‚Äîand its frequency content‚Äîremains unchanged. The challenge now is to extract the two dominant frequencies from this incomplete data and attempt to reconstruct the original signal. This is where compressed sensing comes into play.</p> <p>In this context, compressed sensing works because the signal‚Äôs frequency content is highly sparse. This is where the L1 norm minimization comes in. Out of all possible signals, we aim to find the simplest one that aligns with the known data. Specifically, we want to find a set of frequencies that satisfy two conditions: (a) the reconstructed signal matches the available data as closely as possible, and (b) the L1 norm of the frequencies is minimized. This approach will yield a sparse solution‚Äîexactly what we‚Äôre looking for. In Python, we will use the convex optimization library (<a href="https://www.cvxpy.org/" rel="external nofollow noopener" target="_blank">CVXPY</a>) to minimize the norm and reconstruct the signal.</p> <p>To perform the minimization, we will frame our problem as a linear system of equations, ùê¥ùëã=ùêµ. Our goal is to derive a matrix ùê¥ that, when multiplied with a candidate solution X, yields B, the vector of sampled data. In this case, X exists in the frequency domain, while B is in the temporal domain. The matrix A performs both sampling and transformation from spectral to temporal domains, which is key to compressed sensing.</p> <p>Let‚Äôs assume ùêπ is the target signal and ùúô is the sampling matrix. Then, ùêµ=ùúôùêπ. Next, let ùúì be a matrix that transforms the signal from the frequency domain to the time domain using the inverse discrete cosine transform (iDCT). Given a solution ùëã in the frequency domain, this transformation is performed using ùúìùëã=ùêπ. Putting it all together, we arrive at the linear system ùê¥ùëã=ùêµ, where ùê¥=ùúôùúì. The matrix ùúì is straightforward to construct‚Äîit‚Äôs the iDCT applied to the columns of the identity matrix, and ùúìùëã is equivalent to applying the iDCT to ùëã.</p> <p>Let‚Äôs now perform this minimization:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># iDCT matrix A
</span><span class="n">A</span> <span class="o">=</span> <span class="n">spfft</span><span class="p">.</span><span class="nf">idct</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">identity</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="n">norm</span><span class="o">=</span><span class="sh">'</span><span class="s">ortho</span><span class="sh">'</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">ri</span><span class="p">]</span>

<span class="c1"># L1 minimization
</span><span class="n">vx</span> <span class="o">=</span> <span class="n">cvx</span><span class="p">.</span><span class="nc">Variable</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">objective</span> <span class="o">=</span> <span class="n">cvx</span><span class="p">.</span><span class="nc">Minimize</span><span class="p">(</span><span class="n">cvx</span><span class="p">.</span><span class="nf">norm</span><span class="p">(</span><span class="n">vx</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">constraints</span> <span class="o">=</span> <span class="p">[</span><span class="n">A</span><span class="o">*</span><span class="n">vx</span> <span class="o">==</span> <span class="n">y2</span><span class="p">]</span>
<span class="n">prob</span> <span class="o">=</span> <span class="n">cvx</span><span class="p">.</span><span class="nc">Problem</span><span class="p">(</span><span class="n">objective</span><span class="p">,</span> <span class="n">constraints</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">prob</span><span class="p">.</span><span class="nf">solve</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div> <p>Now that we‚Äôve constructed the A matrix and run the minimization, we can reconstruct the signal by transforming the solution from the frequency domain back to the time domain.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Reconstruct the signal
</span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">(</span><span class="n">vx</span><span class="p">.</span><span class="n">value</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">squeeze</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">sig</span> <span class="o">=</span> <span class="n">spfft</span><span class="p">.</span><span class="nf">idct</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="sh">'</span><span class="s">ortho</span><span class="sh">'</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">PSD</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">abs</span><span class="p">(</span><span class="n">spfft</span><span class="p">.</span><span class="nf">dct</span><span class="p">(</span><span class="n">sig</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="sh">'</span><span class="s">ortho</span><span class="sh">'</span><span class="p">))</span> <span class="o">**</span> <span class="mi">2</span>
<span class="n">Frequency2</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span>
</code></pre></div></div> <p>Now, let‚Äôs visualize the signals again, but this time we‚Äôll compare the reconstructed signal with the original one.</p> <figure> <img src="https://goswami-13.github.io/images/Post38/Comparison_Whole.jpeg" width="80%"> </figure> <figure> <img src="https://goswami-13.github.io/images/Post38/Comparison.jpeg" width="80%"> </figure> <figure> <img src="https://goswami-13.github.io/images/Post38/FrequencyCompare.jpeg" width="80%"> </figure> <p>From the zoomed-in figure and the overall frequency trends, we can see that the reconstruction is quite accurate, especially considering that we used only 3% of the sub-sampled data. However, one noticeable issue is the degradation of the reconstruction quality around t=0 and t=1. This is likely due to the sample interval violating the periodic boundary conditions required by the cosine transform. Without prior knowledge of the signal‚Äôs nature, it‚Äôs difficult to avoid such violations in an arbitrary signal sample.</p> <p>The good news is that we now have clear indications of the true frequencies of the original signal. If needed, we could go back and resample the signal within an interval that satisfies periodic boundary conditions for better accuracy.</p> </d-article> <d-appendix> <d-footnote-list></d-footnote-list> <d-citation-list></d-citation-list> </d-appendix> <d-bibliography src="/al-folio/assets/bibliography/"></d-bibliography> <d-article> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/al-folio/posts/2025/06/blog-post-54/">Tabulating 6-DOF Motion Kinematics in OpenFOAM using Python</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/al-folio/posts/2025/06/blog-post-53/">Setting Up Overset Mesh Cases in OpenFOAM Made Easy</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/al-folio/posts/2025/06/blog-post-52/">An Introduction to Overset Mesh in OpenFOAM</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/al-folio/posts/2025/05/blog-post-51/">Python Tools for Analyzing and Visualizing Mesh Motion Simulations</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/al-folio/posts/2025/03/blog-post-50/">Simulating Pure Pitching and Heaving Motions in OpenFOAM</a> </li> <br> <br> </d-article> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> ¬© Copyright 2025 Shubham Goswami, PhD. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/al-folio/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script src="/al-folio/assets/js/distillpub/overrides.js"></script> <script defer src="https://cdn.jsdelivr.net/npm/mermaid@10.7.0/dist/mermaid.min.js" integrity="sha256-TtLOdUA8mstPoO6sGvHIGx2ceXrrX4KgIItO06XOn8A=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/d3@7.8.5/dist/d3.min.js" integrity="sha256-1rA678n2xEx7x4cTZ5x4wpUCj6kUMZEZ5cxLSVSFWxw=" crossorigin="anonymous"></script> <script defer src="/al-folio/assets/js/mermaid-setup.js?38ca0a0126f7328d2d9a46bad640931f" type="text/javascript"></script> <script src="https://cdn.jsdelivr.net/npm/diff2html@3.4.47/bundles/js/diff2html-ui.min.js" integrity="sha256-eU2TVHX633T1o/bTQp6iIJByYJEtZThhF9bKz/DcbbY=" crossorigin="anonymous"></script> <script defer src="/al-folio/assets/js/diff2html-setup.js?80a6e52ce727518bbd3aed2bb6ba5601" type="text/javascript"></script> <script src="https://cdn.jsdelivr.net/npm/leaflet@1.9.4/dist/leaflet.min.js" integrity="sha256-MgH13bFTTNqsnuEoqNPBLDaqxjGH+lCpqrukmXc8Ppg=" crossorigin="anonymous"></script> <script defer src="/al-folio/assets/js/leaflet-setup.js?b6313931e203b924523e2d8b75fe8874" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js" integrity="sha256-0q+JdOlScWOHcunpUk21uab1jW7C1deBQARHtKMcaB4=" crossorigin="anonymous"></script> <script defer src="/al-folio/assets/js/chartjs-setup.js?183c5859923724fb1cb3c67593848e71" type="text/javascript"></script> <script src="https://cdn.jsdelivr.net/npm/echarts@5.5.0/dist/echarts.min.js" integrity="sha256-QvgynZibb2U53SsVu98NggJXYqwRL7tg3FeyfXvPOUY=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/echarts@5.5.0/theme/dark-fresh-cut.js" integrity="sha256-sm6Ui9w41++ZCWmIWDLC18a6ki72FQpWDiYTDxEPXwU=" crossorigin="anonymous"></script> <script defer src="/al-folio/assets/js/echarts-setup.js?738178999630746a8d0cfc261fc47c2c" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/vega@5.27.0/build/vega.min.js" integrity="sha256-Yot/cfgMMMpFwkp/5azR20Tfkt24PFqQ6IQS+80HIZs=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/vega-lite@5.16.3/build/vega-lite.min.js" integrity="sha256-TvBvIS5jUN4BSy009usRjNzjI1qRrHPYv7xVLJyjUyw=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/vega-embed@6.24.0/build/vega-embed.min.js" integrity="sha256-FPCJ9JYCC9AZSpvC/t/wHBX7ybueZhIqOMjpWqfl3DU=" crossorigin="anonymous"></script> <script defer src="/al-folio/assets/js/vega-setup.js?7c7bee055efe9312afc861b128fe5f36" type="text/javascript"></script> <script defer src="https://tikzjax.com/v1/tikzjax.js" integrity="sha256-+1qyucCXRZJrCg3lm3KxRt/7WXaYhBid4/1XJRHGB1E=" crossorigin="anonymous"></script> <script src="/al-folio/assets/js/typograms.js?062e75bede72543443762dc3fe36c7a5"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/al-folio/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/al-folio/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/al-folio/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/al-folio/assets/js/copy_code.js?c8a01c11a92744d44b093fc3bda915df" type="text/javascript"></script> <script defer src="/al-folio/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/al-folio/assets/js/mathjax-setup.js?a5bb4e6a542c546dd929b24b8b236dfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/al-folio/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/al-folio/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> <script type="module" src="/al-folio/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/al-folio/assets/js/search-setup.js?6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/al-folio/assets/js/search-data.js"></script> <script src="/al-folio/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>