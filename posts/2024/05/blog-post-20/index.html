<!DOCTYPE html> <html> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> From Pixels to Personalities: The Power of Eigenfaces in Facial Recognition using SVD and PCA | Shubham Goswami, PhD </title> <meta name="author" content="Shubham Goswami, PhD"> <meta name="description" content="Personal and professional website of Shubham Goswami, PhD. "> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/assets/img/ICON.png?c7fe2dd74e1dc70566e7483ec7cc293d"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://goswami-13.github.io/posts/2024/05/blog-post-20/"> <script src="/assets/js/theme.js?a81d82887dd692e91686b43de4542f18"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> <link defer rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet@1.9.4/dist/leaflet.min.css" integrity="sha256-q9ba7o845pMPFU+zcAll8rv+gC+fSovKsOoNQ6cynuQ=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.9.0/styles/github.min.css" integrity="sha256-Oppd74ucMR5a5Dq96FxjEzGF7tTw2fZ/6ksAqDCM8GY=" crossorigin="anonymous" media="screen and (prefers-color-scheme: light)"> <link defer rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.9.0/styles/github-dark.min.css" integrity="sha256-nyCNAiECsdDHrr/s2OQsp5l9XeY2ZJ0rMepjCT2AkBk=" crossorigin="anonymous" media="screen and (prefers-color-scheme: dark)"> <link defer rel="stylesheet" href="https://cdn.jsdelivr.net/npm/diff2html@3.4.47/bundles/css/diff2html.min.css" integrity="sha256-IMBK4VNZp0ivwefSn51bswdsrhk0HoMTLc2GqFHFBXg=" crossorigin="anonymous"> <link defer rel="stylesheet" type="text/css" href="https://tikzjax.com/v1/fonts.css"> <script src="/assets/js/distillpub/template.v2.js"></script> <script src="/assets/js/distillpub/transforms.v2.js"></script> <style type="text/css">.fake-img{background:#bbb;border:1px solid rgba(0,0,0,0.1);box-shadow:0 0 4px rgba(0,0,0,0.1);margin-bottom:12px}.fake-img p{font-family:monospace;color:white;text-align:left;margin:12px 0;text-align:center;font-size:16px}</style> </head> <body> <d-front-matter> <script async type="text/json">
      {
            "title": "From Pixels to Personalities: The Power of Eigenfaces in Facial Recognition using SVD and PCA",
            "description": "",
            "published": "May 26, 2024",
            "authors": [
              
            ],
            "katex": {
              "delimiters": [
                {
                  "left": "$",
                  "right": "$",
                  "display": false
                },
                {
                  "left": "$$",
                  "right": "$$",
                  "display": true
                }
              ]
            }
          }
    </script> </d-front-matter> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Shubham</span> Goswami, PhD </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">CV </a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">Guides </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">Publications </a> </li> <li class="nav-item "> <a class="nav-link" href="/teaching/">Teaching </a> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="post distill"> <d-title> <h1>From Pixels to Personalities: The Power of Eigenfaces in Facial Recognition using SVD and PCA</h1> <p></p> </d-title> <d-article> <d-contents> <nav class="l-text figcaption"> <h3>Contents</h3> </nav> </d-contents> <p>Eigenfaces, a classic application of Singular Value Decomposition (SVD) and Principal Component Analysis (PCA), revolutionized facial recognition in the realm of computer vision. By representing faces as linear combinations of ‘eigenfaces,’ these techniques offer a powerful method for facial feature extraction, dimensionality reduction, and pattern recognition. PS, one can appreciate the versatility of SVD and PCA across diverse fields, from facial recognition to fluid dynamics, in extracting valuable insights from complex data and enhancing our understanding of underlying structures and patterns.</p> <figure> <img src="https://goswami-13.github.io/images/Post20/Logo.png" width="80%"> </figure> <p>In the realm of computer vision, the Eigenfaces method stands as a seminal breakthrough, transforming the landscape of facial recognition and pattern analysis. At its core lies a powerful blend of mathematical techniques, specifically Singular Value Decomposition (SVD) and Principal Component Analysis (PCA), which together unravel the complex tapestry of facial images into a concise representation of essential features. One of the pioneering applications of Eigenfaces emerged through the exploration of the <a href="http://cvc.cs.yale.edu/cvc/projects/yalefacesB/yalefacesB.html" rel="external nofollow noopener" target="_blank">Yale Face Database</a>, a treasure trove of facial images capturing variations in lighting, expression, and pose across multiple subjects. By harnessing the computational prowess of SVD and PCA, researchers embarked on a journey to distill the essence of facial characteristics, paving the way for robust identification systems and advancing our understanding of human perception and cognition. In this exploration, we delve into the intricacies of the Eigenfaces problem, tracing its roots in the Yale dataset, and unraveling the transformative impact of SVD and PCA on facial recognition.</p> <p>However, the influence of SVD and PCA extends far beyond the realm of facial recognition, finding intriguing applications in fluid mechanics. In this interdisciplinary journey, these mathematical tools unveil hidden structures within turbulent flows, offering insights into the dynamics of fluid motion. By applying SVD to velocity fields captured through experimental or computational fluid dynamics (CFD) techniques, researchers can identify coherent flow structures, such as vortices and eddies, amidst the seemingly chaotic turbulence. Moreover, PCA aids in the dimensionality reduction of flow data, enabling the extraction of dominant flow features and simplifying the analysis of complex flow phenomena.</p> <p>This convergence of computer vision and fluid mechanics highlights the universality of SVD and PCA as indispensable tools for uncovering patterns and extracting essential information from high-dimensional data. Through the lens of Eigenfaces and fluid dynamics, we embark on a journey that transcends disciplinary boundaries, driven by the common quest to decipher the underlying structures shaping our world.</p> <p>Lets begin!!</p> <h1 id="eigenfaces">EigenFaces</h1> <p>Singular Value Decomposition (SVD) and Principal Component Analysis (PCA) present an array of compelling applications, with one of the most intriguing being the eigenfaces example. In this context, PCA is applied to a vast collection of facial images to discern the most prominent correlations among them, resulting in what are termed as <strong>Eigenfaces</strong>. These Eigenfaces encapsulate the essence of the image dataset through decomposition. This methodology finds its utility in tasks such as facial recognition and classification within the realms of computer vision and artificial intelligence. Essentially, it serves as an unsupervised dimensionality reduction algorithm (PCA), adept at eliminating non-essential features (dimensions).</p> <p>The inception of employing eigenfaces for recognition traces back to the pioneering work of Sirovich and Kirby in 1987, with further refinement by Matthew Turk and Alex Pentland around 1991 in the domain of face classification. However, it’s crucial to recognize that this approach, like any other, harbors its own set of advantages and limitations.</p> <p><strong>Pros:</strong> The algorithm boasts simplicity and efficiency, both in terms of computational time and storage requirements. PCA efficiently reduces the dimensionality of facial images, rendering it a highly practical choice for facial recognition tasks.</p> <p><strong>Cons:</strong> Despite its efficacy, the accuracy of the approach diminishes under varying conditions such as fluctuations in light intensity and changes in head positioning. While techniques like head pose estimation coupled with bounding box reorientation can mitigate the latter issue to an extent, the preprocessing entailed to achieve satisfactory results underscores the necessity for continued innovation in the realm of facial recognition algorithms.</p> <h1 id="dataset">Dataset</h1> <p>In this demonstration, we will leverage the <a href="http://cvc.cs.yale.edu/cvc/projects/yalefacesB/yalefacesB.html" rel="external nofollow noopener" target="_blank">Yale Face Database</a>, a comprehensive repository encompassing 38 individuals portrayed in 9 distinct poses under 64 varied lighting conditions. You can access the dataset here. Additionally, for the mathematical underpinnings and conceptual framework, we draw from the seminal work <a href="https://www.databookuw.com/" rel="external nofollow noopener" target="_blank">“Data Driven Science and Engineering: Machine Learning, Dynamical Systems and Control”</a> authored by Steven L. Brunton and J. Nathan Kutz.</p> <p>To embark on this journey, let’s begin by acquiring the dataset. You can download it from <a href="https://github.com/heliumind/eigenfaces.git" rel="external nofollow noopener" target="_blank">this repository</a>.</p> <p>Furthermore, for a comprehensive understanding of the mathematical methodologies and conceptual paradigms employed, I highly recommend referring to the aforementioned book by Brunton and Kutz.</p> <p>Now, let’s dive into the practical implementation. Fire up your Jupyter notebook and ensure that you have all the necessary modules loaded. Let’s proceed by importing them:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="n">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">from</span> <span class="n">matplotlib</span> <span class="kn">import</span> <span class="n">colors</span>
<span class="kn">import</span> <span class="n">math</span> <span class="k">as</span> <span class="n">mt</span>
<span class="kn">from</span> <span class="n">numpy</span> <span class="kn">import</span> <span class="n">linalg</span> <span class="k">as</span> <span class="n">LA</span>
<span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="n">scipy</span> <span class="k">as</span> <span class="n">sp</span>
<span class="kn">from</span> <span class="n">time</span> <span class="kn">import</span> <span class="n">time</span>
<span class="kn">import</span> <span class="n">os</span>
<span class="kn">import</span> <span class="n">io</span>

<span class="n">plt</span><span class="p">.</span><span class="n">rcParams</span><span class="p">.</span><span class="nf">update</span><span class="p">({</span><span class="sh">'</span><span class="s">font.size</span><span class="sh">'</span> <span class="p">:</span> <span class="mi">22</span><span class="p">,</span> <span class="sh">'</span><span class="s">font.family</span><span class="sh">'</span> <span class="p">:</span> <span class="sh">'</span><span class="s">Times New Roman</span><span class="sh">'</span><span class="p">,</span> <span class="sh">"</span><span class="s">text.usetex</span><span class="sh">"</span><span class="p">:</span> <span class="bp">True</span><span class="p">})</span>
</code></pre></div></div> <p>Following the previous steps, ensure you’ve downloaded the <code class="language-plaintext highlighter-rouge">allFaces.mat</code> data file from the provided link and placed it within your working directory. Now, within your Jupyter notebook, let’s proceed to load up the data:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mat_contents</span> <span class="o">=</span> <span class="n">sp</span><span class="p">.</span><span class="n">io</span><span class="p">.</span><span class="nf">loadmat</span><span class="p">(</span><span class="sh">'</span><span class="s">allFaces.mat</span><span class="sh">'</span><span class="p">)</span>
<span class="n">faces</span> <span class="o">=</span> <span class="n">mat_contents</span><span class="p">[</span><span class="sh">'</span><span class="s">faces</span><span class="sh">'</span><span class="p">]</span>
<span class="n">m</span> <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="n">mat_contents</span><span class="p">[</span><span class="sh">'</span><span class="s">m</span><span class="sh">'</span><span class="p">])</span>
<span class="n">n</span> <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="n">mat_contents</span><span class="p">[</span><span class="sh">'</span><span class="s">n</span><span class="sh">'</span><span class="p">])</span>
<span class="n">nfaces</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">ndarray</span><span class="p">.</span><span class="nf">flatten</span><span class="p">(</span><span class="n">mat_contents</span><span class="p">[</span><span class="sh">'</span><span class="s">nfaces</span><span class="sh">'</span><span class="p">])</span>

<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">((</span><span class="n">faces</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],))</span> <span class="c1"># Creating labels
</span><span class="n">j</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">classes</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="nf">range</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">nfaces</span><span class="p">)))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">nfaces</span><span class="p">:</span>
  <span class="n">y</span><span class="p">[</span><span class="n">j</span><span class="p">:</span><span class="n">j</span><span class="o">+</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">classes</span><span class="p">.</span><span class="nf">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
  <span class="n">j</span> <span class="o">=</span> <span class="n">j</span> <span class="o">+</span> <span class="n">i</span>

<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Total dataset size:</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">n_samples: </span><span class="si">{</span><span class="n">faces</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">n_features: </span><span class="si">{</span><span class="n">m</span><span class="o">*</span><span class="n">n</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">n_classes: </span><span class="si">{</span><span class="nf">len</span><span class="p">(</span><span class="n">nfaces</span><span class="p">)</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
</code></pre></div></div> <p>Output:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Total</span> <span class="n">dataset</span> <span class="n">size</span><span class="p">:</span>
<span class="n">n_samples</span><span class="p">:</span> <span class="mi">2410</span>
<span class="n">n_features</span><span class="p">:</span> <span class="mi">32256</span>
<span class="n">n_classes</span><span class="p">:</span> <span class="mi">38</span>
</code></pre></div></div> <p>Here, we are considering 38 individual faces (n_classes), each image with 192 x 168 pixels. Each of the facial features in our library are reshaped into a large column array with 192 x 168 = 32256 elements (n_features). Lets visualize an array of images consisting each person from this dataset:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">allPersons</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">((</span><span class="n">n</span><span class="o">*</span><span class="mi">6</span><span class="p">,</span><span class="n">m</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span>
<span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>

<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">6</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">6</span><span class="p">):</span>
        <span class="n">allPersons</span><span class="p">[</span><span class="n">j</span><span class="o">*</span><span class="n">n</span> <span class="p">:</span> <span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="o">*</span><span class="n">m</span> <span class="p">:</span> <span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">m</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">reshape</span><span class="p">(</span><span class="n">faces</span><span class="p">[:,</span><span class="n">np</span><span class="p">.</span><span class="nf">sum</span><span class="p">(</span><span class="n">nfaces</span><span class="p">[:</span><span class="n">count</span><span class="p">])],(</span><span class="n">m</span><span class="p">,</span><span class="n">n</span><span class="p">)).</span><span class="n">T</span>
        <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
        
<span class="n">img</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">imshow</span><span class="p">(</span><span class="n">allPersons</span><span class="p">)</span>
<span class="n">img</span><span class="p">.</span><span class="nf">set_cmap</span><span class="p">(</span><span class="sh">'</span><span class="s">gray</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">axis</span><span class="p">(</span><span class="sh">'</span><span class="s">off</span><span class="sh">'</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</code></pre></div></div> <figure> <img src="https://goswami-13.github.io/images/Post20/AllPeople.jpeg" width="80%"> </figure> <p>One can also visualize all the poses and lighting conditions by,</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Person</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1"># Change the person number here, range(len(nfaces))
</span>
<span class="n">subset</span> <span class="o">=</span> <span class="n">faces</span><span class="p">[:,</span><span class="nf">sum</span><span class="p">(</span><span class="n">nfaces</span><span class="p">[:</span><span class="n">Person</span><span class="p">])</span> <span class="p">:</span> <span class="nf">sum</span><span class="p">(</span><span class="n">nfaces</span><span class="p">[:(</span><span class="n">Person</span><span class="o">+</span><span class="mi">1</span><span class="p">)])]</span>
<span class="n">allFaces</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">((</span><span class="n">n</span><span class="o">*</span><span class="mi">8</span><span class="p">,</span><span class="n">m</span><span class="o">*</span><span class="mi">8</span><span class="p">))</span>
    
<span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
    
<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">count</span> <span class="o">&lt;</span> <span class="n">nfaces</span><span class="p">[</span><span class="n">Person</span><span class="p">]:</span>
            <span class="n">allFaces</span><span class="p">[</span><span class="n">j</span><span class="o">*</span><span class="n">n</span><span class="p">:(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">n</span><span class="p">,</span><span class="n">k</span><span class="o">*</span><span class="n">m</span><span class="p">:(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">m</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">reshape</span><span class="p">(</span><span class="n">subset</span><span class="p">[:,</span><span class="n">count</span><span class="p">],(</span><span class="n">m</span><span class="p">,</span><span class="n">n</span><span class="p">)).</span><span class="n">T</span>
            <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
                
<span class="n">img</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">imshow</span><span class="p">(</span><span class="n">allFaces</span><span class="p">)</span>
<span class="n">img</span><span class="p">.</span><span class="nf">set_cmap</span><span class="p">(</span><span class="sh">'</span><span class="s">gray</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">axis</span><span class="p">(</span><span class="sh">'</span><span class="s">off</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</code></pre></div></div> <figure> <img src="https://goswami-13.github.io/images/Post20/Features.jpeg" width="80%"> </figure> <h1 id="training">Training</h1> <p>Let’s outline our strategy for leveraging this dataset. Our approach entails utilizing the initial 36 facial images as our training dataset, employing a machine learning algorithm grounded in PCA/SVD principles. Given the total of 38 faces, we reserve the remaining 2 images for validation purposes. Subsequently, we aim to employ this algorithm as a potent tool for both facial recognition and reconstruction tasks, evaluating its efficacy using the reserved test data.</p> <p>Our journey commences with the acquisition of the first 36 faces from the dataset, followed by the computation of the average facial representation:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># We use the first 36 people for training data
</span><span class="n">trainingFaces</span> <span class="o">=</span> <span class="n">faces</span><span class="p">[:,:</span><span class="n">np</span><span class="p">.</span><span class="nf">sum</span><span class="p">(</span><span class="n">nfaces</span><span class="p">[:</span><span class="mi">36</span><span class="p">])]</span>
<span class="n">avgFace</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">mean</span><span class="p">(</span><span class="n">trainingFaces</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># size n*m by 1
</span></code></pre></div></div> <p>Following the data selection and average face computation, the next step involves visualizing both the training faces and the computed average face:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">img</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">imshow</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">reshape</span><span class="p">(</span><span class="n">avgFace</span><span class="p">,(</span><span class="n">m</span><span class="p">,</span><span class="n">n</span><span class="p">)).</span><span class="n">T</span><span class="p">)</span>
<span class="n">img</span><span class="p">.</span><span class="nf">set_cmap</span><span class="p">(</span><span class="sh">'</span><span class="s">gray</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">axis</span><span class="p">(</span><span class="sh">'</span><span class="s">off</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>

<span class="n">Person</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1"># Change the person number here, range(len(nfaces))
</span>
<span class="n">img</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">imshow</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">reshape</span><span class="p">(</span><span class="n">trainingFaces</span><span class="p">[:,</span><span class="n">np</span><span class="p">.</span><span class="nf">sum</span><span class="p">(</span><span class="n">nfaces</span><span class="p">[:</span><span class="n">Person</span><span class="p">])],(</span><span class="n">m</span><span class="p">,</span><span class="n">n</span><span class="p">)).</span><span class="n">T</span><span class="p">)</span>
<span class="n">img</span><span class="p">.</span><span class="nf">set_cmap</span><span class="p">(</span><span class="sh">'</span><span class="s">gray</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">axis</span><span class="p">(</span><span class="sh">'</span><span class="s">off</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</code></pre></div></div> <p><img src="https://goswami-13.github.io/images/Post20/AverageFace.jpeg" width="50%"><img src="https://goswami-13.github.io/images/Post20/Face1.jpeg" width="50%"></p> <p>To elucidate the process of assembling the training and average face arrays, let’s visualize the steps undertaken. Initially, we collate all 36 faces from our training dataset into an array termed <code class="language-plaintext highlighter-rouge">trainingFaces</code>. Subsequently, we compute the average of this array to derive the <code class="language-plaintext highlighter-rouge">aveFace</code> array, encapsulating the collective facial features represented within the training dataset. This visualization offers a clear depiction of the sequence of operations involved in constructing these essential arrays.</p> <figure> <img src="https://goswami-13.github.io/images/Post20/AMatrix.png" width="100%"> </figure> <p>Then simply subtract the average face from the training faces:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">X</span> <span class="o">=</span> <span class="n">trainingFaces</span> <span class="o">-</span> <span class="n">np</span><span class="p">.</span><span class="nf">tile</span><span class="p">(</span><span class="n">avgFace</span><span class="p">,(</span><span class="n">trainingFaces</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="mi">1</span><span class="p">)).</span><span class="n">T</span>
</code></pre></div></div> <p>Visualize the mean-subtracted faces:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Person</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1"># Change the person number here, range(len(nfaces))
</span>
<span class="n">img</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">imshow</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">reshape</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="n">np</span><span class="p">.</span><span class="nf">sum</span><span class="p">(</span><span class="n">nfaces</span><span class="p">[:</span><span class="n">Person</span><span class="p">])],(</span><span class="n">m</span><span class="p">,</span><span class="n">n</span><span class="p">)).</span><span class="n">T</span><span class="p">)</span>
<span class="n">img</span><span class="p">.</span><span class="nf">set_cmap</span><span class="p">(</span><span class="sh">'</span><span class="s">gray</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">axis</span><span class="p">(</span><span class="sh">'</span><span class="s">off</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</code></pre></div></div> <p>Again, our methodology involves subtracting the mean from the training dataset, thereby generating a new matrix termed X, which encompasses the mean-subtracted data. This crucial step facilitates the extraction of essential features while standardizing the dataset for subsequent analysis.</p> <figure> <img src="https://goswami-13.github.io/images/Post20/XMatrix.PNG" width="100%"> </figure> <p>Following the mean subtraction process, our next stride involves computing the Singular Value Decomposition (SVD) of the mean-subtracted faces matrix, effectively culminating in Principal Component Analysis (PCA). This pivotal transformation yields eigenvectors encapsulating the principal components of the dataset, which, when reshaped back to the original 192x168 image grid, manifest as the fundamental components known as <em>eigenfaces</em>. This pivotal procedure enables the extraction and representation of significant facial features, laying the groundwork for subsequent facial recognition and reconstruction endeavors.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Compute eigenfaces on mean-subtracted training data
</span><span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Computing eigenfaces / Performing SVD on face library</span><span class="sh">"</span><span class="p">)</span>
<span class="n">t0</span> <span class="o">=</span> <span class="nf">time</span><span class="p">()</span>
<span class="n">U</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">VT</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linalg</span><span class="p">.</span><span class="nf">svd</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">full_matrices</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">done in </span><span class="si">{</span><span class="nf">time</span><span class="p">()</span><span class="o">-</span><span class="n">t0</span><span class="si">:</span><span class="mf">0.3</span><span class="n">f</span><span class="si">}</span><span class="s">s</span><span class="sh">"</span><span class="p">)</span>
</code></pre></div></div> <p>To verify the variability inherent within our dataset subsequent to computing the Singular Value Decomposition (SVD), we’ll plot the eigenvalues alongside their cumulative sum, offering insights into the distribution and cumulative contribution of each eigenvalue:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="sh">'</span><span class="s">o</span><span class="sh">'</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="sh">''</span><span class="p">,</span> <span class="n">markerfacecolor</span> <span class="o">=</span> <span class="sh">'</span><span class="s">none</span><span class="sh">'</span><span class="p">,</span> <span class="n">markeredgecolor</span><span class="o">=</span><span class="sh">'</span><span class="s">k</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="sh">'</span><span class="s">$r$</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">set_ylabel</span><span class="p">(</span><span class="sh">'</span><span class="s">Singular Values,</span><span class="sh">'</span> <span class="o">+</span> <span class="sa">r</span><span class="sh">'</span><span class="s">$\sigma_n$</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="n">xaxis</span><span class="p">.</span><span class="nf">set_tick_params</span><span class="p">(</span><span class="n">direction</span><span class="o">=</span><span class="sh">'</span><span class="s">in</span><span class="sh">'</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="sh">'</span><span class="s">both</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="n">yaxis</span><span class="p">.</span><span class="nf">set_tick_params</span><span class="p">(</span><span class="n">direction</span><span class="o">=</span><span class="sh">'</span><span class="s">in</span><span class="sh">'</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="sh">'</span><span class="s">both</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="n">xaxis</span><span class="p">.</span><span class="nf">set_ticks_position</span><span class="p">(</span><span class="sh">'</span><span class="s">both</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="n">yaxis</span><span class="p">.</span><span class="nf">set_ticks_position</span><span class="p">(</span><span class="sh">'</span><span class="s">both</span><span class="sh">'</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">cumsum</span><span class="p">(</span><span class="n">S</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="p">.</span><span class="nf">sum</span><span class="p">(</span><span class="n">S</span><span class="p">),</span> <span class="n">marker</span> <span class="o">=</span> <span class="sh">'</span><span class="s">o</span><span class="sh">'</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="sh">''</span><span class="p">,</span> <span class="n">markerfacecolor</span> <span class="o">=</span> <span class="sh">'</span><span class="s">none</span><span class="sh">'</span><span class="p">,</span> <span class="n">markeredgecolor</span><span class="o">=</span><span class="sh">'</span><span class="s">k</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="sh">'</span><span class="s">$r$</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="sh">'</span><span class="s">$\sum\sigma_n$</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="n">xaxis</span><span class="p">.</span><span class="nf">set_tick_params</span><span class="p">(</span><span class="n">direction</span><span class="o">=</span><span class="sh">'</span><span class="s">in</span><span class="sh">'</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="sh">'</span><span class="s">both</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="n">yaxis</span><span class="p">.</span><span class="nf">set_tick_params</span><span class="p">(</span><span class="n">direction</span><span class="o">=</span><span class="sh">'</span><span class="s">in</span><span class="sh">'</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="sh">'</span><span class="s">both</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="n">xaxis</span><span class="p">.</span><span class="nf">set_ticks_position</span><span class="p">(</span><span class="sh">'</span><span class="s">both</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="n">yaxis</span><span class="p">.</span><span class="nf">set_ticks_position</span><span class="p">(</span><span class="sh">'</span><span class="s">both</span><span class="sh">'</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">tight_layout</span><span class="p">()</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</code></pre></div></div> <figure> <img src="https://goswami-13.github.io/images/Post20/SVD_Stuff.jpeg" width="100%"> </figure> <p>To ascertain the variance score, we can compute it using the cumulative sum of eigenvalues obtained from the Singular Value Decomposition (SVD). This score encapsulates the proportion of variance retained by each principal component. Here’s how you can calculate it:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">n_components</span> <span class="o">=</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">350</span><span class="p">,</span> <span class="mi">400</span><span class="p">,</span> <span class="mi">450</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">550</span><span class="p">,</span> <span class="mi">600</span><span class="p">,</span> <span class="mi">650</span><span class="p">,</span> <span class="mi">700</span><span class="p">,</span> <span class="mi">750</span><span class="p">,</span> <span class="mi">800</span><span class="p">,</span> <span class="mi">850</span><span class="p">,</span> <span class="mi">900</span><span class="p">,</span> <span class="mi">950</span><span class="p">,</span> <span class="mi">1000</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">n_components</span><span class="p">:</span>
    <span class="n">var</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">sum</span><span class="p">(</span><span class="n">S</span><span class="p">[:</span><span class="n">i</span><span class="p">])</span><span class="o">/</span><span class="n">np</span><span class="p">.</span><span class="nf">sum</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Amount of variance captured by first </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s"> eigenfaces: </span><span class="si">{</span><span class="n">var</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="p">.</span><span class="mi">1</span><span class="n">f</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
</code></pre></div></div> <p>Output:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Amount</span> <span class="n">of</span> <span class="n">variance</span> <span class="n">captured</span> <span class="n">by</span> <span class="n">first</span> <span class="mi">100</span> <span class="n">eigenfaces</span><span class="p">:</span> <span class="mf">48.2</span>
<span class="n">Amount</span> <span class="n">of</span> <span class="n">variance</span> <span class="n">captured</span> <span class="n">by</span> <span class="n">first</span> <span class="mi">150</span> <span class="n">eigenfaces</span><span class="p">:</span> <span class="mf">55.1</span>
<span class="n">Amount</span> <span class="n">of</span> <span class="n">variance</span> <span class="n">captured</span> <span class="n">by</span> <span class="n">first</span> <span class="mi">200</span> <span class="n">eigenfaces</span><span class="p">:</span> <span class="mf">60.1</span>
<span class="n">Amount</span> <span class="n">of</span> <span class="n">variance</span> <span class="n">captured</span> <span class="n">by</span> <span class="n">first</span> <span class="mi">250</span> <span class="n">eigenfaces</span><span class="p">:</span> <span class="mf">64.0</span>
<span class="n">Amount</span> <span class="n">of</span> <span class="n">variance</span> <span class="n">captured</span> <span class="n">by</span> <span class="n">first</span> <span class="mi">300</span> <span class="n">eigenfaces</span><span class="p">:</span> <span class="mf">67.2</span>
<span class="n">Amount</span> <span class="n">of</span> <span class="n">variance</span> <span class="n">captured</span> <span class="n">by</span> <span class="n">first</span> <span class="mi">350</span> <span class="n">eigenfaces</span><span class="p">:</span> <span class="mf">69.9</span>
<span class="n">Amount</span> <span class="n">of</span> <span class="n">variance</span> <span class="n">captured</span> <span class="n">by</span> <span class="n">first</span> <span class="mi">400</span> <span class="n">eigenfaces</span><span class="p">:</span> <span class="mf">72.2</span>
<span class="n">Amount</span> <span class="n">of</span> <span class="n">variance</span> <span class="n">captured</span> <span class="n">by</span> <span class="n">first</span> <span class="mi">450</span> <span class="n">eigenfaces</span><span class="p">:</span> <span class="mf">74.3</span>
<span class="n">Amount</span> <span class="n">of</span> <span class="n">variance</span> <span class="n">captured</span> <span class="n">by</span> <span class="n">first</span> <span class="mi">500</span> <span class="n">eigenfaces</span><span class="p">:</span> <span class="mf">76.1</span>
<span class="n">Amount</span> <span class="n">of</span> <span class="n">variance</span> <span class="n">captured</span> <span class="n">by</span> <span class="n">first</span> <span class="mi">550</span> <span class="n">eigenfaces</span><span class="p">:</span> <span class="mf">77.8</span>
<span class="n">Amount</span> <span class="n">of</span> <span class="n">variance</span> <span class="n">captured</span> <span class="n">by</span> <span class="n">first</span> <span class="mi">600</span> <span class="n">eigenfaces</span><span class="p">:</span> <span class="mf">79.3</span>
<span class="n">Amount</span> <span class="n">of</span> <span class="n">variance</span> <span class="n">captured</span> <span class="n">by</span> <span class="n">first</span> <span class="mi">650</span> <span class="n">eigenfaces</span><span class="p">:</span> <span class="mf">80.7</span>
<span class="n">Amount</span> <span class="n">of</span> <span class="n">variance</span> <span class="n">captured</span> <span class="n">by</span> <span class="n">first</span> <span class="mi">700</span> <span class="n">eigenfaces</span><span class="p">:</span> <span class="mf">82.0</span>
<span class="n">Amount</span> <span class="n">of</span> <span class="n">variance</span> <span class="n">captured</span> <span class="n">by</span> <span class="n">first</span> <span class="mi">750</span> <span class="n">eigenfaces</span><span class="p">:</span> <span class="mf">83.2</span>
<span class="n">Amount</span> <span class="n">of</span> <span class="n">variance</span> <span class="n">captured</span> <span class="n">by</span> <span class="n">first</span> <span class="mi">800</span> <span class="n">eigenfaces</span><span class="p">:</span> <span class="mf">84.3</span>
<span class="n">Amount</span> <span class="n">of</span> <span class="n">variance</span> <span class="n">captured</span> <span class="n">by</span> <span class="n">first</span> <span class="mi">850</span> <span class="n">eigenfaces</span><span class="p">:</span> <span class="mf">85.3</span>
<span class="n">Amount</span> <span class="n">of</span> <span class="n">variance</span> <span class="n">captured</span> <span class="n">by</span> <span class="n">first</span> <span class="mi">900</span> <span class="n">eigenfaces</span><span class="p">:</span> <span class="mf">86.3</span>
<span class="n">Amount</span> <span class="n">of</span> <span class="n">variance</span> <span class="n">captured</span> <span class="n">by</span> <span class="n">first</span> <span class="mi">950</span> <span class="n">eigenfaces</span><span class="p">:</span> <span class="mf">87.2</span>
<span class="n">Amount</span> <span class="n">of</span> <span class="n">variance</span> <span class="n">captured</span> <span class="n">by</span> <span class="n">first</span> <span class="mi">1000</span> <span class="n">eigenfaces</span><span class="p">:</span> <span class="mf">88.1</span>
</code></pre></div></div> <p>The variance score plays a pivotal role in guiding the selection of principal components for the facial recognition algorithm. The insights gleaned from these results indicate that a substantial proportion of variance is effectively captured by the initial principal components derived from this dataset. This observation underscores the presence of a pronounced correlation among the distinctive facial features, implying an overlap in the facial characteristics among the 36 individuals represented in our training dataset.</p> <p>Armed with this understanding, we can confidently proceed with testing our trained model on the two faces reserved for validation, leveraging the insights garnered from the PCA analysis to inform our subsequent facial recognition endeavors. This strategic approach ensures the efficacy and generalizability of our model across diverse facial representations.</p> <h1 id="testing-the-algorithm">Testing the Algorithm</h1> <p>To evaluate the performance of our facial recognition algorithm, let’s endeavor to approximate one of the test images. We reserved two images at the outset (Person 37 and 38), with Person 37 designated for this evaluation. We will assess how effectively a rank-r Singular Value Decomposition (SVD) basis can approximate this test image. Leveraging the left-singular matrix 𝑈 obtained from the previous SVD, and denoting the test image as 𝑥_test, we can employ the following projection:</p> \[\tilde{x}_{test} = \tilde{U}\tilde{U} x_{test}\] <p>This projection enables us to approximate the test image 𝑥_test using a rank-r SVD basis, thereby facilitating the evaluation of our facial recognition algorithm’s performance.</p> <p>To approximate the eigenface using multiple ranks:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">testFace</span> <span class="o">=</span> <span class="n">faces</span><span class="p">[:,</span><span class="n">np</span><span class="p">.</span><span class="nf">sum</span><span class="p">(</span><span class="n">nfaces</span><span class="p">[:</span><span class="mi">37</span><span class="p">])]</span> <span class="c1"># First face of person 37
</span>
<span class="n">testFaceMS</span> <span class="o">=</span> <span class="n">testFace</span> <span class="o">-</span> <span class="n">avgFace</span>
<span class="n">r_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">400</span><span class="p">,</span> <span class="mi">800</span><span class="p">,</span> <span class="mi">1600</span><span class="p">]</span>
<span class="n">width</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">height</span> <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">ceil</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">r_list</span><span class="p">)</span><span class="o">/</span><span class="n">width</span><span class="p">))</span>
<span class="n">fig4</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig4</span><span class="p">.</span><span class="nf">add_subplot</span><span class="p">(</span><span class="n">height</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">img</span> <span class="o">=</span> <span class="n">ax</span><span class="p">.</span><span class="nf">imshow</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">reshape</span><span class="p">(</span><span class="n">testFace</span><span class="p">,(</span><span class="n">m</span><span class="p">,</span><span class="n">n</span><span class="p">)).</span><span class="n">T</span><span class="p">)</span>
<span class="n">img</span><span class="p">.</span><span class="nf">set_cmap</span><span class="p">(</span><span class="sh">'</span><span class="s">gray</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">set_title</span><span class="p">(</span><span class="sh">'</span><span class="s">Original Image</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">axis</span><span class="p">(</span><span class="sh">'</span><span class="s">off</span><span class="sh">'</span><span class="p">)</span>

<span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">r_list</span><span class="p">:</span>
    <span class="n">reconFace</span> <span class="o">=</span> <span class="n">avgFace</span> <span class="o">+</span> <span class="n">U</span><span class="p">[:,:</span><span class="n">r</span><span class="p">]</span> <span class="o">@</span> <span class="p">(</span><span class="n">U</span><span class="p">[:,:</span><span class="n">r</span><span class="p">].</span><span class="n">T</span> <span class="o">@</span> <span class="n">testFaceMS</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig4</span><span class="p">.</span><span class="nf">add_subplot</span><span class="p">(</span><span class="n">height</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">r_list</span><span class="p">.</span><span class="nf">index</span><span class="p">(</span><span class="n">r</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">img</span> <span class="o">=</span> <span class="n">ax</span><span class="p">.</span><span class="nf">imshow</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">reshape</span><span class="p">(</span><span class="n">reconFace</span><span class="p">,(</span><span class="n">m</span><span class="p">,</span><span class="n">n</span><span class="p">)).</span><span class="n">T</span><span class="p">)</span>
    <span class="n">img</span><span class="p">.</span><span class="nf">set_cmap</span><span class="p">(</span><span class="sh">'</span><span class="s">gray</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">.</span><span class="nf">set_title</span><span class="p">(</span><span class="sh">'</span><span class="s">r = </span><span class="sh">'</span> <span class="o">+</span> <span class="nf">str</span><span class="p">(</span><span class="n">r</span><span class="p">))</span>
    <span class="n">plt</span><span class="p">.</span><span class="nf">axis</span><span class="p">(</span><span class="sh">'</span><span class="s">off</span><span class="sh">'</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</code></pre></div></div> <figure> <img src="https://goswami-13.github.io/images/Post20/TestFace1.jpeg" width="100%"> </figure> <p>The approximation results indicate suboptimal performance for 𝑟 ≤ 200, suggesting insufficient representation of the test image. However, as the rank-𝑟 surpasses 400, the approximation gradually converges, effectively capturing the essence of the test image. Referring back to the variability score derived earlier, it’s evident that at 𝑟&gt;400, the approximation achieves a representation accuracy exceeding 72%.</p> <p>This implies that with a rank 400 SVD, our facial recognition algorithm can reconstruct the test image with an accuracy exceeding 72%. Considering the complexity of facial features and the inherent variability across individuals, achieving such a level of accuracy underscores the effectiveness of our algorithm. It’s indeed a commendable outcome, signaling promising prospects for practical deployment and real-world applications.</p> <p>Testing our algorithm with a distinct face outside the realms of both the test and training datasets offers a compelling validation of its robustness and generalizability. For this evaluation, I’ve selected an image of Dr. Richard Feynman (needs no introduction!!).</p> <figure> <img src="https://goswami-13.github.io/images/Post20/Richard_Feynman.png" width="10%"> </figure> <p>By subjecting Dr. Feynman’s image to our facial recognition algorithm, we can assess its ability to accurately reconstruct and identify a facial representation that deviates significantly from the dataset. This test not only validates the algorithm’s performance in handling novel inputs but also highlights its potential utility in real-world scenarios characterized by diverse facial representations.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">### Loading the image
</span><span class="n">mat</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">imread</span><span class="p">(</span><span class="sh">'</span><span class="s">Richard_Feynman.png</span><span class="sh">'</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">mat</span><span class="p">.</span><span class="n">T</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">subplots</span><span class="p">()</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">ax</span><span class="p">.</span><span class="nf">imshow</span><span class="p">(</span><span class="n">mat</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="sh">'</span><span class="s">gray</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>

<span class="c1">### Facial reconstruction algorithm
</span>
<span class="n">testFace</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">reshape</span><span class="p">(</span><span class="n">mat</span><span class="p">.</span><span class="n">T</span><span class="p">,</span> <span class="p">(</span><span class="n">m</span><span class="o">*</span><span class="n">n</span><span class="p">))</span> <span class="c1"># New Face
</span>
<span class="n">testFaceMS</span> <span class="o">=</span> <span class="n">testFace</span> <span class="o">-</span> <span class="n">avgFace</span>
<span class="n">r_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">200</span><span class="p">,</span> <span class="mi">400</span><span class="p">,</span> <span class="mi">800</span><span class="p">,</span> <span class="mi">1600</span><span class="p">,</span> <span class="mi">2000</span><span class="p">,</span> <span class="mi">2200</span><span class="p">,</span> <span class="mi">2500</span><span class="p">]</span>
<span class="n">width</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">height</span> <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">ceil</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">r_list</span><span class="p">)</span><span class="o">/</span><span class="n">width</span><span class="p">))</span>
<span class="n">fig4</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig4</span><span class="p">.</span><span class="nf">add_subplot</span><span class="p">(</span><span class="n">height</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">img</span> <span class="o">=</span> <span class="n">ax</span><span class="p">.</span><span class="nf">imshow</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">reshape</span><span class="p">(</span><span class="n">testFace</span><span class="p">,(</span><span class="n">m</span><span class="p">,</span><span class="n">n</span><span class="p">)).</span><span class="n">T</span><span class="p">)</span>
<span class="n">img</span><span class="p">.</span><span class="nf">set_cmap</span><span class="p">(</span><span class="sh">'</span><span class="s">gray</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">set_title</span><span class="p">(</span><span class="sh">'</span><span class="s">Original Image</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">axis</span><span class="p">(</span><span class="sh">'</span><span class="s">off</span><span class="sh">'</span><span class="p">)</span>

<span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">r_list</span><span class="p">:</span>
    <span class="n">reconFace</span> <span class="o">=</span> <span class="n">avgFace</span> <span class="o">+</span> <span class="n">U</span><span class="p">[:,:</span><span class="n">r</span><span class="p">]</span> <span class="o">@</span> <span class="p">(</span><span class="n">U</span><span class="p">[:,:</span><span class="n">r</span><span class="p">].</span><span class="n">T</span> <span class="o">@</span> <span class="n">testFaceMS</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig4</span><span class="p">.</span><span class="nf">add_subplot</span><span class="p">(</span><span class="n">height</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">r_list</span><span class="p">.</span><span class="nf">index</span><span class="p">(</span><span class="n">r</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">img</span> <span class="o">=</span> <span class="n">ax</span><span class="p">.</span><span class="nf">imshow</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">reshape</span><span class="p">(</span><span class="n">reconFace</span><span class="p">,(</span><span class="n">m</span><span class="p">,</span><span class="n">n</span><span class="p">)).</span><span class="n">T</span><span class="p">)</span>
    <span class="n">img</span><span class="p">.</span><span class="nf">set_cmap</span><span class="p">(</span><span class="sh">'</span><span class="s">gray</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">.</span><span class="nf">set_title</span><span class="p">(</span><span class="sh">'</span><span class="s">r = </span><span class="sh">'</span> <span class="o">+</span> <span class="nf">str</span><span class="p">(</span><span class="n">r</span><span class="p">))</span>
    <span class="n">plt</span><span class="p">.</span><span class="nf">axis</span><span class="p">(</span><span class="sh">'</span><span class="s">off</span><span class="sh">'</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</code></pre></div></div> <figure> <img src="https://goswami-13.github.io/images/Post20/FeynmanFace.jpeg" width="100%"> </figure> <p>Indeed, the eigenfaces space possesses a remarkable capability to approximate images, even those of individuals not included in the training dataset, such as Dr. Feynman. This phenomenon is attributable to the expansive nature of the eigenfaces space, which spans a substantial subspace within the 32256-dimensional image (192 x 168) space. The eigenfaces collectively encapsulate broad, smooth, and non-localized spatial features intrinsic to facial structures, including cheeks, forehead, mouths, and other facial attributes. Consequently, even in the absence of specific training data for Dr. Feynman, the algorithm leverages these foundational facial components to effectively reconstruct and approximate his image. This underscores the versatility and adaptability of the eigenfaces approach, rendering it a potent tool for facial recognition and reconstruction tasks across diverse datasets and individuals.</p> <p>PCA’s efficacy in discerning discriminant features crucial for facial recognition is noteworthy. Up to this juncture, our analysis has predominantly focused on a single pose and optimal lighting conditions within the training dataset. However, it’s imperative to extend our investigation to encompass the broader spectrum of variations, including different poses and lighting conditions. By harnessing PCA, we can effectively classify these diverse features, commencing with an exploration of the lighting conditions. Utilizing the eigenfaces as a coordinate system, we delineate an eigenface space, wherein each eigenface serves as a basis vector. This enables the projection of an image 𝑥 into the first 𝑟 PCA modes, yielding a set of coordinates within this space:</p> \[\tilde{x} = \tilde{U}^* x\] <p>The resulting eigenface space encapsulates a rich array of features. Certain principal components capture ubiquitous facial attributes shared across individuals, while others discern unique characteristics distinguishing one individual from another. Furthermore, additional principal components adeptly capture the nuances of lighting effects, thereby enhancing the algorithm’s capacity to discriminate between facial representations under varied lighting conditions. In essence, PCA empowers us to extract and leverage discriminant features essential for effective facial recognition, even amidst the complexities introduced by diverse poses and lighting conditions.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">P1num</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1"># Person number 2
</span><span class="n">P2num</span> <span class="o">=</span> <span class="mi">7</span> <span class="c1"># Person number 7
</span>
<span class="n">P1</span> <span class="o">=</span> <span class="n">faces</span><span class="p">[:,</span> <span class="n">np</span><span class="p">.</span><span class="nf">sum</span><span class="p">(</span><span class="n">nfaces</span><span class="p">[:(</span><span class="n">P1num</span><span class="o">-</span><span class="mi">1</span><span class="p">)]):</span><span class="n">np</span><span class="p">.</span><span class="nf">sum</span><span class="p">(</span><span class="n">nfaces</span><span class="p">[:</span><span class="n">P1num</span><span class="p">])]</span>
<span class="n">P2</span> <span class="o">=</span> <span class="n">faces</span><span class="p">[:,</span> <span class="n">np</span><span class="p">.</span><span class="nf">sum</span><span class="p">(</span><span class="n">nfaces</span><span class="p">[:(</span><span class="n">P2num</span><span class="o">-</span><span class="mi">1</span><span class="p">)]):</span><span class="n">np</span><span class="p">.</span><span class="nf">sum</span><span class="p">(</span><span class="n">nfaces</span><span class="p">[:</span><span class="n">P2num</span><span class="p">])]</span>

<span class="n">P1</span> <span class="o">=</span> <span class="n">P1</span> <span class="o">-</span> <span class="n">np</span><span class="p">.</span><span class="nf">tile</span><span class="p">(</span><span class="n">avgFace</span><span class="p">,</span> <span class="p">(</span><span class="n">P1</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="mi">1</span><span class="p">)).</span><span class="n">T</span>
<span class="n">P2</span> <span class="o">=</span> <span class="n">P2</span> <span class="o">-</span> <span class="n">np</span><span class="p">.</span><span class="nf">tile</span><span class="p">(</span><span class="n">avgFace</span><span class="p">,</span> <span class="p">(</span><span class="n">P2</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="mi">1</span><span class="p">)).</span><span class="n">T</span>

<span class="n">PCAmodes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
<span class="n">PCACoordsP1</span> <span class="o">=</span> <span class="n">U</span><span class="p">[:,</span> <span class="n">PCAmodes</span><span class="o">-</span><span class="n">np</span><span class="p">.</span><span class="nf">ones_like</span><span class="p">(</span><span class="n">PCAmodes</span><span class="p">)].</span><span class="n">T</span> <span class="o">@</span> <span class="n">P1</span>
<span class="n">PCACoordsP2</span> <span class="o">=</span> <span class="n">U</span><span class="p">[:,</span> <span class="n">PCAmodes</span><span class="o">-</span><span class="n">np</span><span class="p">.</span><span class="nf">ones_like</span><span class="p">(</span><span class="n">PCAmodes</span><span class="p">)].</span><span class="n">T</span> <span class="o">@</span> <span class="n">P2</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">PCACoordsP1</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">PCACoordsP1</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="sh">'</span><span class="s">d</span><span class="sh">'</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="sh">'</span><span class="s">k</span><span class="sh">'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="sh">"</span><span class="s">Person </span><span class="si">{</span><span class="n">P1num</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">PCACoordsP2</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">PCACoordsP2</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="sh">'</span><span class="s">^</span><span class="sh">'</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="sh">'</span><span class="s">r</span><span class="sh">'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="sh">"</span><span class="s">Person </span><span class="si">{</span><span class="n">P2num</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>

<span class="n">ax</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">PCACoordsP1</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">PCACoordsP1</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">marker</span> <span class="o">=</span> <span class="sh">'</span><span class="s">d</span><span class="sh">'</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="sh">''</span><span class="p">,</span> <span class="n">markerfacecolor</span> <span class="o">=</span> <span class="sh">'</span><span class="s">none</span><span class="sh">'</span><span class="p">,</span> 
        <span class="n">markeredgewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">markeredgecolor</span><span class="o">=</span><span class="sh">'</span><span class="s">g</span><span class="sh">'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="sh">"</span><span class="s">Person </span><span class="si">{</span><span class="n">P1num</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">PCACoordsP2</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">PCACoordsP2</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">marker</span> <span class="o">=</span> <span class="sh">'</span><span class="s">^</span><span class="sh">'</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="sh">''</span><span class="p">,</span> <span class="n">markerfacecolor</span> <span class="o">=</span> <span class="sh">'</span><span class="s">none</span><span class="sh">'</span><span class="p">,</span> 
        <span class="n">markeredgewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">markeredgecolor</span><span class="o">=</span><span class="sh">'</span><span class="s">g</span><span class="sh">'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="sh">"</span><span class="s">Person </span><span class="si">{</span><span class="n">P2num</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>

<span class="n">ax</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">PCACoordsP1</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">PCACoordsP1</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">marker</span> <span class="o">=</span> <span class="sh">'</span><span class="s">d</span><span class="sh">'</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="sh">''</span><span class="p">,</span> <span class="n">markerfacecolor</span> <span class="o">=</span> <span class="sh">'</span><span class="s">none</span><span class="sh">'</span><span class="p">,</span> 
        <span class="n">markeredgewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">markeredgecolor</span><span class="o">=</span><span class="sh">'</span><span class="s">g</span><span class="sh">'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="sh">"</span><span class="s">Person </span><span class="si">{</span><span class="n">P1num</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">PCACoordsP2</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">PCACoordsP2</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">marker</span> <span class="o">=</span> <span class="sh">'</span><span class="s">^</span><span class="sh">'</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="sh">''</span><span class="p">,</span> <span class="n">markerfacecolor</span> <span class="o">=</span> <span class="sh">'</span><span class="s">none</span><span class="sh">'</span><span class="p">,</span> 
        <span class="n">markeredgewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">markeredgecolor</span><span class="o">=</span><span class="sh">'</span><span class="s">g</span><span class="sh">'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="sh">"</span><span class="s">Person </span><span class="si">{</span><span class="n">P2num</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>

<span class="n">ax</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">PCACoordsP1</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">PCACoordsP1</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">marker</span> <span class="o">=</span> <span class="sh">'</span><span class="s">d</span><span class="sh">'</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="sh">''</span><span class="p">,</span> <span class="n">markerfacecolor</span> <span class="o">=</span> <span class="sh">'</span><span class="s">none</span><span class="sh">'</span><span class="p">,</span> 
        <span class="n">markeredgewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">markeredgecolor</span><span class="o">=</span><span class="sh">'</span><span class="s">g</span><span class="sh">'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="sh">"</span><span class="s">Person </span><span class="si">{</span><span class="n">P1num</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">PCACoordsP2</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">PCACoordsP2</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">marker</span> <span class="o">=</span> <span class="sh">'</span><span class="s">^</span><span class="sh">'</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="sh">''</span><span class="p">,</span> <span class="n">markerfacecolor</span> <span class="o">=</span> <span class="sh">'</span><span class="s">none</span><span class="sh">'</span><span class="p">,</span> 
        <span class="n">markeredgewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">markeredgecolor</span><span class="o">=</span><span class="sh">'</span><span class="s">g</span><span class="sh">'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="sh">"</span><span class="s">Person </span><span class="si">{</span><span class="n">P2num</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>

<span class="n">ax</span><span class="p">.</span><span class="nf">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="sh">"</span><span class="s">PC 5</span><span class="sh">"</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="sh">"</span><span class="s">PC 6</span><span class="sh">"</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">set_xticks</span><span class="p">([</span><span class="mi">0</span><span class="p">])</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">set_yticks</span><span class="p">([</span><span class="mi">0</span><span class="p">])</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</code></pre></div></div> <figure> <img src="https://goswami-13.github.io/images/Post20/PCANew.jpg" width="100%"> </figure> <p>The visualization above showcases the coordinates of all 64 images (representing various lighting conditions) of two individuals projected into the 5th and 6th principal components derived from the eigenface space. Notably, the images of the two individual faces exhibit discernible separation in these coordinates. This observation underscores PCA’s efficacy in extracting discriminant features capable of distinguishing between distinct individuals, even amidst the myriad variations introduced by different lighting conditions.</p> <p>This compelling demonstration underscores PCA’s potential to serve as the cornerstone of an image recognition and classification algorithm. By leveraging the rich feature representation provided by PCA, we can effectively discern subtle nuances and variations within facial images, facilitating accurate classification and recognition tasks across diverse datasets and conditions. This highlights PCA’s versatility and utility as a powerful tool in the realm of image processing and pattern recognition.</p> </d-article> <d-appendix> <d-footnote-list></d-footnote-list> <d-citation-list></d-citation-list> </d-appendix> <d-bibliography src="/assets/bibliography/"></d-bibliography> <d-article> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/posts/2025/06/blog-post-54/">Tabulating 6-DOF Motion Kinematics in OpenFOAM using Python</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/posts/2025/06/blog-post-53/">Setting Up Overset Mesh Cases in OpenFOAM Made Easy</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/posts/2025/06/blog-post-52/">An Introduction to Overset Mesh in OpenFOAM</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/posts/2025/05/blog-post-51/">Python Tools for Analyzing and Visualizing Mesh Motion Simulations</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/posts/2025/03/blog-post-50/">Simulating Pure Pitching and Heaving Motions in OpenFOAM</a> </li> <br> <br> </d-article> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 Shubham Goswami, PhD. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script src="/assets/js/distillpub/overrides.js"></script> <script defer src="https://cdn.jsdelivr.net/npm/mermaid@10.7.0/dist/mermaid.min.js" integrity="sha256-TtLOdUA8mstPoO6sGvHIGx2ceXrrX4KgIItO06XOn8A=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/d3@7.8.5/dist/d3.min.js" integrity="sha256-1rA678n2xEx7x4cTZ5x4wpUCj6kUMZEZ5cxLSVSFWxw=" crossorigin="anonymous"></script> <script defer src="/assets/js/mermaid-setup.js?38ca0a0126f7328d2d9a46bad640931f" type="text/javascript"></script> <script src="https://cdn.jsdelivr.net/npm/diff2html@3.4.47/bundles/js/diff2html-ui.min.js" integrity="sha256-eU2TVHX633T1o/bTQp6iIJByYJEtZThhF9bKz/DcbbY=" crossorigin="anonymous"></script> <script defer src="/assets/js/diff2html-setup.js?80a6e52ce727518bbd3aed2bb6ba5601" type="text/javascript"></script> <script src="https://cdn.jsdelivr.net/npm/leaflet@1.9.4/dist/leaflet.min.js" integrity="sha256-MgH13bFTTNqsnuEoqNPBLDaqxjGH+lCpqrukmXc8Ppg=" crossorigin="anonymous"></script> <script defer src="/assets/js/leaflet-setup.js?b6313931e203b924523e2d8b75fe8874" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js" integrity="sha256-0q+JdOlScWOHcunpUk21uab1jW7C1deBQARHtKMcaB4=" crossorigin="anonymous"></script> <script defer src="/assets/js/chartjs-setup.js?183c5859923724fb1cb3c67593848e71" type="text/javascript"></script> <script src="https://cdn.jsdelivr.net/npm/echarts@5.5.0/dist/echarts.min.js" integrity="sha256-QvgynZibb2U53SsVu98NggJXYqwRL7tg3FeyfXvPOUY=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/echarts@5.5.0/theme/dark-fresh-cut.js" integrity="sha256-sm6Ui9w41++ZCWmIWDLC18a6ki72FQpWDiYTDxEPXwU=" crossorigin="anonymous"></script> <script defer src="/assets/js/echarts-setup.js?738178999630746a8d0cfc261fc47c2c" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/vega@5.27.0/build/vega.min.js" integrity="sha256-Yot/cfgMMMpFwkp/5azR20Tfkt24PFqQ6IQS+80HIZs=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/vega-lite@5.16.3/build/vega-lite.min.js" integrity="sha256-TvBvIS5jUN4BSy009usRjNzjI1qRrHPYv7xVLJyjUyw=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/vega-embed@6.24.0/build/vega-embed.min.js" integrity="sha256-FPCJ9JYCC9AZSpvC/t/wHBX7ybueZhIqOMjpWqfl3DU=" crossorigin="anonymous"></script> <script defer src="/assets/js/vega-setup.js?7c7bee055efe9312afc861b128fe5f36" type="text/javascript"></script> <script defer src="https://tikzjax.com/v1/tikzjax.js" integrity="sha256-+1qyucCXRZJrCg3lm3KxRt/7WXaYhBid4/1XJRHGB1E=" crossorigin="anonymous"></script> <script src="/assets/js/typograms.js?062e75bede72543443762dc3fe36c7a5"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?c8a01c11a92744d44b093fc3bda915df" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?a5bb4e6a542c546dd929b24b8b236dfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> <script type="module" src="/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/assets/js/search-setup.js?6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/assets/js/search-data.js"></script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>