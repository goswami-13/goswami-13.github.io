<!DOCTYPE html> <html> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Demystify Fluid Flow with Dynamic Mode Decomposition (DMD) | Shubham Goswami, PhD </title> <meta name="author" content="Shubham Goswami, PhD"> <meta name="description" content="Personal and professional website of Shubham Goswami, PhD. "> <link rel="stylesheet" href="/al-folio/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/al-folio/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/al-folio/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/al-folio/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/al-folio/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://shubhamdgoswami.github.io/al-folio/posts/2024/05/blog-post-29/"> <script src="/al-folio/assets/js/theme.js?a81d82887dd692e91686b43de4542f18"></script> <link defer rel="stylesheet" href="/al-folio/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> <link defer rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet@1.9.4/dist/leaflet.min.css" integrity="sha256-q9ba7o845pMPFU+zcAll8rv+gC+fSovKsOoNQ6cynuQ=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.9.0/styles/github.min.css" integrity="sha256-Oppd74ucMR5a5Dq96FxjEzGF7tTw2fZ/6ksAqDCM8GY=" crossorigin="anonymous" media="screen and (prefers-color-scheme: light)"> <link defer rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.9.0/styles/github-dark.min.css" integrity="sha256-nyCNAiECsdDHrr/s2OQsp5l9XeY2ZJ0rMepjCT2AkBk=" crossorigin="anonymous" media="screen and (prefers-color-scheme: dark)"> <link defer rel="stylesheet" href="https://cdn.jsdelivr.net/npm/diff2html@3.4.47/bundles/css/diff2html.min.css" integrity="sha256-IMBK4VNZp0ivwefSn51bswdsrhk0HoMTLc2GqFHFBXg=" crossorigin="anonymous"> <link defer rel="stylesheet" type="text/css" href="https://tikzjax.com/v1/fonts.css"> <script src="/al-folio/assets/js/distillpub/template.v2.js"></script> <script src="/al-folio/assets/js/distillpub/transforms.v2.js"></script> <style type="text/css">.fake-img{background:#bbb;border:1px solid rgba(0,0,0,0.1);box-shadow:0 0 4px rgba(0,0,0,0.1);margin-bottom:12px}.fake-img p{font-family:monospace;color:white;text-align:left;margin:12px 0;text-align:center;font-size:16px}</style> </head> <body> <d-front-matter> <script async type="text/json">
      {
            "title": "Demystify Fluid Flow with Dynamic Mode Decomposition (DMD)",
            "description": "",
            "published": "August 06, 2024",
            "authors": [
              
            ],
            "katex": {
              "delimiters": [
                {
                  "left": "$",
                  "right": "$",
                  "display": false
                },
                {
                  "left": "$$",
                  "right": "$$",
                  "display": true
                }
              ]
            }
          }
    </script> </d-front-matter> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/al-folio/"> <span class="font-weight-bold">Shubham</span> Goswami, PhD </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/al-folio/">About </a> </li> <li class="nav-item "> <a class="nav-link" href="/al-folio/cv/">CV </a> </li> <li class="nav-item "> <a class="nav-link" href="/al-folio/blog/">Guides </a> </li> <li class="nav-item "> <a class="nav-link" href="/al-folio/publications/">Publications </a> </li> <li class="nav-item "> <a class="nav-link" href="/al-folio/teaching/">Teaching </a> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="post distill"> <d-title> <h1>Demystify Fluid Flow with Dynamic Mode Decomposition (DMD)</h1> <p></p> </d-title> <d-article> <d-contents> <nav class="l-text figcaption"> <h3>Contents</h3> </nav> </d-contents> <p>Fluid flows, with their mesmerizing swirls and eddies, are prime examples of complex systems. But hidden within this complexity lies order! This blog post delves into how Dynamic Mode Decomposition (DMD) can be applied to unlock the secrets of fluid flow data. We’ll explore how DMD extracts meaningful patterns, providing valuable insights for scientists and engineers.</p> <figure> <img src="https://goswami-13.github.io/images/Post28/BlogLogo.gif" width="80%"> </figure> <p>Dynamic Mode Decomposition (DMD), pioneered by <a href="https://www.cambridge.org/core/journals/journal-of-fluid-mechanics/article/dynamic-mode-decomposition-of-numerical-and-experimental-data/AA4C763B525515AD4521A6CC5E10DBD4" rel="external nofollow noopener" target="_blank">Schmid (2010)</a> in the fluid dynamics community, revolutionized the identification of spatio-temporal coherent structures from high-dimensional data. Building upon the foundation of Proper Orthogonal Decomposition (POD), DMD leverages the computationally efficient Singular Value Decomposition (SVD), enabling scalable and effective dimensionality reduction in complex systems. Unlike SVD/POD, which prioritizes spatial correlation and energy content, often neglecting temporal dynamics, DMD offers a modal decomposition approach. Here, each mode encapsulates spatially correlated structures exhibiting identical linear behavior over time, such as oscillations at a specific frequency with either growth or decay. Thus, DMD not only streamlines dimensionality reduction by yielding a reduced set of modes but also furnishes a temporal model delineating the evolution of these modes.</p> <p>In this article, I’ll be showcasing the application of DMD on a dataset portraying a time series of fluid vorticity fields depicting the wake behind a circular cylinder at Reynolds number Re = 100, sourced from <a href="http://dmdbook.com/" rel="external nofollow noopener" target="_blank">Data-Driven Modeling of Complex Systems</a>. To get started, you can download the dataset from this <a href="http://dmdbook.com/" rel="external nofollow noopener" target="_blank">link</a>. Choosing Re = 100 serves as an optimal benchmark due to its significance beyond the critical Reynolds number 47. At this threshold, the flow undergoes a supercritical Hopf bifurcation, resulting in laminar vortex shedding.</p> <p>Within our computational framework, the domain encompasses 450 × 200 grid points. Employing a time step of Δt = 0.02 ensures compliance with the CFL condition. The simulation harnesses the two-dimensional Navier–Stokes equations, executed through an immersed boundary projection method (IBPM) fluid solver, founded on the <a href="https://github.com/cwrowley/ibpm" rel="external nofollow noopener" target="_blank">fast multidomain method</a>. Snapshots capturing the cylinder wake are gathered post simulations, converging to a state of steady-state vortex shedding. A total of 150 snapshots were meticulously collected at regular intervals of 10Δt, effectively sampling five periods of vortex shedding.</p> <p>Let’s dive in!</p> <h1 id="initial-setup">Initial setup</h1> <p>To begin, fire up a Jupyter notebook and import the essential modules:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">matplotlib.colors</span>
<span class="kn">import</span> <span class="n">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="n">fluidfoam</span> <span class="k">as</span> <span class="n">fl</span>
<span class="kn">import</span> <span class="n">scipy</span> <span class="k">as</span> <span class="n">sp</span>
<span class="kn">import</span> <span class="n">os</span>
<span class="kn">import</span> <span class="n">matplotlib.animation</span> <span class="k">as</span> <span class="n">animation</span>
<span class="kn">import</span> <span class="n">pyvista</span> <span class="k">as</span> <span class="n">pv</span>
<span class="kn">import</span> <span class="n">imageio</span>
<span class="kn">import</span> <span class="n">io</span>
<span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
<span class="n">plt</span><span class="p">.</span><span class="n">rcParams</span><span class="p">.</span><span class="nf">update</span><span class="p">({</span><span class="sh">'</span><span class="s">font.size</span><span class="sh">'</span> <span class="p">:</span> <span class="mi">20</span><span class="p">,</span> <span class="sh">'</span><span class="s">font.family</span><span class="sh">'</span> <span class="p">:</span> <span class="sh">'</span><span class="s">Times New Roman</span><span class="sh">'</span><span class="p">,</span> <span class="sh">"</span><span class="s">text.usetex</span><span class="sh">"</span><span class="p">:</span> <span class="bp">True</span><span class="p">})</span>
</code></pre></div></div> <p>Next, after downloading the dataset as directed earlier, ensure it’s placed in your working directory. Then, in Python, set the path variables by:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Path</span> <span class="o">=</span> <span class="sh">'</span><span class="s">E:/Blog_Posts/BruntonCylinder/</span><span class="sh">'</span> <span class="c1">### Path to your working folder
</span><span class="n">save_path</span> <span class="o">=</span> <span class="sh">'</span><span class="s">E:/Blog_Posts/OpenFOAM/ROM_Series/Post28/</span><span class="sh">'</span> <span class="c1">### Path to your working folder
</span><span class="n">Files</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="nf">listdir</span><span class="p">(</span><span class="n">Path</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">Files</span><span class="p">)</span>

<span class="c1">### OUTPUT
### ['CYLINDER_ALL.mat', 'CYLINDER_basis.mat', 'VORTALL.mat']
</span></code></pre></div></div> <p>Load the <code class="language-plaintext highlighter-rouge">CYLINDER_ALL.mat</code>:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Contents</span> <span class="o">=</span> <span class="n">sp</span><span class="p">.</span><span class="n">io</span><span class="p">.</span><span class="nf">loadmat</span><span class="p">(</span><span class="n">Path</span> <span class="o">+</span> <span class="n">Files</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</code></pre></div></div> <p>Given that this file essentially acts as a dictionary, you can list out its keys using the <code class="language-plaintext highlighter-rouge">keys()</code> method:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Contents</span><span class="p">.</span><span class="nf">keys</span><span class="p">()</span>

<span class="c1">### Output:
### dict_keys(['__header__', '__version__', '__globals__', 'UALL', 'UEXTRA', 'VALL', 'VEXTRA', 'VORTALL', 'VORTEXTRA', 'm', 'n', 'nx', 'ny'])
</span></code></pre></div></div> <p>Let’s begin by extracting the necessary data from this dictionary. This step involves identifying and retrieving the specific information or variables needed for our analysis.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">m</span> <span class="o">=</span> <span class="n">Contents</span><span class="p">[</span><span class="sh">'</span><span class="s">m</span><span class="sh">'</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">Contents</span><span class="p">[</span><span class="sh">'</span><span class="s">n</span><span class="sh">'</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="n">Vort</span> <span class="o">=</span> <span class="n">Contents</span><span class="p">[</span><span class="sh">'</span><span class="s">VORTALL</span><span class="sh">'</span><span class="p">]</span>
<span class="nf">print</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">Vort</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>

<span class="c1">### Output:
### 199 449
### (89351, 151)
</span></code></pre></div></div> <p>Based on this information, we understand that the data comprises 199 x 499 (= 89,351) spatial degrees of freedom and includes 151 available snapshots.</p> <p>Lets visualize one snapshots using a simple plotting routine in matplotlib:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Circle</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nc">Circle</span><span class="p">((</span><span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="mi">25</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="sh">'</span><span class="s">k</span><span class="sh">'</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="sh">'</span><span class="s">white</span><span class="sh">'</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">ax</span><span class="p">.</span><span class="nf">contourf</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">reshape</span><span class="p">(</span><span class="n">Vort</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],(</span><span class="n">n</span><span class="p">,</span><span class="n">m</span><span class="p">)).</span><span class="n">T</span><span class="p">,</span> <span class="n">levels</span> <span class="o">=</span> <span class="mi">1001</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">2</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="n">cmap</span><span class="p">.</span><span class="nf">reversed</span><span class="p">())</span>
<span class="n">q</span> <span class="o">=</span> <span class="n">ax</span><span class="p">.</span><span class="nf">contour</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">reshape</span><span class="p">(</span><span class="n">Vort</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],(</span><span class="n">n</span><span class="p">,</span><span class="n">m</span><span class="p">)).</span><span class="n">T</span><span class="p">,</span> 
               <span class="n">levels</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">2.4</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.6</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.8</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.6</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">2.4</span><span class="p">],</span> 
               <span class="n">colors</span><span class="o">=</span><span class="sh">'</span><span class="s">k</span><span class="sh">'</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">add_patch</span><span class="p">(</span><span class="n">Circle</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">set_aspect</span><span class="p">(</span><span class="sh">'</span><span class="s">equal</span><span class="sh">'</span><span class="p">)</span>
<span class="n">xax</span> <span class="o">=</span> <span class="n">ax</span><span class="p">.</span><span class="n">axes</span><span class="p">.</span><span class="nf">get_xaxis</span><span class="p">()</span>
<span class="n">xax</span> <span class="o">=</span> <span class="n">xax</span><span class="p">.</span><span class="nf">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
<span class="n">yax</span> <span class="o">=</span> <span class="n">ax</span><span class="p">.</span><span class="n">axes</span><span class="p">.</span><span class="nf">get_yaxis</span><span class="p">()</span>
<span class="n">yax</span> <span class="o">=</span> <span class="n">yax</span><span class="p">.</span><span class="nf">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</code></pre></div></div> <figure> <img src="https://goswami-13.github.io/images/Post28/Vort1Snap.jpeg" width="80%"> </figure> <h1 id="proper-orthogonal-decomposition">Proper Orthogonal Decomposition</h1> <p>Before getting to Dynamic Mode Decomposition, let’s first compute Proper Orthogonal Decomposition (POD) of the flow field. This will aid in determining the appropriate r-rank approximation needed for DMD. As a quick recap, the DMD algorithm relies on Singular Value Decomposition (SVD) reduction to execute a low-rank truncation of the data. If the data harbors low-dimensional structures, the singular values of Σ will sharply decline towards zero, potentially with only a handful of dominant modes.</p> <p>It’s worth noting that POD can be applied to either fluid velocity field or vorticity field data. In our case, we’ll be utilizing vorticity fields.</p> <p>Here’s a rundown of the steps for POD:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">### POD Analysis
</span>
<span class="c1">### Data Matrix
</span><span class="n">X</span> <span class="o">=</span> <span class="n">Vort</span>

<span class="c1">### Mean-removed Matrix
</span><span class="n">X_mean</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">mean</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">X</span> <span class="o">-</span> <span class="n">X_mean</span><span class="p">[:,</span><span class="n">np</span><span class="p">.</span><span class="n">newaxis</span><span class="p">]</span>

<span class="c1">### Covariance Matrix
</span><span class="n">C</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">dot</span><span class="p">(</span><span class="n">Y</span><span class="p">.</span><span class="n">T</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">Y</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="c1">### SVD of Covariance Matrix
</span><span class="n">U</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">V</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linalg</span><span class="p">.</span><span class="nf">svd</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>

<span class="c1">### POD modes
</span><span class="n">Phi</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">dot</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">U</span><span class="p">)</span>

<span class="c1">### Temporal coefficients
</span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">dot</span><span class="p">(</span><span class="n">Phi</span><span class="p">.</span><span class="n">T</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>
</code></pre></div></div> <p>Now, since the objective behind conducting POD was to ascertain the minimum rank necessary for DMD, let’s visualize the energy content of the POD modes along with the cumulative energy:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Energy</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">((</span><span class="nf">len</span><span class="p">(</span><span class="n">S</span><span class="p">),</span><span class="mi">1</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="p">.</span><span class="nf">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nf">len</span><span class="p">(</span><span class="n">S</span><span class="p">)):</span>
    <span class="n">Energy</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">S</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="n">np</span><span class="p">.</span><span class="nf">sum</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>

<span class="n">X_Axis</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">arange</span><span class="p">(</span><span class="n">Energy</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">heights</span> <span class="o">=</span> <span class="n">Energy</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">Energy</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="sh">'</span><span class="s">o</span><span class="sh">'</span><span class="p">,</span> <span class="n">markerfacecolor</span> <span class="o">=</span> <span class="sh">'</span><span class="s">none</span><span class="sh">'</span><span class="p">,</span> <span class="n">markeredgecolor</span> <span class="o">=</span> <span class="sh">'</span><span class="s">k</span><span class="sh">'</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="sh">'</span><span class="s">-</span><span class="sh">'</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="sh">'</span><span class="s">k</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">set_xlabel</span><span class="p">(</span><span class="sh">'</span><span class="s">Modes</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">set_ylabel</span><span class="p">(</span><span class="sh">'</span><span class="s">Energy Content</span><span class="sh">'</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">cumulative</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">cumsum</span><span class="p">(</span><span class="n">S</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="p">.</span><span class="nf">sum</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">cumulative</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="sh">'</span><span class="s">o</span><span class="sh">'</span><span class="p">,</span> <span class="n">markerfacecolor</span> <span class="o">=</span> <span class="sh">'</span><span class="s">none</span><span class="sh">'</span><span class="p">,</span> <span class="n">markeredgecolor</span> <span class="o">=</span> <span class="sh">'</span><span class="s">k</span><span class="sh">'</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="sh">'</span><span class="s">-</span><span class="sh">'</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="sh">'</span><span class="s">k</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">set_xlabel</span><span class="p">(</span><span class="sh">'</span><span class="s">Modes</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">set_ylabel</span><span class="p">(</span><span class="sh">'</span><span class="s">Cumulative Energy</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</code></pre></div></div> <figure> <img src="https://goswami-13.github.io/images/Post28/Energy.jpeg" width="80%"> </figure> <p>This illustration demonstrates that the initial 10 POD modes encapsulate approximately 97% of the total energy, while the first 21 modes encompass nearly 99.9% of it. Consequently, a rank-21 approximated DMD should effectively capture the predominant dynamics of the flow.</p> <p>To wrap up, here are the first 8 POD modes for comprehensive reference.</p> <figure> <img src="https://goswami-13.github.io/images/Post28/First6Modes.jpeg" width="80%"> </figure> <h1 id="dynamic-mode-decomposition">Dynamic Mode Decomposition</h1> <p>Implementing DMD on the cylinder wake necessitates the same fundamental snapshot information as POD, rendering it a data-driven method that seamlessly adapts to data sourced from simulations or experiments.</p> <p>In this section, we will employ the DMD function from my previous article to compute the DMD modes.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">DMD</span><span class="p">(</span><span class="n">X1</span><span class="p">,</span> <span class="n">X2</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">dt</span><span class="p">):</span>
    <span class="n">U</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">Vh</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linalg</span><span class="p">.</span><span class="nf">svd</span><span class="p">(</span><span class="n">X1</span><span class="p">,</span> <span class="n">full_matrices</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="c1">### Truncate the SVD matrices
</span>    <span class="n">Ur</span> <span class="o">=</span> <span class="n">U</span><span class="p">[:,</span> <span class="p">:</span><span class="n">r</span><span class="p">]</span>
    <span class="n">Sr</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">diag</span><span class="p">(</span><span class="n">s</span><span class="p">[:</span><span class="n">r</span><span class="p">])</span>
    <span class="n">Vr</span> <span class="o">=</span> <span class="n">Vh</span><span class="p">.</span><span class="nf">conj</span><span class="p">().</span><span class="n">T</span><span class="p">[:,</span> <span class="p">:</span><span class="n">r</span><span class="p">]</span>
    
    <span class="c1">### Build the Atilde and find the eigenvalues and eigenvectors
</span>    <span class="n">Atilde</span> <span class="o">=</span> <span class="n">Ur</span><span class="p">.</span><span class="nf">conj</span><span class="p">().</span><span class="n">T</span> <span class="o">@</span> <span class="n">X2</span> <span class="o">@</span> <span class="n">Vr</span> <span class="o">@</span> <span class="n">np</span><span class="p">.</span><span class="n">linalg</span><span class="p">.</span><span class="nf">inv</span><span class="p">(</span><span class="n">Sr</span><span class="p">)</span>
    <span class="n">Lambda</span><span class="p">,</span> <span class="n">W</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linalg</span><span class="p">.</span><span class="nf">eig</span><span class="p">(</span><span class="n">Atilde</span><span class="p">)</span>
    
    <span class="c1">### Compute the DMD modes
</span>    <span class="n">Phi</span> <span class="o">=</span> <span class="n">X2</span> <span class="o">@</span> <span class="n">Vr</span> <span class="o">@</span> <span class="n">np</span><span class="p">.</span><span class="n">linalg</span><span class="p">.</span><span class="nf">inv</span><span class="p">(</span><span class="n">Sr</span><span class="p">)</span> <span class="o">@</span> <span class="n">W</span>
    
    <span class="n">omega</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="n">Lambda</span><span class="p">)</span><span class="o">/</span><span class="n">dt</span> <span class="c1">### continuous time eigenvalues
</span>    
    <span class="c1">### Compute the amplitudes
</span>    
    <span class="n">alpha1</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linalg</span><span class="p">.</span><span class="nf">lstsq</span><span class="p">(</span><span class="n">Phi</span><span class="p">,</span> <span class="n">X1</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">rcond</span><span class="o">=</span><span class="bp">None</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="c1">### DMD mode amplitudes
</span>    
    <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linalg</span><span class="p">.</span><span class="nf">lstsq</span><span class="p">(</span><span class="n">Phi</span><span class="p">,</span> <span class="n">X2</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">rcond</span><span class="o">=</span><span class="bp">None</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="c1">### DMD mode amplitudes
</span>    
    <span class="c1">### DMD reconstruction
</span>    <span class="n">time_dynamics</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">X1</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
        <span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">(</span><span class="n">alpha1</span><span class="p">)[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="p">.</span><span class="nf">exp</span><span class="p">(</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">(</span><span class="n">omega</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">dt</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">time_dynamics</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">time_dynamics</span> <span class="o">=</span> <span class="n">v</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">time_dynamics</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">vstack</span><span class="p">((</span><span class="n">time_dynamics</span><span class="p">,</span> <span class="n">v</span><span class="p">))</span>
    <span class="n">X_dmd</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">dot</span><span class="p">(</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">(</span><span class="n">Phi</span><span class="p">),</span> <span class="n">time_dynamics</span><span class="p">.</span><span class="n">T</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">Phi</span><span class="p">,</span> <span class="n">omega</span><span class="p">,</span> <span class="n">Lambda</span><span class="p">,</span> <span class="n">alpha1</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">X_dmd</span>
</code></pre></div></div> <p>Next, generate the two time-shifted data matrices. For reference, here’s a schematic illustrating the data matrices and their respective representations.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">### get two views of the data matrix offset by one time step
</span><span class="n">X1</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">matrix</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="n">X2</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">matrix</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:])</span>

<span class="c1">### Constants 
</span><span class="n">r</span> <span class="o">=</span> <span class="mi">21</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mf">0.02</span><span class="o">*</span><span class="mi">10</span>
</code></pre></div></div> <p>Here are the schematics of the data matrices:</p> <figure> <img src="https://goswami-13.github.io/images/Post28/X_Matrix.PNG" width="80%"> </figure> <figure> <img src="https://goswami-13.github.io/images/Post28/XP_Matrix.PNG" width="80%"> </figure> <p>Now, let’s proceed to compute DMD.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Phi</span><span class="p">,</span> <span class="n">omega</span><span class="p">,</span> <span class="n">Lambda</span><span class="p">,</span> <span class="n">alpha1</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">X_dmd</span> <span class="o">=</span> <span class="nc">DMD</span><span class="p">(</span><span class="n">X1</span><span class="p">,</span> <span class="n">X2</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>
</code></pre></div></div> <p>Now that we’ve computed DMD, the next question arises: how should one commence analyzing the DMD data? Let’s start by examining the individual terms we’ve extracted, gathering insights into their size, type, and structure.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">PhiShape = </span><span class="sh">'</span><span class="p">,</span> <span class="n">Phi</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">OmegaShape = </span><span class="sh">'</span><span class="p">,</span> <span class="n">omega</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">LambdaShape = </span><span class="sh">'</span><span class="p">,</span> <span class="n">Lambda</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">Alpha1Shape = </span><span class="sh">'</span><span class="p">,</span> <span class="n">alpha1</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">bShape = </span><span class="sh">'</span><span class="p">,</span> <span class="n">b</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">X_dmdShape = </span><span class="sh">'</span><span class="p">,</span> <span class="n">X_dmd</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>

<span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">typePhi = </span><span class="sh">'</span><span class="p">,</span> <span class="n">Phi</span><span class="p">.</span><span class="n">dtype</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">typeOmega = </span><span class="sh">'</span><span class="p">,</span> <span class="n">omega</span><span class="p">.</span><span class="n">dtype</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">typeLambda = </span><span class="sh">'</span><span class="p">,</span> <span class="n">Lambda</span><span class="p">.</span><span class="n">dtype</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">typeAlpha1 = </span><span class="sh">'</span><span class="p">,</span> <span class="n">alpha1</span><span class="p">.</span><span class="n">dtype</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">typeb = </span><span class="sh">'</span><span class="p">,</span> <span class="n">b</span><span class="p">.</span><span class="n">dtype</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">typeX_dmd = </span><span class="sh">'</span><span class="p">,</span> <span class="n">X_dmd</span><span class="p">.</span><span class="n">dtype</span><span class="p">)</span>
</code></pre></div></div> <p>Output:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">PhiShape</span> <span class="o">=</span>  <span class="p">(</span><span class="mi">89351</span><span class="p">,</span> <span class="mi">21</span><span class="p">)</span>
<span class="n">OmegaShape</span> <span class="o">=</span>  <span class="p">(</span><span class="mi">21</span><span class="p">,)</span>
<span class="n">LambdaShape</span> <span class="o">=</span>  <span class="p">(</span><span class="mi">21</span><span class="p">,)</span>
<span class="n">Alpha1Shape</span> <span class="o">=</span>  <span class="p">(</span><span class="mi">21</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">bShape</span> <span class="o">=</span>  <span class="p">(</span><span class="mi">21</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">X_dmdShape</span> <span class="o">=</span>  <span class="p">(</span><span class="mi">89351</span><span class="p">,</span> <span class="mi">150</span><span class="p">)</span>
<span class="n">typePhi</span> <span class="o">=</span>  <span class="n">complex128</span>
<span class="n">typeOmega</span> <span class="o">=</span>  <span class="n">complex128</span>
<span class="n">typeLambda</span> <span class="o">=</span>  <span class="n">complex128</span>
<span class="n">typeAlpha1</span> <span class="o">=</span>  <span class="n">complex128</span>
<span class="n">typeb</span> <span class="o">=</span>  <span class="n">complex128</span>
<span class="n">typeX_dmd</span> <span class="o">=</span>  <span class="n">complex128</span>
</code></pre></div></div> <p>Let’s decipher this step by step. Firstly, the shapes of Phi, Omega, Lambda, and alpha reflect the rank-21 approximation, hinting that we’re focusing solely on the most dominant structures in the flow. Additionally, the data type of the different arrays is complex. With this in mind, let’s examine the Lambda array, which represents the eigenvalues.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">print</span><span class="p">(</span><span class="n">Lambda</span><span class="p">)</span>
</code></pre></div></div> <p>Output:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="o">-</span><span class="mf">0.48625223</span><span class="o">+</span><span class="mf">0.87378727j</span> <span class="o">-</span><span class="mf">0.48625223</span><span class="o">-</span><span class="mf">0.87378727j</span> <span class="o">-</span><span class="mf">0.29541768</span><span class="o">+</span><span class="mf">0.95537656j</span>
 <span class="o">-</span><span class="mf">0.29541768</span><span class="o">-</span><span class="mf">0.95537656j</span> <span class="o">-</span><span class="mf">0.09183219</span><span class="o">+</span><span class="mf">0.99576056j</span> <span class="o">-</span><span class="mf">0.09183219</span><span class="o">-</span><span class="mf">0.99576056j</span>
  <span class="mf">0.11562445</span><span class="o">+</span><span class="mf">0.99328608j</span>  <span class="mf">0.11562445</span><span class="o">-</span><span class="mf">0.99328608j</span>  <span class="mf">1.</span>        <span class="o">+</span><span class="mf">0.j</span>
  <span class="mf">0.97847826</span><span class="o">+</span><span class="mf">0.20635002j</span>  <span class="mf">0.97847826</span><span class="o">-</span><span class="mf">0.20635002j</span>  <span class="mf">0.91483931</span><span class="o">+</span><span class="mf">0.4038178j</span>
  <span class="mf">0.91483931</span><span class="o">-</span><span class="mf">0.4038178j</span>   <span class="mf">0.81182274</span><span class="o">+</span><span class="mf">0.58390345j</span>  <span class="mf">0.81182274</span><span class="o">-</span><span class="mf">0.58390345j</span>
  <span class="mf">0.67386251</span><span class="o">+</span><span class="mf">0.73885682j</span>  <span class="mf">0.67386251</span><span class="o">-</span><span class="mf">0.73885682j</span>  <span class="mf">0.31811343</span><span class="o">+</span><span class="mf">0.9480558j</span>
  <span class="mf">0.31811343</span><span class="o">-</span><span class="mf">0.9480558j</span>   <span class="mf">0.50689689</span><span class="o">+</span><span class="mf">0.86200961j</span>  <span class="mf">0.50689689</span><span class="o">-</span><span class="mf">0.86200961j</span><span class="p">]</span>
</code></pre></div></div> <p>Here, the eigenvalues form a set of complex numbers, each carrying specific significance. Each eigenvalue elucidates the dynamic behavior of its corresponding mode in the following manner:</p> <ol> <li>If the eigenvalue possesses a non-zero imaginary part, it indicates oscillation in the corresponding dynamic mode.</li> <li>If the eigenvalue resides inside the unit circle, the dynamic mode is characterized by decay.</li> <li>If the eigenvalue lies outside the unit circle, the dynamic mode exhibits growth.</li> <li>If the eigenvalue precisely falls on the unit circle, the mode neither grows nor decays.</li> </ol> <p>Armed with this insight, one can construct a simple unit circle plot and overlay the scatter plot of the real versus imaginary eigenvalues onto it, as demonstrated below:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">linspace</span><span class="p">(</span> <span class="mi">0</span> <span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="n">pi</span> <span class="p">,</span> <span class="mi">150</span> <span class="p">)</span>
<span class="n">radius</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">radius</span> <span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="nf">cos</span><span class="p">(</span> <span class="n">theta</span> <span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">radius</span> <span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="nf">sin</span><span class="p">(</span> <span class="n">theta</span> <span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">subplots</span><span class="p">()</span>

<span class="n">ax</span><span class="p">.</span><span class="nf">scatter</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">real</span><span class="p">(</span><span class="n">Lambda</span><span class="p">),</span> <span class="n">np</span><span class="p">.</span><span class="nf">imag</span><span class="p">(</span><span class="n">Lambda</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="sh">'</span><span class="s">r</span><span class="sh">'</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="sh">'</span><span class="s">o</span><span class="sh">'</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="sh">'</span><span class="s">k</span><span class="sh">'</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="sh">'</span><span class="s">--</span><span class="sh">'</span><span class="p">)</span>

<span class="n">ax</span><span class="p">.</span><span class="nf">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="sh">'</span><span class="s">$\Lambda_r$</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="sh">'</span><span class="s">$\Lambda_i$</span><span class="sh">'</span><span class="p">)</span>

<span class="n">ax</span><span class="p">.</span><span class="nf">set_aspect</span><span class="p">(</span><span class="sh">'</span><span class="s">equal</span><span class="sh">'</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</code></pre></div></div> <p>This should yield the following plot:</p> <figure> <img src="https://goswami-13.github.io/images/Post28/DMD_Circle.jpeg" width="80%"> </figure> <p>In this plot, all points lie on the unit circle, indicating that the modes neither grow nor decay, signifying stable DMD modes. This aligns with our chosen scenario, where the flow around a circular cylinder at Re = 100 exhibits stable periodic vortex shedding.</p> <p>Now, utilizing simple plotting routines, we can visualize the DMD modes:</p> <figure> <img src="https://goswami-13.github.io/images/Post28/DMD_Modes.jpeg" width="80%"> </figure> <p>Unlike POD, DMD not only provides modes but also a set of associated eigenvalues, establishing a low-dimensional dynamical system governing the evolution of mode amplitudes over time. Furthermore, unlike POD, the mean is not subtracted in the DMD calculation, and the first mode (f = 0) corresponds to a background mode that remains unchanged (i.e., it possesses a zero eigenvalue). The DMD modes resemble the POD modes in this example because POD furnishes a harmonic decomposition, resulting in modal amplitudes that are roughly sinusoidal over time at harmonic frequencies of the dominant vortex shedding.</p> <p>Lastly, the rank-21 reconstruction of the flow field bears resemblance to the original flow field, as depicted below:</p> <p><img src="https://goswami-13.github.io/images/Post28/Orig.jpeg" width="49%"><img src="https://goswami-13.github.io/images/Post28/DMD_Recon.jpeg" width="49%"></p> <p>In conclusion, Dynamic Mode Decomposition emerges as a powerful tool for uncovering dominant dynamics within fluid systems, offering insights into both mode structures and their temporal evolution. In our exploration, we’ve witnessed its efficacy in capturing stable modes within the wake behind a circular cylinder. In the next article, we’ll focus on the application of DMD using OpenFOAM simulation data, extending our understanding of its capabilities in real-world fluid dynamics scenarios.</p> </d-article> <d-appendix> <d-footnote-list></d-footnote-list> <d-citation-list></d-citation-list> </d-appendix> <d-bibliography src="/al-folio/assets/bibliography/"></d-bibliography> <d-article> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/al-folio/posts/2025/06/blog-post-54/">Tabulating 6-DOF Motion Kinematics in OpenFOAM using Python</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/al-folio/posts/2025/06/blog-post-53/">Setting Up Overset Mesh Cases in OpenFOAM Made Easy</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/al-folio/posts/2025/06/blog-post-52/">An Introduction to Overset Mesh in OpenFOAM</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/al-folio/posts/2025/05/blog-post-51/">Python Tools for Analyzing and Visualizing Mesh Motion Simulations</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/al-folio/posts/2025/03/blog-post-50/">Simulating Pure Pitching and Heaving Motions in OpenFOAM</a> </li> <br> <br> </d-article> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 Shubham Goswami, PhD. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/al-folio/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script src="/al-folio/assets/js/distillpub/overrides.js"></script> <script defer src="https://cdn.jsdelivr.net/npm/mermaid@10.7.0/dist/mermaid.min.js" integrity="sha256-TtLOdUA8mstPoO6sGvHIGx2ceXrrX4KgIItO06XOn8A=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/d3@7.8.5/dist/d3.min.js" integrity="sha256-1rA678n2xEx7x4cTZ5x4wpUCj6kUMZEZ5cxLSVSFWxw=" crossorigin="anonymous"></script> <script defer src="/al-folio/assets/js/mermaid-setup.js?38ca0a0126f7328d2d9a46bad640931f" type="text/javascript"></script> <script src="https://cdn.jsdelivr.net/npm/diff2html@3.4.47/bundles/js/diff2html-ui.min.js" integrity="sha256-eU2TVHX633T1o/bTQp6iIJByYJEtZThhF9bKz/DcbbY=" crossorigin="anonymous"></script> <script defer src="/al-folio/assets/js/diff2html-setup.js?80a6e52ce727518bbd3aed2bb6ba5601" type="text/javascript"></script> <script src="https://cdn.jsdelivr.net/npm/leaflet@1.9.4/dist/leaflet.min.js" integrity="sha256-MgH13bFTTNqsnuEoqNPBLDaqxjGH+lCpqrukmXc8Ppg=" crossorigin="anonymous"></script> <script defer src="/al-folio/assets/js/leaflet-setup.js?b6313931e203b924523e2d8b75fe8874" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js" integrity="sha256-0q+JdOlScWOHcunpUk21uab1jW7C1deBQARHtKMcaB4=" crossorigin="anonymous"></script> <script defer src="/al-folio/assets/js/chartjs-setup.js?183c5859923724fb1cb3c67593848e71" type="text/javascript"></script> <script src="https://cdn.jsdelivr.net/npm/echarts@5.5.0/dist/echarts.min.js" integrity="sha256-QvgynZibb2U53SsVu98NggJXYqwRL7tg3FeyfXvPOUY=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/echarts@5.5.0/theme/dark-fresh-cut.js" integrity="sha256-sm6Ui9w41++ZCWmIWDLC18a6ki72FQpWDiYTDxEPXwU=" crossorigin="anonymous"></script> <script defer src="/al-folio/assets/js/echarts-setup.js?738178999630746a8d0cfc261fc47c2c" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/vega@5.27.0/build/vega.min.js" integrity="sha256-Yot/cfgMMMpFwkp/5azR20Tfkt24PFqQ6IQS+80HIZs=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/vega-lite@5.16.3/build/vega-lite.min.js" integrity="sha256-TvBvIS5jUN4BSy009usRjNzjI1qRrHPYv7xVLJyjUyw=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/vega-embed@6.24.0/build/vega-embed.min.js" integrity="sha256-FPCJ9JYCC9AZSpvC/t/wHBX7ybueZhIqOMjpWqfl3DU=" crossorigin="anonymous"></script> <script defer src="/al-folio/assets/js/vega-setup.js?7c7bee055efe9312afc861b128fe5f36" type="text/javascript"></script> <script defer src="https://tikzjax.com/v1/tikzjax.js" integrity="sha256-+1qyucCXRZJrCg3lm3KxRt/7WXaYhBid4/1XJRHGB1E=" crossorigin="anonymous"></script> <script src="/al-folio/assets/js/typograms.js?062e75bede72543443762dc3fe36c7a5"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/al-folio/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/al-folio/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/al-folio/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/al-folio/assets/js/copy_code.js?c8a01c11a92744d44b093fc3bda915df" type="text/javascript"></script> <script defer src="/al-folio/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/al-folio/assets/js/mathjax-setup.js?a5bb4e6a542c546dd929b24b8b236dfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/al-folio/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/al-folio/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> <script type="module" src="/al-folio/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/al-folio/assets/js/search-setup.js?6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/al-folio/assets/js/search-data.js"></script> <script src="/al-folio/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>