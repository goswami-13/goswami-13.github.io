<!DOCTYPE html> <html> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> 3D DMD and Visualization with OpenFOAM and Python | Shubham Goswami, PhD </title> <meta name="author" content="Shubham Goswami, PhD"> <meta name="description" content="Personal and professional website of Shubham Goswami, PhD. "> <link rel="stylesheet" href="/al-folio/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/al-folio/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/al-folio/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/al-folio/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/al-folio/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://shubhamdgoswami.github.io/al-folio/posts/2025/02/blog-post-47/"> <script src="/al-folio/assets/js/theme.js?a81d82887dd692e91686b43de4542f18"></script> <link defer rel="stylesheet" href="/al-folio/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> <link defer rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet@1.9.4/dist/leaflet.min.css" integrity="sha256-q9ba7o845pMPFU+zcAll8rv+gC+fSovKsOoNQ6cynuQ=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.9.0/styles/github.min.css" integrity="sha256-Oppd74ucMR5a5Dq96FxjEzGF7tTw2fZ/6ksAqDCM8GY=" crossorigin="anonymous" media="screen and (prefers-color-scheme: light)"> <link defer rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.9.0/styles/github-dark.min.css" integrity="sha256-nyCNAiECsdDHrr/s2OQsp5l9XeY2ZJ0rMepjCT2AkBk=" crossorigin="anonymous" media="screen and (prefers-color-scheme: dark)"> <link defer rel="stylesheet" href="https://cdn.jsdelivr.net/npm/diff2html@3.4.47/bundles/css/diff2html.min.css" integrity="sha256-IMBK4VNZp0ivwefSn51bswdsrhk0HoMTLc2GqFHFBXg=" crossorigin="anonymous"> <link defer rel="stylesheet" type="text/css" href="https://tikzjax.com/v1/fonts.css"> <script src="/al-folio/assets/js/distillpub/template.v2.js"></script> <script src="/al-folio/assets/js/distillpub/transforms.v2.js"></script> <style type="text/css">.fake-img{background:#bbb;border:1px solid rgba(0,0,0,0.1);box-shadow:0 0 4px rgba(0,0,0,0.1);margin-bottom:12px}.fake-img p{font-family:monospace;color:white;text-align:left;margin:12px 0;text-align:center;font-size:16px}</style> </head> <body> <d-front-matter> <script async type="text/json">
      {
            "title": "3D DMD and Visualization with OpenFOAM and Python",
            "description": "",
            "published": "February 16, 2025",
            "authors": [
              
            ],
            "katex": {
              "delimiters": [
                {
                  "left": "$",
                  "right": "$",
                  "display": false
                },
                {
                  "left": "$$",
                  "right": "$$",
                  "display": true
                }
              ]
            }
          }
    </script> </d-front-matter> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/al-folio/"> <span class="font-weight-bold">Shubham</span> Goswami, PhD </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/al-folio/">About </a> </li> <li class="nav-item "> <a class="nav-link" href="/al-folio/cv/">CV </a> </li> <li class="nav-item "> <a class="nav-link" href="/al-folio/blog/">Guides </a> </li> <li class="nav-item "> <a class="nav-link" href="/al-folio/publications/">Publications </a> </li> <li class="nav-item "> <a class="nav-link" href="/al-folio/teaching/">Teaching </a> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="post distill"> <d-title> <h1>3D DMD and Visualization with OpenFOAM and Python</h1> <p></p> </d-title> <d-article> <d-contents> <nav class="l-text figcaption"> <h3>Contents</h3> </nav> </d-contents> <p>Understanding the complex, dynamic behavior of fluid flows often requires more than just time-averaged statistics. Dynamic Mode Decomposition (DMD) offers a powerful, data-driven approach to uncover the temporal evolution of coherent structures within CFD datasets. In this blog, we’ll dive into the process of applying DMD to three-dimensional flow fields simulated using OpenFOAM and visualize the resulting modes with Python and ParaView. By combining these tools, we can unravel the intricate interactions that define unsteady flows, providing insights into both dominant patterns and transient dynamics.</p> <figure> <img src="https://goswami-13.github.io/images/2025/Blog5_2025/BlogLogo.gif" width="80%"> </figure> <p>Understanding the complex dynamics of unsteady fluid flows requires tools that go beyond traditional averaging techniques. In my previous article on 3D Proper Orthogonal Decomposition (POD), we explored how to identify the dominant spatial structures in a flow field using OpenFOAM data. While POD is invaluable for spatial decomposition, it lacks the ability to capture temporal evolution—a crucial aspect when studying unsteady or transient phenomena.</p> <p>This is where Dynamic Mode Decomposition (DMD) shines. DMD bridges the gap by uncovering modes that represent both spatial patterns and their associated temporal behavior. In this blog, we’ll build on the groundwork laid in <a href="https://medium.com/gitconnected/3d-pod-and-visualization-with-openfoam-and-python-d84c177b9119" rel="external nofollow noopener" target="_blank">my 3D POD article</a> and demonstrate how to apply DMD to three-dimensional flow data. Using OpenFOAM for simulations, Python for data handling, and ParaView for visualization, we’ll uncover the temporal dynamics of a classic fluid flow problem. By the end of this tutorial, you’ll see how DMD complements POD, enabling a deeper understanding of unsteady flows.</p> <p>In this tutorial, I’ll once again explore the dynamics of three-dimensional flow around a square cylinder at a Reynolds number of 260. For your convenience, a reference case setup is available <a href="https://github.com/goswami-13/3D_SquareCylinder.git" rel="external nofollow noopener" target="_blank">here</a>.</p> <p>Lets Begin!!</p> <h1 id="3d-dynamic-mode-decomposition">3D Dynamic Mode Decomposition</h1> <p>Building on the foundations from the previous article, we’ll use the pre-assembled snapshot matrix, <code class="language-plaintext highlighter-rouge">data_Vort</code>, along with the <a href="https://modulo.readthedocs.io/en/latest/intro.html" rel="external nofollow noopener" target="_blank">MODULO</a> package to perform 3D Dynamic Mode Decomposition (DMD). This step-by-step guide will demonstrate how to set up the necessary environment, process the data, and extract meaningful temporal dynamics.</p> <p>We’ll start by loading the required Python modules and defining the necessary path variables in a Jupyter Notebook:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">matplotlib.colors</span>
<span class="kn">import</span> <span class="n">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="n">fluidfoam</span> <span class="k">as</span> <span class="n">fl</span> <span class="c1">### Most Important
</span><span class="kn">import</span> <span class="n">scipy</span> <span class="k">as</span> <span class="n">sp</span>
<span class="kn">from</span> <span class="n">matplotlib.colors</span> <span class="kn">import</span> <span class="n">ListedColormap</span>
<span class="kn">import</span> <span class="n">os</span>
<span class="kn">import</span> <span class="n">io</span>
<span class="kn">import</span> <span class="n">pyvista</span> <span class="k">as</span> <span class="n">pv</span>
<span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
<span class="n">plt</span><span class="p">.</span><span class="n">rcParams</span><span class="p">.</span><span class="nf">update</span><span class="p">({</span><span class="sh">'</span><span class="s">font.size</span><span class="sh">'</span> <span class="p">:</span> <span class="mi">18</span><span class="p">,</span> <span class="sh">'</span><span class="s">font.family</span><span class="sh">'</span> <span class="p">:</span> <span class="sh">'</span><span class="s">Times New Roman</span><span class="sh">'</span><span class="p">,</span> <span class="sh">"</span><span class="s">text.usetex</span><span class="sh">"</span><span class="p">:</span> <span class="bp">True</span><span class="p">})</span>

<span class="c1"># Path variables
</span><span class="n">Path</span> <span class="o">=</span> <span class="sh">'</span><span class="s">E:/Blog_Posts/Simulations/3D_Bai/</span><span class="sh">'</span>

<span class="c1"># Constants
</span><span class="n">d</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">Ub</span> <span class="o">=</span> <span class="mf">0.039</span>
</code></pre></div></div> <p>Next, import the <code class="language-plaintext highlighter-rouge">data_Vort</code> matrix, which contains the 3D snapshots of the vorticity field, and check its dimensions:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Import matrix
</span><span class="n">data_Vort</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">load</span><span class="p">(</span><span class="n">Path</span> <span class="o">+</span> <span class="sh">'</span><span class="s">VortZ.npy</span><span class="sh">'</span><span class="p">)</span>

<span class="c1"># Check matrix shape
</span><span class="n">data_Vort</span><span class="p">.</span><span class="n">shape</span>
<span class="c1">### OUTPUT
### (624537, 161)
</span></code></pre></div></div> <p>This output confirms that the dataset consists of a 3D spatial mesh with 624,537 elements and 161 temporal snapshots.</p> <p>To proceed with the DMD analysis, we’ll initialize the MODULO package:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">modulo_vki</span> <span class="kn">import</span> <span class="n">ModuloVKI</span>

<span class="c1"># Initialize MODULO object
</span><span class="n">m</span> <span class="o">=</span> <span class="nc">ModuloVKI</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="nf">nan_to_num</span><span class="p">(</span><span class="n">data_Vort</span><span class="p">),</span> <span class="n">n_Modes</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
</code></pre></div></div> <p>DMD requires the sampling frequency of the dataset, which corresponds to the time interval between consecutive snapshots in the simulation. Retrieve this information from the OpenFOAM simulation setup:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Sampling time and frequency
</span><span class="n">dt</span> <span class="o">=</span> <span class="mf">0.05</span><span class="o">*</span><span class="mi">25</span>
<span class="n">F_S</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">dt</span>
</code></pre></div></div> <p>Finally, compute the DMD modes, eigenvalues, frequencies, and initial amplitudes using the MODULO package:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Compute DMD using MODULO
</span><span class="n">Phi_D</span><span class="p">,</span> <span class="n">Lambda</span><span class="p">,</span> <span class="n">freqs</span><span class="p">,</span> <span class="n">a0s</span> <span class="o">=</span> <span class="n">m</span><span class="p">.</span><span class="nf">compute_DMD_PIP</span><span class="p">(</span><span class="bp">False</span><span class="p">,</span> <span class="n">F_S</span><span class="o">=</span><span class="n">F_S</span><span class="p">)</span>
</code></pre></div></div> <p>With these steps, we’ve successfully performed DMD on the 3D dataset. The resulting outputs will allow us to explore the temporal evolution of coherent flow structures.</p> <p>After computing the DMD, a crucial step is to analyze the <strong>DMD circle</strong>, which provides insight into the dynamic behavior of the flow. The eigenvalues obtained from the DMD computation form a set of complex numbers, each carrying distinct significance regarding the behavior of their corresponding dynamic modes:</p> <ol> <li> <strong>Oscillation:</strong> A non-zero imaginary part indicates oscillation in the dynamic mode.</li> <li> <strong>Decay:</strong> If the eigenvalue lies inside the unit circle, the dynamic mode decays over time.</li> <li> <strong>Growth:</strong> Eigenvalues outside the unit circle signify growing dynamic modes.</li> <li> <strong>Neutral Stability:</strong> Eigenvalues on the unit circle correspond to modes that neither grow nor decay, indicating stability.</li> </ol> <p>This understanding enables us to plot a unit circle and overlay the scatter plot of real versus imaginary parts of the eigenvalues to visualize their behavior. Below is the Python implementation for constructing the DMD circle:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#%% Plot DMD Spectra in the Circle
</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">subplots</span><span class="p">()</span> 
<span class="n">plt</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">imag</span><span class="p">(</span><span class="n">Lambda</span><span class="p">),</span><span class="n">np</span><span class="p">.</span><span class="nf">real</span><span class="p">(</span><span class="n">Lambda</span><span class="p">),</span><span class="sh">'</span><span class="s">ko</span><span class="sh">'</span><span class="p">)</span>
<span class="n">circle</span><span class="o">=</span><span class="n">plt</span><span class="p">.</span><span class="nc">Circle</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="sh">'</span><span class="s">b</span><span class="sh">'</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">add_patch</span><span class="p">(</span><span class="n">circle</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">set_aspect</span><span class="p">(</span><span class="sh">'</span><span class="s">equal</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="sh">'</span><span class="s">$\Lambda_r$</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="sh">'</span><span class="s">$\Lambda_i$</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</code></pre></div></div> <figure> <img src="https://goswami-13.github.io/images/2025/Blog5_2025/DMD_Circle.jpeg" width="80%"> </figure> <p>In this plot, all eigenvalues lie on the unit circle, indicating that the corresponding DMD modes are neutrally stable. These modes neither grow nor decay, making them ideal for studying steady oscillatory phenomena in the flow. This stability is particularly significant when analyzing flows where sustained oscillations dominate, such as vortex shedding in bluff-body wakes.</p> <h1 id="3d-dmd-visualization">3D DMD Visualization</h1> <p>To visualize the 3D structures of DMD modes, we’ll leverage Python and ParaView. However, before diving into the visualization, it’s crucial to gain an understanding of the <strong>temporal dynamics</strong> of the flow using a simple Fast Fourier Transform (FFT). Unlike POD, DMD extracts both spatial and temporal structures, with each mode being associated with a specific frequency.</p> <p>Given the complexity of a highly three-dimensional flow like ours, we aim to identify modes corresponding to distinct frequencies that signify key flow phenomena. For instance, in the case of flow around a square cylinder, <strong>periodic vortex shedding</strong> is a prominent feature in the wake. By focusing on the dominant frequency of this shedding and its harmonics, we can extract and analyze DMD modes relevant to these phenomena.</p> <p>To begin, we perform an FFT to analyze the temporal dynamics of the flow:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">### FFT 
</span>
<span class="c1">### Constants
</span><span class="n">d</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">Ub</span> <span class="o">=</span> <span class="mf">0.039</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mf">0.05</span><span class="o">*</span><span class="mi">25</span>
<span class="n">fs</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">dt</span>

<span class="n">Signal1</span> <span class="o">=</span> <span class="n">data_Vort</span><span class="p">[</span><span class="mi">50000</span><span class="p">,:]</span>

<span class="c1">### PSD using welch
</span><span class="n">f1</span><span class="p">,</span> <span class="n">Eu1</span> <span class="o">=</span> <span class="n">sp</span><span class="p">.</span><span class="n">signal</span><span class="p">.</span><span class="nf">welch</span><span class="p">(</span><span class="n">Signal1</span><span class="p">,</span> <span class="n">fs</span><span class="p">,</span> <span class="n">nfft</span> <span class="o">=</span> <span class="nf">len</span><span class="p">(</span><span class="n">Signal1</span><span class="p">),</span> <span class="n">nperseg</span><span class="o">=</span><span class="nf">len</span><span class="p">(</span><span class="n">Signal1</span><span class="p">),</span> <span class="n">window</span><span class="o">=</span><span class="sh">'</span><span class="s">hamming</span><span class="sh">'</span><span class="p">)</span>
<span class="n">St1</span> <span class="o">=</span> <span class="n">f1</span><span class="o">*</span><span class="n">d</span><span class="o">/</span><span class="n">Ub</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">subplots</span><span class="p">()</span>

<span class="n">ax</span><span class="p">.</span><span class="nf">loglog</span><span class="p">(</span><span class="n">St1</span><span class="p">,</span> <span class="n">Eu1</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="p">(</span><span class="sa">r</span><span class="sh">'</span><span class="s">$\bf E_x$</span><span class="sh">'</span><span class="p">))</span>

<span class="n">xmax</span> <span class="o">=</span> <span class="n">St1</span><span class="p">[</span><span class="n">np</span><span class="p">.</span><span class="nf">argmax</span><span class="p">(</span><span class="n">Eu1</span><span class="o">*</span><span class="n">f1</span><span class="o">/</span><span class="p">(</span><span class="n">Ub</span><span class="o">**</span><span class="mi">2</span><span class="p">))]</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Strouhal Number = </span><span class="sh">"</span><span class="p">,</span> <span class="n">xmax</span><span class="p">)</span>

<span class="n">ax</span><span class="p">.</span><span class="nf">axvline</span><span class="p">(</span><span class="n">xmax</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="sh">'</span><span class="s">r</span><span class="sh">'</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="sh">'</span><span class="s">--</span><span class="sh">'</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>

<span class="n">ax</span><span class="p">.</span><span class="nf">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="sh">'</span><span class="s">best</span><span class="sh">'</span><span class="p">,</span> <span class="n">frameon</span> <span class="o">=</span> <span class="bp">False</span><span class="p">);</span> <span class="c1"># or 'best', 'upper right', etc
</span><span class="n">ax</span><span class="p">.</span><span class="nf">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="sh">'</span><span class="s">$St$</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="sh">'</span><span class="s">$E_{u_i}$</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="n">xaxis</span><span class="p">.</span><span class="nf">set_tick_params</span><span class="p">(</span><span class="n">direction</span><span class="o">=</span><span class="sh">'</span><span class="s">in</span><span class="sh">'</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="sh">'</span><span class="s">both</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="n">yaxis</span><span class="p">.</span><span class="nf">set_tick_params</span><span class="p">(</span><span class="n">direction</span><span class="o">=</span><span class="sh">'</span><span class="s">in</span><span class="sh">'</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="sh">'</span><span class="s">both</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="n">xaxis</span><span class="p">.</span><span class="nf">set_ticks_position</span><span class="p">(</span><span class="sh">'</span><span class="s">both</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="n">yaxis</span><span class="p">.</span><span class="nf">set_ticks_position</span><span class="p">(</span><span class="sh">'</span><span class="s">both</span><span class="sh">'</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</code></pre></div></div> <figure> <img src="https://goswami-13.github.io/images/2025/Blog5_2025/Power.jpeg" width="80%"> </figure> <p>Here, we observe a dominant peak in the frequency spectrum corresponding to a Strouhal number of approximately 0.14, indicating the periodic vortex shedding in the wake. This provides a clear target for analysis: we can extract DMD modes corresponding to this frequency and its harmonics, which encapsulate the spatial structures associated with this flow phenomenon.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># File location to write a VTK File
</span><span class="n">WhereWrite</span> <span class="o">=</span> <span class="sh">'</span><span class="s">E:/Blog_Posts/Simulations/3D_Bai/postProcessing/</span><span class="sh">'</span>

<span class="c1"># First snapshot, base file
</span><span class="n">WriteFile</span> <span class="o">=</span> <span class="n">pv</span><span class="p">.</span><span class="nf">read</span><span class="p">(</span><span class="n">Surfaces</span> <span class="o">+</span> <span class="n">Files</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="sh">'</span><span class="s">/internal.vtu</span><span class="sh">'</span><span class="p">)</span>

<span class="c1"># Extract Modes
</span><span class="n">DMD_Mode1</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">real</span><span class="p">(</span><span class="n">Phi_D</span><span class="p">[:,</span><span class="mi">18</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">d</span><span class="o">/</span><span class="n">Ub</span><span class="p">))</span>
<span class="n">DMD_Mode2</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">real</span><span class="p">(</span><span class="n">Phi_D</span><span class="p">[:,</span><span class="mi">19</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">d</span><span class="o">/</span><span class="n">Ub</span><span class="p">))</span>
<span class="n">DMD_Mode3</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">real</span><span class="p">(</span><span class="n">Phi_D</span><span class="p">[:,</span><span class="mi">30</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">d</span><span class="o">/</span><span class="n">Ub</span><span class="p">))</span>
<span class="n">DMD_Mode4</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">real</span><span class="p">(</span><span class="n">Phi_D</span><span class="p">[:,</span><span class="mi">31</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">d</span><span class="o">/</span><span class="n">Ub</span><span class="p">))</span>
<span class="n">DMD_Mode5</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">real</span><span class="p">(</span><span class="n">Phi_D</span><span class="p">[:,</span><span class="mi">48</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">d</span><span class="o">/</span><span class="n">Ub</span><span class="p">))</span>
<span class="n">DMD_Mode6</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">real</span><span class="p">(</span><span class="n">Phi_D</span><span class="p">[:,</span><span class="mi">49</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">d</span><span class="o">/</span><span class="n">Ub</span><span class="p">))</span>
<span class="n">DMD_Mode7</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">real</span><span class="p">(</span><span class="n">Phi_D</span><span class="p">[:,</span><span class="mi">138</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">d</span><span class="o">/</span><span class="n">Ub</span><span class="p">))</span>
<span class="n">DMD_Mode8</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">real</span><span class="p">(</span><span class="n">Phi_D</span><span class="p">[:,</span><span class="mi">139</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">d</span><span class="o">/</span><span class="n">Ub</span><span class="p">))</span>

<span class="n">WriteFile</span><span class="p">.</span><span class="n">point_data</span><span class="p">[</span><span class="sh">'</span><span class="s">DMD_Mode1</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">DMD_Mode1</span>
<span class="n">WriteFile</span><span class="p">.</span><span class="n">point_data</span><span class="p">[</span><span class="sh">'</span><span class="s">DMD_Mode2</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">DMD_Mode2</span>
<span class="n">WriteFile</span><span class="p">.</span><span class="n">point_data</span><span class="p">[</span><span class="sh">'</span><span class="s">DMD_Mode3</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">DMD_Mode3</span>
<span class="n">WriteFile</span><span class="p">.</span><span class="n">point_data</span><span class="p">[</span><span class="sh">'</span><span class="s">DMD_Mode4</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">DMD_Mode4</span>
<span class="n">WriteFile</span><span class="p">.</span><span class="n">point_data</span><span class="p">[</span><span class="sh">'</span><span class="s">DMD_Mode5</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">DMD_Mode5</span>
<span class="n">WriteFile</span><span class="p">.</span><span class="n">point_data</span><span class="p">[</span><span class="sh">'</span><span class="s">DMD_Mode6</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">DMD_Mode6</span>
<span class="n">WriteFile</span><span class="p">.</span><span class="n">point_data</span><span class="p">[</span><span class="sh">'</span><span class="s">DMD_Mode7</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">DMD_Mode7</span>
<span class="n">WriteFile</span><span class="p">.</span><span class="n">point_data</span><span class="p">[</span><span class="sh">'</span><span class="s">DMD_Mode8</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">DMD_Mode8</span>

<span class="n">WriteFile</span><span class="p">.</span><span class="nf">save</span><span class="p">(</span><span class="n">WhereWrite</span> <span class="o">+</span> <span class="sh">'</span><span class="s">Visualize_2.vtu</span><span class="sh">'</span><span class="p">)</span>
</code></pre></div></div> <p>Now, let’s open these extracted modes in ParaView to visualize their 3D structures.</p> <p><img src="https://goswami-13.github.io/images/2025/Blog5_2025/DMD1.jpeg" width="49%"><img src="https://goswami-13.github.io/images/2025/Blog5_2025/DMD2.jpeg" width="49%"></p> <p><img src="https://goswami-13.github.io/images/2025/Blog5_2025/DMD3.jpeg" width="49%"><img src="https://goswami-13.github.io/images/2025/Blog5_2025/DMD4.jpeg" width="49%"></p> <p><img src="https://goswami-13.github.io/images/2025/Blog5_2025/DMD5.jpeg" width="49%"><img src="https://goswami-13.github.io/images/2025/Blog5_2025/DMD6.jpeg" width="49%"></p> <p>These visualizations clearly reveal the 3D flow instabilities present in the dataset. With higher-resolution data, one could delve deeper into the vortex dynamics, observe the formation of ribs and rollers, and explore complex interactions within such flows. This highlights the power of DMD in identifying and isolating key spatio-temporal features.</p> <p>To gain further insights, let’s extract a 2D slice from the dataset and use Python for a more detailed visualization of the flow structures behind the cylinder. Using ParaView, create and save the slice as <code class="language-plaintext highlighter-rouge">Slice2.vtp</code>. Then, load this slice into the Python workflow as follows:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Read Slice
</span><span class="n">Data2D</span> <span class="o">=</span> <span class="n">pv</span><span class="p">.</span><span class="nf">read</span><span class="p">(</span><span class="n">WhereWrite</span> <span class="o">+</span> <span class="sh">'</span><span class="s">Slice2.vtp</span><span class="sh">'</span><span class="p">)</span>
<span class="n">grid</span> <span class="o">=</span> <span class="n">Data2D</span><span class="p">.</span><span class="n">points</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">grid</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">grid</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">grid</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span>
<span class="n">rows</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">shape</span><span class="p">(</span><span class="n">grid</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">rows = </span><span class="sh">'</span><span class="p">,</span> <span class="n">rows</span><span class="p">,</span> <span class="sh">'</span><span class="s">columns = </span><span class="sh">'</span><span class="p">,</span> <span class="n">columns</span><span class="p">)</span>

<span class="c1"># Extract DMD Modes inforation
</span><span class="n">DMD_Mode0</span> <span class="o">=</span> <span class="n">Data2D</span><span class="p">.</span><span class="n">point_data</span><span class="p">[</span><span class="sh">'</span><span class="s">DMD_Mode0</span><span class="sh">'</span><span class="p">]</span>
<span class="n">DMD_Mode1</span> <span class="o">=</span> <span class="n">Data2D</span><span class="p">.</span><span class="n">point_data</span><span class="p">[</span><span class="sh">'</span><span class="s">DMD_Mode1</span><span class="sh">'</span><span class="p">]</span>
<span class="n">DMD_Mode2</span> <span class="o">=</span> <span class="n">Data2D</span><span class="p">.</span><span class="n">point_data</span><span class="p">[</span><span class="sh">'</span><span class="s">DMD_Mode2</span><span class="sh">'</span><span class="p">]</span>
<span class="n">DMD_Mode3</span> <span class="o">=</span> <span class="n">Data2D</span><span class="p">.</span><span class="n">point_data</span><span class="p">[</span><span class="sh">'</span><span class="s">DMD_Mode3</span><span class="sh">'</span><span class="p">]</span>
<span class="n">DMD_Mode4</span> <span class="o">=</span> <span class="n">Data2D</span><span class="p">.</span><span class="n">point_data</span><span class="p">[</span><span class="sh">'</span><span class="s">DMD_Mode4</span><span class="sh">'</span><span class="p">]</span>
<span class="n">DMD_Mode5</span> <span class="o">=</span> <span class="n">Data2D</span><span class="p">.</span><span class="n">point_data</span><span class="p">[</span><span class="sh">'</span><span class="s">DMD_Mode5</span><span class="sh">'</span><span class="p">]</span>
<span class="n">DMD_Mode6</span> <span class="o">=</span> <span class="n">Data2D</span><span class="p">.</span><span class="n">point_data</span><span class="p">[</span><span class="sh">'</span><span class="s">DMD_Mode6</span><span class="sh">'</span><span class="p">]</span>
<span class="n">DMD_Mode7</span> <span class="o">=</span> <span class="n">Data2D</span><span class="p">.</span><span class="n">point_data</span><span class="p">[</span><span class="sh">'</span><span class="s">DMD_Mode7</span><span class="sh">'</span><span class="p">]</span>
<span class="n">DMD_Mode8</span> <span class="o">=</span> <span class="n">Data2D</span><span class="p">.</span><span class="n">point_data</span><span class="p">[</span><span class="sh">'</span><span class="s">DMD_Mode8</span><span class="sh">'</span><span class="p">]</span>
</code></pre></div></div> <p>Finally, we can plot the selected modes for a clear visualization of the 2D flow structures:</p> <figure> <img src="https://goswami-13.github.io/images/2025/Blog5_2025/First6Modes_DMD.jpeg" width="80%"> </figure> <p>In this article, we explored the application of 3D Dynamic Mode Decomposition (DMD) to unravel the spatio-temporal dynamics of a highly three-dimensional flow. From understanding the DMD spectra and its implications for dynamic behavior to visualizing 3D flow structures in ParaView, we showcased how DMD serves as a powerful tool for uncovering complex flow phenomena. By coupling this technique with Python and OpenFOAM datasets, we demonstrated a workflow that balances computational rigor with visual clarity. The ability to isolate dominant frequencies and corresponding spatial modes opens the door to deeper insights into vortex shedding, instabilities, and flow evolution. As CFD data grows richer and more intricate, tools like DMD will continue to play a pivotal role in bridging numerical simulations with actionable insights.</p> </d-article> <d-appendix> <d-footnote-list></d-footnote-list> <d-citation-list></d-citation-list> </d-appendix> <d-bibliography src="/al-folio/assets/bibliography/"></d-bibliography> <d-article> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/al-folio/posts/2025/06/blog-post-54/">Tabulating 6-DOF Motion Kinematics in OpenFOAM using Python</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/al-folio/posts/2025/06/blog-post-53/">Setting Up Overset Mesh Cases in OpenFOAM Made Easy</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/al-folio/posts/2025/06/blog-post-52/">An Introduction to Overset Mesh in OpenFOAM</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/al-folio/posts/2025/05/blog-post-51/">Python Tools for Analyzing and Visualizing Mesh Motion Simulations</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/al-folio/posts/2025/03/blog-post-50/">Simulating Pure Pitching and Heaving Motions in OpenFOAM</a> </li> <br> <br> </d-article> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 Shubham Goswami, PhD. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/al-folio/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script src="/al-folio/assets/js/distillpub/overrides.js"></script> <script defer src="https://cdn.jsdelivr.net/npm/mermaid@10.7.0/dist/mermaid.min.js" integrity="sha256-TtLOdUA8mstPoO6sGvHIGx2ceXrrX4KgIItO06XOn8A=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/d3@7.8.5/dist/d3.min.js" integrity="sha256-1rA678n2xEx7x4cTZ5x4wpUCj6kUMZEZ5cxLSVSFWxw=" crossorigin="anonymous"></script> <script defer src="/al-folio/assets/js/mermaid-setup.js?38ca0a0126f7328d2d9a46bad640931f" type="text/javascript"></script> <script src="https://cdn.jsdelivr.net/npm/diff2html@3.4.47/bundles/js/diff2html-ui.min.js" integrity="sha256-eU2TVHX633T1o/bTQp6iIJByYJEtZThhF9bKz/DcbbY=" crossorigin="anonymous"></script> <script defer src="/al-folio/assets/js/diff2html-setup.js?80a6e52ce727518bbd3aed2bb6ba5601" type="text/javascript"></script> <script src="https://cdn.jsdelivr.net/npm/leaflet@1.9.4/dist/leaflet.min.js" integrity="sha256-MgH13bFTTNqsnuEoqNPBLDaqxjGH+lCpqrukmXc8Ppg=" crossorigin="anonymous"></script> <script defer src="/al-folio/assets/js/leaflet-setup.js?b6313931e203b924523e2d8b75fe8874" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js" integrity="sha256-0q+JdOlScWOHcunpUk21uab1jW7C1deBQARHtKMcaB4=" crossorigin="anonymous"></script> <script defer src="/al-folio/assets/js/chartjs-setup.js?183c5859923724fb1cb3c67593848e71" type="text/javascript"></script> <script src="https://cdn.jsdelivr.net/npm/echarts@5.5.0/dist/echarts.min.js" integrity="sha256-QvgynZibb2U53SsVu98NggJXYqwRL7tg3FeyfXvPOUY=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/echarts@5.5.0/theme/dark-fresh-cut.js" integrity="sha256-sm6Ui9w41++ZCWmIWDLC18a6ki72FQpWDiYTDxEPXwU=" crossorigin="anonymous"></script> <script defer src="/al-folio/assets/js/echarts-setup.js?738178999630746a8d0cfc261fc47c2c" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/vega@5.27.0/build/vega.min.js" integrity="sha256-Yot/cfgMMMpFwkp/5azR20Tfkt24PFqQ6IQS+80HIZs=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/vega-lite@5.16.3/build/vega-lite.min.js" integrity="sha256-TvBvIS5jUN4BSy009usRjNzjI1qRrHPYv7xVLJyjUyw=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/vega-embed@6.24.0/build/vega-embed.min.js" integrity="sha256-FPCJ9JYCC9AZSpvC/t/wHBX7ybueZhIqOMjpWqfl3DU=" crossorigin="anonymous"></script> <script defer src="/al-folio/assets/js/vega-setup.js?7c7bee055efe9312afc861b128fe5f36" type="text/javascript"></script> <script defer src="https://tikzjax.com/v1/tikzjax.js" integrity="sha256-+1qyucCXRZJrCg3lm3KxRt/7WXaYhBid4/1XJRHGB1E=" crossorigin="anonymous"></script> <script src="/al-folio/assets/js/typograms.js?062e75bede72543443762dc3fe36c7a5"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/al-folio/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/al-folio/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/al-folio/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/al-folio/assets/js/copy_code.js?c8a01c11a92744d44b093fc3bda915df" type="text/javascript"></script> <script defer src="/al-folio/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/al-folio/assets/js/mathjax-setup.js?a5bb4e6a542c546dd929b24b8b236dfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/al-folio/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/al-folio/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> <script type="module" src="/al-folio/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/al-folio/assets/js/search-setup.js?6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/al-folio/assets/js/search-data.js"></script> <script src="/al-folio/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>